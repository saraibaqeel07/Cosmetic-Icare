{
    "sourceFile": "src/layouts/Dashboard/Pages/UpdateConsentForm.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 103,
            "patches": [
                {
                    "date": 1743280446260,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1743280646261,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -651,9 +651,9 @@\n \r\n \r\n                 <Box component={'form'} p={3} sx={{ borderRadius: '12px' }} onSubmit={handleSubmit(UpdateConsentForm)} >\r\n                     <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\r\n-                        Create New Patient\r\n+                    Medical History Form\r\n                     </Typography>\r\n \r\n                     <Grid container mt={4} spacing={2}>\r\n \r\n"
                },
                {
                    "date": 1743280698049,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -641,9 +641,29 @@\n                 canvas.off();\r\n             }\r\n         });\r\n     }, []);\r\n+  const getData = async () => {\r\n+        try {\r\n+            let params = {\r\n+                page: 1,\r\n+                limit: 999\r\n+            };\r\n \r\n+            const data = await ApiServices.getConsentForms(params);\r\n+\r\n+\r\n+            setData(data?.data?.forms)\r\n+\r\n+\r\n+        } catch (error) {\r\n+            console.error(\"Error fetching location:\", error);\r\n+        }\r\n+    };\r\n+    useEffect(() => {\r\n+      getData()\r\n+    }, [])\r\n+    \r\n     return (\r\n         <div>\r\n \r\n             <Paper sx={{ width: \"100%\", overflow: \"hidden\", boxShadow: 'none', backgroundColor: '#eff6ff', borderRadius: '12px' }}>\r\n@@ -651,9 +671,9 @@\n \r\n \r\n                 <Box component={'form'} p={3} sx={{ borderRadius: '12px' }} onSubmit={handleSubmit(UpdateConsentForm)} >\r\n                     <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\r\n-                    Medical History Form\r\n+                        Medical History Form\r\n                     </Typography>\r\n \r\n                     <Grid container mt={4} spacing={2}>\r\n \r\n@@ -837,9 +857,9 @@\n                                         selected={selectedPatient}\r\n                                         onSelect={(value) => {\r\n                                             setSelectedPatient(value);\r\n                                             console.log(\"Selected Patient:\", value);\r\n-                                    \r\n+\r\n                                             setValue('fname', value?.first_name || \"\");\r\n                                             setValue('lname', value?.last_name || \"\");\r\n                                             setValue('email', value?.email || \"\");\r\n                                             setValue('post', value?.post_code || \"\");\r\n@@ -854,19 +874,19 @@\n                                             setValue('genemail', value?.general_practitioner?.email || \"\");\r\n                                             setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n                                             setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n                                             console.log(\"Raw DOB:\", value?.dob);\r\n-                                    \r\n+\r\n                                             if (value?.dob) {\r\n                                                 // Convert to Dayjs format\r\n                                                 const parsedDate = dayjs(value.dob);\r\n-                                    \r\n+\r\n                                                 // Check if the conversion is valid\r\n                                                 if (!parsedDate.isValid()) {\r\n                                                     console.error(\"Invalid DOB Format:\", value.dob);\r\n                                                     return;\r\n                                                 }\r\n-                                    \r\n+\r\n                                                 console.log(\"Parsed Date:\", parsedDate);\r\n                                                 setValue(\"selectedDate\", parsedDate);\r\n                                             }\r\n                                         }}\r\n"
                },
                {
                    "date": 1743280705980,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -648,12 +648,11 @@\n                 page: 1,\r\n                 limit: 999\r\n             };\r\n \r\n-            const data = await ApiServices.getConsentForms(params);\r\n+            const data = await ApiServices.getFormDetail(params);\r\n \r\n \r\n-            setData(data?.data?.forms)\r\n \r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n"
                },
                {
                    "date": 1743280712147,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -650,8 +650,9 @@\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n \r\n+console.log(data?.data);\r\n \r\n \r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743280735284,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,8 +20,9 @@\n import DeleteIcon from \"@mui/icons-material/Delete\";\r\n import UploadFileIcon from '@mui/icons-material/UploadFile';\r\n import CloseIcon from '@mui/icons-material/Close';\r\n import dayjs from \"dayjs\";\r\n+import { id } from \"date-fns/locale\";\r\n \r\n \r\n const UpdateConsentForm = () => {\r\n     const navigate = useNavigate()\r\n@@ -644,10 +645,10 @@\n     }, []);\r\n   const getData = async () => {\r\n         try {\r\n             let params = {\r\n-                page: 1,\r\n-                limit: 999\r\n+                id: id,\r\n+                \r\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n \r\n"
                },
                {
                    "date": 1743280792403,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -642,29 +642,29 @@\n                 canvas.off();\r\n             }\r\n         });\r\n     }, []);\r\n-  const getData = async () => {\r\n+    const getData = async () => {\r\n         try {\r\n             let params = {\r\n                 id: id,\r\n-                \r\n+\r\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n \r\n-console.log(data?.data);\r\n+            console.log(data?.data);\r\n \r\n \r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n     };\r\n     useEffect(() => {\r\n-      getData()\r\n+        getData()\r\n     }, [])\r\n-    \r\n+\r\n     return (\r\n         <div>\r\n \r\n             <Paper sx={{ width: \"100%\", overflow: \"hidden\", boxShadow: 'none', backgroundColor: '#eff6ff', borderRadius: '12px' }}>\r\n"
                },
                {
                    "date": 1743280827104,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n import { PrimaryButton } from \"../../../components/buttons\";\r\n import { Avatar, Box, Button, CircularProgress, Dialog, DialogContent, DialogTitle, Divider, FormControl, FormControlLabel, FormLabel, Grid, IconButton, InputAdornment, InputLabel, Paper, Radio, RadioGroup, TextField, Typography } from \"@mui/material\";\r\n import InputField from \"../../../components/input\";\r\n import { Controller, useFieldArray, useForm } from \"react-hook-form\";\r\n-import { useNavigate } from \"react-router-dom\";\r\n+import { useNavigate, useParams } from \"react-router-dom\";\r\n import axios from \"axios\";\r\n import { showErrorToast, showPromiseToast, showSuccessToast } from \"../../../components/Toaster\";\r\n import UploadIcon from \"@mui/icons-material/Upload\";\r\n import OTPInput from \"react-otp-input\";\r\n@@ -24,8 +24,9 @@\n import { id } from \"date-fns/locale\";\r\n \r\n \r\n const UpdateConsentForm = () => {\r\n+    const {id}=useParams()\r\n     const navigate = useNavigate()\r\n     const [userData, setUserData] = useState(null)\r\n     const { register, control, handleSubmit, setValue, getValues, formState: { errors }, reset, watch } = useForm({\r\n         defaultValues: {\r\n"
                },
                {
                    "date": 1743280979818,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -651,9 +651,9 @@\n \r\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n-\r\n+let form =data?.data?.form\r\n             console.log(data?.data);\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743280985851,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,9 +24,9 @@\n import { id } from \"date-fns/locale\";\r\n \r\n \r\n const UpdateConsentForm = () => {\r\n-    const {id}=useParams()\r\n+    const { id } = useParams()\r\n     const navigate = useNavigate()\r\n     const [userData, setUserData] = useState(null)\r\n     const { register, control, handleSubmit, setValue, getValues, formState: { errors }, reset, watch } = useForm({\r\n         defaultValues: {\r\n@@ -651,10 +651,10 @@\n \r\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n-let form =data?.data?.form\r\n-            console.log(data?.data);\r\n+            let form = data?.data?.form\r\n+            \r\n \r\n \r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743281028458,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -652,9 +652,9 @@\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n-            \r\n+            setSelectedPatient(patients?.find(item => item?._id == form?.patient_id))\r\n \r\n \r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743281092280,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n             }\r\n         }\r\n     };\r\n     const [title, setTitle] = useState(null)\r\n-\r\n+const [formData, setFormData] = useState(null)\r\n     const [step, setStep] = useState(1); // 1: OTP, 2: Reset Password\r\n     const [otp, setOtp] = useState(\"\");\r\n     const [otpError, setOtpError] = useState(false);\r\n     const [timer, setTimer] = useState(30);\r\n"
                },
                {
                    "date": 1743281110950,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -653,11 +653,11 @@\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n             setSelectedPatient(patients?.find(item => item?._id == form?.patient_id))\r\n+            setFormData(form)\r\n \r\n \r\n-\r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n     };\r\n"
                },
                {
                    "date": 1743281128931,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -652,9 +652,9 @@\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n-            setSelectedPatient(patients?.find(item => item?._id == form?.patient_id))\r\n+            \r\n             setFormData(form)\r\n \r\n \r\n         } catch (error) {\r\n@@ -663,8 +663,12 @@\n     };\r\n     useEffect(() => {\r\n         getData()\r\n     }, [])\r\n+    useEffect(() => {\r\n+      \r\n+    }, [patients])\r\n+    \r\n \r\n     return (\r\n         <div>\r\n \r\n"
                },
                {
                    "date": 1743281141223,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -664,9 +664,9 @@\n     useEffect(() => {\r\n         getData()\r\n     }, [])\r\n     useEffect(() => {\r\n-      \r\n+        setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n     }, [patients])\r\n     \r\n \r\n     return (\r\n"
                },
                {
                    "date": 1743281313873,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -664,9 +664,11 @@\n     useEffect(() => {\r\n         getData()\r\n     }, [])\r\n     useEffect(() => {\r\n+        let value=patients?.find(item => item?._id == formData?.patient_id)\r\n         setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n+\r\n     }, [patients])\r\n     \r\n \r\n     return (\r\n"
                },
                {
                    "date": 1743281319354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -666,9 +666,39 @@\n     }, [])\r\n     useEffect(() => {\r\n         let value=patients?.find(item => item?._id == formData?.patient_id)\r\n         setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n+        \r\n+        setValue('fname', value?.first_name || \"\");\r\n+        setValue('lname', value?.last_name || \"\");\r\n+        setValue('email', value?.email || \"\");\r\n+        setValue('post', value?.post_code || \"\");\r\n+        setValue('phone', value?.phone || \"\");\r\n+        setValue('address', value?.address || \"\");\r\n+        setValue('notes', value?.notes || \"\");\r\n+        setValue('name', value?.kin_details?.name || \"\");\r\n+        setValue('kinemail', value?.kin_details?.email || \"\");\r\n+        setValue('kinphone', value?.kin_details?.phone || \"\");\r\n+        setValue('kinaddress', value?.kin_details?.address || \"\");\r\n+        setValue('genname', value?.general_practitioner?.name || \"\");\r\n+        setValue('genemail', value?.general_practitioner?.email || \"\");\r\n+        setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n+        setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n+        console.log(\"Raw DOB:\", value?.dob);\r\n \r\n+        if (value?.dob) {\r\n+            // Convert to Dayjs format\r\n+            const parsedDate = dayjs(value.dob);\r\n+\r\n+            // Check if the conversion is valid\r\n+            if (!parsedDate.isValid()) {\r\n+                console.error(\"Invalid DOB Format:\", value.dob);\r\n+                return;\r\n+            }\r\n+\r\n+            console.log(\"Parsed Date:\", parsedDate);\r\n+            setValue(\"selectedDate\", parsedDate);\r\n+\r\n     }, [patients])\r\n     \r\n \r\n     return (\r\n"
                },
                {
                    "date": 1743281327646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -696,8 +696,9 @@\n             }\r\n \r\n             console.log(\"Parsed Date:\", parsedDate);\r\n             setValue(\"selectedDate\", parsedDate);\r\n+        }\r\n \r\n     }, [patients])\r\n     \r\n \r\n"
                },
                {
                    "date": 1743281398802,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -891,8 +891,9 @@\n                                     <SelectField\r\n                                         size={'small'}\r\n                                         newLabel={'Select Patient'}\r\n                                         fullWidth={true}\r\n+                                        disabled={true}\r\n                                         options={patients}\r\n                                         selected={selectedPatient}\r\n                                         onSelect={(value) => {\r\n                                             setSelectedPatient(value);\r\n"
                },
                {
                    "date": 1743281512167,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -652,9 +652,9 @@\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n-            \r\n+            setValue('treatmentDate',dayjs(form.treatment_date))\r\n             setFormData(form)\r\n \r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743281529999,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -653,8 +653,9 @@\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n             setValue('treatmentDate',dayjs(form.treatment_date))\r\n+            setValue('consultationDate',dayjs(form.consultation_date))\r\n             setFormData(form)\r\n \r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743281562966,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -652,10 +652,10 @@\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n-            setValue('treatmentDate',dayjs(form.treatment_date))\r\n-            setValue('consultationDate',dayjs(form.consultation_date))\r\n+            setValue('treatmentDate',dayjs(form?.treatment_date))\r\n+            setValue('consultationDate',dayjs(form?.consultation_date))\r\n             setFormData(form)\r\n \r\n \r\n         } catch (error) {\r\n@@ -699,9 +699,9 @@\n             console.log(\"Parsed Date:\", parsedDate);\r\n             setValue(\"selectedDate\", parsedDate);\r\n         }\r\n \r\n-    }, [patients])\r\n+    }, [patients,documents])\r\n     \r\n \r\n     return (\r\n         <div>\r\n"
                },
                {
                    "date": 1743281572604,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -667,8 +667,9 @@\n     }, [])\r\n     useEffect(() => {\r\n         let value=patients?.find(item => item?._id == formData?.patient_id)\r\n         setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n+        setSelectedDocument(patients?.find(item => item?._id == formData?.patient_id))\r\n         \r\n         setValue('fname', value?.first_name || \"\");\r\n         setValue('lname', value?.last_name || \"\");\r\n         setValue('email', value?.email || \"\");\r\n"
                },
                {
                    "date": 1743281629539,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -667,9 +667,9 @@\n     }, [])\r\n     useEffect(() => {\r\n         let value=patients?.find(item => item?._id == formData?.patient_id)\r\n         setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n-        setSelectedDocument(patients?.find(item => item?._id == formData?.patient_id))\r\n+        setSelectedDocument(documents?.find(item => item?._id == formData?.aftercare_document))\r\n         \r\n         setValue('fname', value?.first_name || \"\");\r\n         setValue('lname', value?.last_name || \"\");\r\n         setValue('email', value?.email || \"\");\r\n"
                },
                {
                    "date": 1743281754923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -654,8 +654,12 @@\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n             setValue('treatmentDate',dayjs(form?.treatment_date))\r\n             setValue('consultationDate',dayjs(form?.consultation_date))\r\n+            setPermissions({\r\n+                marketing: form,\r\n+                offers: form?.offers,\r\n+            })\r\n             setFormData(form)\r\n \r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743281774390,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -655,9 +655,9 @@\n             let form = data?.data?.form\r\n             setValue('treatmentDate',dayjs(form?.treatment_date))\r\n             setValue('consultationDate',dayjs(form?.consultation_date))\r\n             setPermissions({\r\n-                marketing: form,\r\n+                marketing: form?.permission_marketing,\r\n                 offers: form?.offers,\r\n             })\r\n             setFormData(form)\r\n \r\n"
                },
                {
                    "date": 1743281955900,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -665,8 +665,10 @@\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n     };\r\n+    console.log(permissions);\r\n+    \r\n     useEffect(() => {\r\n         getData()\r\n     }, [])\r\n     useEffect(() => {\r\n"
                },
                {
                    "date": 1743282020623,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -655,9 +655,9 @@\n             let form = data?.data?.form\r\n             setValue('treatmentDate',dayjs(form?.treatment_date))\r\n             setValue('consultationDate',dayjs(form?.consultation_date))\r\n             setPermissions({\r\n-                marketing: form?.permission_marketing,\r\n+                marketing: form?.permission_marketing ?  'yes' : 'no',\r\n                 offers: form?.offers,\r\n             })\r\n             setFormData(form)\r\n \r\n"
                },
                {
                    "date": 1743282119658,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -656,13 +656,22 @@\n             setValue('treatmentDate',dayjs(form?.treatment_date))\r\n             setValue('consultationDate',dayjs(form?.consultation_date))\r\n             setPermissions({\r\n                 marketing: form?.permission_marketing ?  'yes' : 'no',\r\n-                offers: form?.offers,\r\n+                offers: form?.offers?  'yes' : 'no',\r\n             })\r\n             setFormData(form)\r\n+            patient_concerns: getValues('patientConcerns'),\r\n+            patient_goals: getValues('patientGoal'),\r\n+            advised_plan: getValues('advisedPlan'),\r\n+            expected_result: getValues('expectedResult'),\r\n+            date: getValues('patientDate'),\r\n+            patient_sign: signature\r\n+            setValue('patientConcerns')\r\n+            setValue('patientGoal')\r\n+            setValue('advisedPlan')\r\n+            setValue('expectedResult')\r\n \r\n-\r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n     };\r\n"
                },
                {
                    "date": 1743282187432,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -665,12 +665,13 @@\n             advised_plan: getValues('advisedPlan'),\r\n             expected_result: getValues('expectedResult'),\r\n             date: getValues('patientDate'),\r\n             patient_sign: signature\r\n-            setValue('patientConcerns')\r\n-            setValue('patientGoal')\r\n-            setValue('advisedPlan')\r\n-            setValue('expectedResult')\r\n+            setValue('patientDate',dayjs(form?.treatment_plan?.patientDate))\r\n+            setValue('patientConcerns',)\r\n+            setValue('patientGoal',)\r\n+            setValue('advisedPlan',)\r\n+            setValue('expectedResult',)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282193736,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -665,9 +665,9 @@\n             advised_plan: getValues('advisedPlan'),\r\n             expected_result: getValues('expectedResult'),\r\n             date: getValues('patientDate'),\r\n             patient_sign: signature\r\n-            setValue('patientDate',dayjs(form?.treatment_plan?.patientDate))\r\n+            setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',)\r\n             setValue('patientGoal',)\r\n             setValue('advisedPlan',)\r\n             setValue('expectedResult',)\r\n"
                },
                {
                    "date": 1743282203228,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -666,12 +666,12 @@\n             expected_result: getValues('expectedResult'),\r\n             date: getValues('patientDate'),\r\n             patient_sign: signature\r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n-            setValue('patientConcerns',)\r\n-            setValue('patientGoal',)\r\n-            setValue('advisedPlan',)\r\n-            setValue('expectedResult',)\r\n+            setValue('patientConcerns',form?.treatment_plan?.date)\r\n+            setValue('patientGoal',form?.treatment_plan?.date)\r\n+            setValue('advisedPlan',form?.treatment_plan?.date)\r\n+            setValue('expectedResult',form?.treatment_plan?.date)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282213632,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -668,9 +668,9 @@\n             patient_sign: signature\r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.date)\r\n             setValue('patientGoal',form?.treatment_plan?.date)\r\n-            setValue('advisedPlan',form?.treatment_plan?.date)\r\n+            setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.date)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n"
                },
                {
                    "date": 1743282220028,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -669,9 +669,9 @@\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.date)\r\n             setValue('patientGoal',form?.treatment_plan?.date)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n-            setValue('expectedResult',form?.treatment_plan?.date)\r\n+            setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282227422,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -666,9 +666,9 @@\n             expected_result: getValues('expectedResult'),\r\n             date: getValues('patientDate'),\r\n             patient_sign: signature\r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n-            setValue('patientConcerns',form?.treatment_plan?.date)\r\n+            setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.date)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n \r\n"
                },
                {
                    "date": 1743282233650,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -667,9 +667,9 @@\n             date: getValues('patientDate'),\r\n             patient_sign: signature\r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n-            setValue('patientGoal',form?.treatment_plan?.date)\r\n+            setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n \r\n         } catch (error) {\r\n"
                },
                {
                    "date": 1743282255165,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -664,9 +664,9 @@\n             patient_goals: getValues('patientGoal'),\r\n             advised_plan: getValues('advisedPlan'),\r\n             expected_result: getValues('expectedResult'),\r\n             date: getValues('patientDate'),\r\n-            patient_sign: signature\r\n+            setSignature(form?.treatment_plan?.sign) \r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n"
                },
                {
                    "date": 1743282263603,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -659,14 +659,10 @@\n                 marketing: form?.permission_marketing ?  'yes' : 'no',\r\n                 offers: form?.offers?  'yes' : 'no',\r\n             })\r\n             setFormData(form)\r\n-            patient_concerns: getValues('patientConcerns'),\r\n-            patient_goals: getValues('patientGoal'),\r\n-            advised_plan: getValues('advisedPlan'),\r\n-            expected_result: getValues('expectedResult'),\r\n-            date: getValues('patientDate'),\r\n-            setSignature(form?.treatment_plan?.sign) \r\n+        \r\n+            setSignature(form?.treatment_plan?.patient_sign) \r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n"
                },
                {
                    "date": 1743282377844,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -666,8 +666,9 @@\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n+            setValue(\"records\", previousRecords);\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282406686,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -666,9 +666,9 @@\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n-            setValue(\"records\", previousRecords);\r\n+            setValue(\"records\", form?.treatment_record);\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282419268,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -667,8 +667,9 @@\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n+            setValue(\"furtherFields\", form?.treatment_record);\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282438434,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -667,9 +667,9 @@\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n-            setValue(\"furtherFields\", form?.treatment_record);\r\n+            setValue(\"furtherFields\", form?.further_treatment);\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282527510,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -668,8 +668,9 @@\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n+            setUploadedImages(form?.batch_images)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282539884,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -669,8 +669,10 @@\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n             setUploadedImages(form?.batch_images)\r\n+            setBeforeImages(form?.batch_images)\r\n+            setUploadedImages(form?.batch_images)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282551680,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -669,9 +669,9 @@\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n             setUploadedImages(form?.batch_images)\r\n-            setBeforeImages(form?.batch_images)\r\n+            setBeforeImages(form?.before_images)\r\n             setUploadedImages(form?.batch_images)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n"
                },
                {
                    "date": 1743282557515,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -670,9 +670,9 @@\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n-            setUploadedImages(form?.batch_images)\r\n+            setAfterImages(form?.batch_images)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282566576,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -670,9 +670,9 @@\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n-            setAfterImages(form?.batch_images)\r\n+            setAfterImages(form?.after_images)\r\n \r\n         } catch (error) {\r\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n"
                },
                {
                    "date": 1743282578976,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -668,8 +668,9 @@\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n+            setValue(\"extranotes\", form?.treatment_record);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n             setAfterImages(form?.after_images)\r\n \r\n"
                },
                {
                    "date": 1743282632825,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -668,9 +668,9 @@\n             setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n-            setValue(\"extranotes\", form?.treatment_record);\r\n+            setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n             setAfterImages(form?.after_images)\r\n \r\n@@ -2041,9 +2041,9 @@\n                             })}\r\n                         /></Grid>\r\n                     </Grid>\r\n                     <Box sx={{ display: 'flex', justifyContent: 'flex-end', width: '100%', mt: 2 }}>\r\n-                        <PrimaryButton loader={loader} disabled={loader} type={'submit'} title={\"Create\"} />\r\n+                        <PrimaryButton loader={loader} disabled={loader} type={'submit'} title={\"Update\"} />\r\n                     </Box>\r\n                 </Box>\r\n             </Paper>\r\n         </div >\r\n"
                },
                {
                    "date": 1743282662863,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -251,8 +251,9 @@\n     const UpdateConsentForm = async () => {\r\n         setLoader(true);\r\n         try {\r\n             let obj = {\r\n+                _id:id,\r\n                 patient_id: selectedPatient?.id,\r\n                 form_id: null,\r\n                 aftercare_document: selectedDocument?._id,\r\n                 treatment_date: getValues('treatmentDate'),\r\n"
                },
                {
                    "date": 1743282669989,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -298,9 +298,9 @@\n \r\n \r\n             };\r\n \r\n-            const promise = ApiServices.CreateForm(obj);\r\n+            const promise = ApiServices.UpdateForm(obj);\r\n \r\n             // Handle the API response properly\r\n             const response = await promise;\r\n             console.log(response);\r\n"
                },
                {
                    "date": 1743282941814,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -252,9 +252,9 @@\n         setLoader(true);\r\n         try {\r\n             let obj = {\r\n                 _id:id,\r\n-                patient_id: selectedPatient?.id,\r\n+                patient_id: patientType == 'existing' ?  selectedPatient?.id : null,\r\n                 form_id: null,\r\n                 aftercare_document: selectedDocument?._id,\r\n                 treatment_date: getValues('treatmentDate'),\r\n                 consultation_date: getValues('consultationDate'),\r\n"
                },
                {
                    "date": 1743282951825,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,2054 @@\n+import { useEffect, useRef, useState } from \"react\";\r\n+import ApiServices from \"../../../services/Apis\";\r\n+import { PrimaryButton } from \"../../../components/buttons\";\r\n+import { Avatar, Box, Button, CircularProgress, Dialog, DialogContent, DialogTitle, Divider, FormControl, FormControlLabel, FormLabel, Grid, IconButton, InputAdornment, InputLabel, Paper, Radio, RadioGroup, TextField, Typography } from \"@mui/material\";\r\n+import InputField from \"../../../components/input\";\r\n+import { Controller, useFieldArray, useForm } from \"react-hook-form\";\r\n+import { useNavigate, useParams } from \"react-router-dom\";\r\n+import axios from \"axios\";\r\n+import { showErrorToast, showPromiseToast, showSuccessToast } from \"../../../components/Toaster\";\r\n+import UploadIcon from \"@mui/icons-material/Upload\";\r\n+import OTPInput from \"react-otp-input\";\r\n+import VisibilityIcon from \"@mui/icons-material/Visibility\";\r\n+import VisibilityOffIcon from \"@mui/icons-material/VisibilityOff\";\r\n+import { Visibility, VisibilityOff } from \"@mui/icons-material\";\r\n+import { DatePicker, LocalizationProvider } from \"@mui/x-date-pickers\";\r\n+import { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\r\n+import SelectField from \"../../../components/select\";\r\n+import SignatureCanvas from \"react-signature-canvas\";\r\n+import moment from \"moment\";\r\n+import DeleteIcon from \"@mui/icons-material/Delete\";\r\n+import UploadFileIcon from '@mui/icons-material/UploadFile';\r\n+import CloseIcon from '@mui/icons-material/Close';\r\n+import dayjs from \"dayjs\";\r\n+import { id } from \"date-fns/locale\";\r\n+\r\n+\r\n+const UpdateConsentForm = () => {\r\n+    const { id } = useParams()\r\n+    const navigate = useNavigate()\r\n+    const [userData, setUserData] = useState(null)\r\n+    const { register, control, handleSubmit, setValue, getValues, formState: { errors }, reset, watch } = useForm({\r\n+        defaultValues: {\r\n+            records: [{ date: \"\", amount: \"\", description: \"\" }], // Initial field (cannot be removed)\r\n+            furtherFields: [{ date: null, sign: \"\" }], // Additional dynamic section\r\n+        },\r\n+    });\r\n+    const { fields: furtherFields, append: appendFurther, remove: removeFurther } = useFieldArray({\r\n+        control,\r\n+        name: \"furtherFields\",\r\n+    });\r\n+\r\n+    const { fields, append, remove } = useFieldArray({\r\n+        control,\r\n+        name: \"records\",\r\n+    });\r\n+\r\n+\r\n+    const signCanvasRefs = useRef([]);\r\n+\r\n+    // Clear Signature Function\r\n+    const clearSignature = (index) => {\r\n+        if (signCanvasRefs.current[index]) {\r\n+            signCanvasRefs.current[index].clear();\r\n+            setValue(`furtherFields.${index}.sign`, \"\");\r\n+        }\r\n+    };\r\n+    // Function to update signature in the form state\r\n+    const updateSignature = async (index) => {\r\n+        if (signCanvasRefs.current[index]) {\r\n+            const signData = await signCanvasRefs.current[index].toDataURL();\r\n+            setValue(`furtherFields.${index}.sign`, signData);\r\n+            try {\r\n+                const file = signData;\r\n+                if (file) {\r\n+                    setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n+                }\r\n+\r\n+                let obj = {\r\n+                    document: signData,\r\n+                    filename: moment().unix() + \"_Sign.png\"\r\n+                }\r\n+\r\n+                const response = await axios.post(\r\n+                    'https://cosmetic.theappkit.com/api/system/uploadDoc',\r\n+                    obj\r\n+                );\r\n+\r\n+                console.log(response?.data?.data?.path);\r\n+\r\n+\r\n+                setValue(`furtherFields.${index}.sign`, 'https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n+\r\n+\r\n+            } catch (error) {\r\n+                console.log(error);\r\n+\r\n+            }\r\n+        }\r\n+    };\r\n+    const [title, setTitle] = useState(null)\r\n+const [formData, setFormData] = useState(null)\r\n+    const [step, setStep] = useState(1); // 1: OTP, 2: Reset Password\r\n+    const [otp, setOtp] = useState(\"\");\r\n+    const [otpError, setOtpError] = useState(false);\r\n+    const [timer, setTimer] = useState(30);\r\n+    const [isLoading, setIsLoading] = useState(false);\r\n+    const [open, setOpen] = useState(false)\r\n+    const [password, setPassword] = useState(\"\");\r\n+    const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n+\r\n+    const [showPassword2, setShowPassword2] = useState(false);\r\n+    const [otpToken, setOtpToken] = useState(null)\r\n+    const [showPassword, setShowPassword] = useState(false);\r\n+    const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n+    const [patientType, setPatientType] = useState(\"existing\");\r\n+    const [patients, setPatients] = useState([])\r\n+    const [selectedPatient, setSelectedPatient] = useState(null)\r\n+    const [documents, setDocuments] = useState([])\r\n+    const [selectedDocument, setSelectedDocument] = useState(null)\r\n+    const sigCanvas = useRef(null);\r\n+    const [signature, setSignature] = useState(null);\r\n+    const [uploadedImages, setUploadedImages] = useState([])\r\n+    const [imageLoader, setImageLoader] = useState(false)\r\n+    const [beforeImages, setBeforeImages] = useState([])\r\n+    const [imageLoaderBefore, setImageLoaderBefore] = useState(false)\r\n+    const [afterImages, setAfterImages] = useState([])\r\n+    const [imageLoaderAfter, setImageLoaderAfter] = useState(false)\r\n+\r\n+    // Handle Save Signature\r\n+    const handleSave = async () => {\r\n+        if (sigCanvas.current) {\r\n+            const dataURL = await sigCanvas.current.toDataURL();\r\n+            setSignature(dataURL);\r\n+            try {\r\n+                const file = dataURL;\r\n+                if (file) {\r\n+                    setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n+                }\r\n+\r\n+                let obj = {\r\n+                    document: dataURL,\r\n+                    filename: moment().unix() + \"_Sign.png\"\r\n+                }\r\n+\r\n+                const response = await axios.post(\r\n+                    'https://cosmetic.theappkit.com/api/system/uploadDoc',\r\n+                    obj\r\n+                );\r\n+\r\n+                console.log(response?.data?.data?.path);\r\n+\r\n+                setSignature('https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n+\r\n+\r\n+            } catch (error) {\r\n+                console.log(error);\r\n+\r\n+            }\r\n+        }\r\n+    };\r\n+\r\n+    // Handle Clear Signature\r\n+    const handleClear = () => {\r\n+        if (sigCanvas.current) {\r\n+            sigCanvas.current.clear();\r\n+            setSignature(null);\r\n+        }\r\n+    };\r\n+    const [permissions, setPermissions] = useState({\r\n+        marketing: \"\",\r\n+        offers: \"\",\r\n+    });\r\n+\r\n+    const handleChange2 = (event) => {\r\n+        setPermissions({\r\n+            ...permissions,\r\n+            [event.target.name]: event.target.value,\r\n+        });\r\n+    };\r\n+    const handleChange = (event) => {\r\n+        setPatientType(event.target.value);\r\n+    };\r\n+    const {\r\n+        register: register4,\r\n+        handleSubmit: handleSubmit4,\r\n+        setValue: setValue4,\r\n+        getValues: getValues4,\r\n+        reset: reset4,\r\n+        formState: { errors: errors4 },\r\n+    } = useForm();\r\n+\r\n+    // Simulate OTP Submission\r\n+    const handleOtpSubmit = () => {\r\n+        if (otp.length !== 4) {\r\n+            setOtpError(true);\r\n+            return;\r\n+        }\r\n+        setIsLoading(true);\r\n+        setTimeout(() => {\r\n+            setIsLoading(false);\r\n+            SubmitOTP()\r\n+            setStep(2); // Move to reset password step\r\n+        }, 2000);\r\n+    };\r\n+\r\n+    // Simulate Reset Password Submission\r\n+    const handleResetSubmit = () => {\r\n+        if (password !== confirmPassword) {\r\n+            alert(\"Passwords do not match!\");\r\n+            return;\r\n+        }\r\n+        setIsLoading(true);\r\n+        setTimeout(() => {\r\n+            setIsLoading(false);\r\n+            // Close dialog after password reset\r\n+        }, 2000);\r\n+    };\r\n+    const fileInputRef = useRef(null);\r\n+\r\n+    const [loader, setLoader] = useState(false)\r\n+\r\n+    const [imageURL, setImageURL] = useState()\r\n+    const [hovered, setHovered] = useState(false);\r\n+\r\n+\r\n+\r\n+\r\n+    const handleImageClick = () => {\r\n+        fileInputRef.current.click();\r\n+    };\r\n+\r\n+    const handleFileChange = async (e) => {\r\n+        try {\r\n+            const file = e.target.files[0];\r\n+            if (file) {\r\n+                setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n+            }\r\n+            const formData = new FormData();\r\n+            formData.append(\"document\", e.target.files[0]);\r\n+\r\n+            const response = await axios.post(\r\n+                'https://cosmetic.theappkit.com/api/system/upload',\r\n+                formData,\r\n+                {\r\n+                    headers: {\r\n+                        'Content-Type': 'multipart/form-data'\r\n+                    }\r\n+                }\r\n+            );\r\n+\r\n+            console.log(response?.data?.data?.path);\r\n+\r\n+            setImageURL('https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n+\r\n+\r\n+        } catch (error) {\r\n+            console.log(error);\r\n+\r\n+        }\r\n+    };\r\n+    const UpdateConsentForm = async () => {\r\n+        setLoader(true);\r\n+        try {\r\n+            let obj = {\r\n+                _id:id,\r\n+                patient_id: patientType == 'existing' ?  selectedPatient?.id : null,\r\n+                form_id: null,\r\n+                aftercare_document: patientType == 'existing' ? selectedDocument?._id : null,\r\n+                treatment_date: getValues('treatmentDate'),\r\n+                consultation_date: getValues('consultationDate'),\r\n+                first_name: getValues('fname'),\r\n+                last_name: getValues('lname'),\r\n+                dob: getValues('selectedDate'),\r\n+                address: getValues('address'),\r\n+                email: getValues('email'),\r\n+                post_code: getValues('post'),\r\n+                phone: getValues('phone'),\r\n+                notes: getValues('notes'),\r\n+                picture: imageURL,\r\n+                kin_details: {\r\n+                    name: getValues('name'),\r\n+                    address: getValues('kinaddress'),\r\n+                    email: getValues('kinemail'),\r\n+                    phone: getValues('kinphone'),\r\n+                },\r\n+                general_practitioner: {\r\n+                    name: getValues('genname'),\r\n+                    address: getValues('genaddress'),\r\n+                    email: getValues('genemail'),\r\n+                    phone: getValues('genphone'),\r\n+                },\r\n+                treatment_plan: {\r\n+                    patient_concerns: getValues('patientConcerns'),\r\n+                    patient_goals: getValues('patientGoal'),\r\n+                    advised_plan: getValues('advisedPlan'),\r\n+                    expected_result: getValues('expectedResult'),\r\n+                    date: getValues('patientDate'),\r\n+                    patient_sign: signature\r\n+                },\r\n+                batch_images: uploadedImages,\r\n+                before_images: beforeImages,\r\n+                after_images: afterImages,\r\n+                further_treatment: furtherFields,\r\n+                treatment_record: fields,\r\n+                extra_notes: getValues('extranotes'),\r\n+                permission_marketing: permissions?.marketing,\r\n+                offers: permissions?.offers,\r\n+\r\n+\r\n+            };\r\n+\r\n+            const promise = ApiServices.UpdateForm(obj);\r\n+\r\n+            // Handle the API response properly\r\n+            const response = await promise;\r\n+            console.log(response);\r\n+\r\n+            showPromiseToast(\r\n+                promise,\r\n+                \"Saving...\",\r\n+                \"Added Successfully\",\r\n+                \"Something Went Wrong\"\r\n+            );\r\n+\r\n+            // Navigate if response is successful\r\n+            if (response?.responseCode === 200) {\r\n+                console.log(response);\r\n+                setImageURL(null)\r\n+                navigate('/consent-forms')\r\n+\r\n+\r\n+            }\r\n+\r\n+        } catch (error) {\r\n+            console.log(error);\r\n+            showErrorToast(error)\r\n+        } finally {\r\n+\r\n+            setLoader(false);\r\n+        }\r\n+    };\r\n+\r\n+    const SendOtp = async (val) => {\r\n+        if (val != 'resend') {\r\n+            setIsLoading(true)\r\n+        }\r\n+\r\n+\r\n+        setTimer(60);\r\n+        try {\r\n+            let obj = {\r\n+                email: userData?.email\r\n+            };\r\n+\r\n+            const data = await ApiServices.SendOtp(obj);\r\n+            console.log(data);\r\n+            if (data.responseCode == 206) {\r\n+                setOtp('')\r\n+                showSuccessToast('Otp Sent Successfully')\r\n+\r\n+            }\r\n+\r\n+        } catch (error) {\r\n+\r\n+            console.log(error)\r\n+        }\r\n+        finally {\r\n+            setIsLoading(false)\r\n+            setStep(1)\r\n+            setOpen(true)\r\n+\r\n+        }\r\n+    }\r\n+\r\n+    const UpdatePassword = async (sendData, result) => {\r\n+        setIsLoading(true)\r\n+        console.log(otpToken, \"otpToken2\");\r\n+        try {\r\n+            let obj = {\r\n+                otp_token: otpToken,\r\n+                email: userData?.email,\r\n+                password: getValues4('password'),\r\n+                confirm_password: getValues4('confirmPassword'),\r\n+            };\r\n+\r\n+            const data = await ApiServices.SendOtp(obj);\r\n+            console.log(data);\r\n+            if (data.responseCode == 200) {\r\n+                setOtp('')\r\n+\r\n+                reset4()\r\n+                setConfirmPassword(false)\r\n+\r\n+\r\n+\r\n+            }\r\n+        } catch (error) {\r\n+            setOtpError(true)\r\n+        }\r\n+        finally {\r\n+            setIsLoading(false)\r\n+            setOpen(false)\r\n+            showSuccessToast('Password Reset Successfully')\r\n+        }\r\n+    };\r\n+\r\n+    const SubmitOTP = async (val) => {\r\n+\r\n+        setIsLoading(true)\r\n+\r\n+\r\n+\r\n+        try {\r\n+            let obj = {\r\n+                email: userData?.email,\r\n+                otp: otp,\r\n+            };\r\n+\r\n+            const data = await ApiServices.SendOtp(obj);\r\n+            console.log(data?.data, 'tesetttt');\r\n+            if (data.responseCode == 206) {\r\n+                console.log(data);\r\n+                setOtpToken(data?.data?.otp_token)\r\n+\r\n+\r\n+            }\r\n+        } catch (error) {\r\n+            setOtpError(true)\r\n+        }\r\n+        finally {\r\n+            setIsLoading(false)\r\n+\r\n+        }\r\n+    };\r\n+\r\n+    const handleFileChange2 = async (e) => {\r\n+        setUploadedImages([]);\r\n+        setImageLoader(true);\r\n+\r\n+        try {\r\n+            const files = e.target.files;\r\n+            if (!files || files.length === 0) return; // Exit if no files are selected\r\n+\r\n+            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n+\r\n+            const uploadedNewBatchImages = [];\r\n+\r\n+            for (let i = 0; i < files.length; i++) {\r\n+                const formData = new FormData();\r\n+                formData.append(\"document\", files[i]);\r\n+\r\n+                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n+\r\n+                const response = await axios.post(\r\n+                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n+                    formData,\r\n+                    {\r\n+                        headers: {\r\n+                            \"Content-Type\": \"multipart/form-data\",\r\n+                        },\r\n+                    }\r\n+                );\r\n+\r\n+                const imagePath = response?.data?.data?.path;\r\n+                if (imagePath) {\r\n+                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n+                    uploadedNewBatchImages.push(fullImageUrl);\r\n+                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n+                }\r\n+            }\r\n+\r\n+            setUploadedImages(uploadedNewBatchImages); // Update state with uploaded image URLs\r\n+            console.log(\"All Uploaded Images:\", uploadedNewBatchImages);\r\n+        } catch (error) {\r\n+            console.error(\"Error uploading files:\", error);\r\n+        } finally {\r\n+            setImageLoader(false);\r\n+        }\r\n+    };\r\n+\r\n+    const handleRemoveImage = (index) => {\r\n+        setUploadedImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n+    };\r\n+\r\n+    const handleFileChange3 = async (e) => {\r\n+        setBeforeImages([]);\r\n+        setImageLoaderBefore(true);\r\n+\r\n+        try {\r\n+            const files = e.target.files;\r\n+            if (!files || files.length === 0) return; // Exit if no files are selected\r\n+\r\n+            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n+\r\n+            const uploadedNewBeforeImages = [];\r\n+\r\n+            for (let i = 0; i < files.length; i++) {\r\n+                const formData = new FormData();\r\n+                formData.append(\"document\", files[i]);\r\n+\r\n+                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n+\r\n+                const response = await axios.post(\r\n+                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n+                    formData,\r\n+                    {\r\n+                        headers: {\r\n+                            \"Content-Type\": \"multipart/form-data\",\r\n+                        },\r\n+                    }\r\n+                );\r\n+\r\n+                const imagePath = response?.data?.data?.path;\r\n+                if (imagePath) {\r\n+                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n+                    uploadedNewBeforeImages.push(fullImageUrl);\r\n+                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n+                }\r\n+            }\r\n+\r\n+            setBeforeImages(uploadedNewBeforeImages); // Update state with uploaded image URLs\r\n+            console.log(\"All Uploaded Images:\", uploadedNewBeforeImages);\r\n+        } catch (error) {\r\n+            console.error(\"Error uploading files:\", error);\r\n+        } finally {\r\n+            setImageLoaderBefore(false);\r\n+        }\r\n+    };\r\n+\r\n+    const handleRemoveImage2 = (index) => {\r\n+        setBeforeImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n+    };\r\n+    const handleFileChange4 = async (e) => {\r\n+        setAfterImages([]);\r\n+        setImageLoaderAfter(true);\r\n+\r\n+        try {\r\n+            const files = e.target.files;\r\n+            if (!files || files.length === 0) return; // Exit if no files are selected\r\n+\r\n+            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n+\r\n+            const uploadedNewAfterImages = [];\r\n+\r\n+            for (let i = 0; i < files.length; i++) {\r\n+                const formData = new FormData();\r\n+                formData.append(\"document\", files[i]);\r\n+\r\n+                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n+\r\n+                const response = await axios.post(\r\n+                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n+                    formData,\r\n+                    {\r\n+                        headers: {\r\n+                            \"Content-Type\": \"multipart/form-data\",\r\n+                        },\r\n+                    }\r\n+                );\r\n+\r\n+                const imagePath = response?.data?.data?.path;\r\n+                if (imagePath) {\r\n+                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n+                    uploadedNewAfterImages.push(fullImageUrl);\r\n+                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n+                }\r\n+            }\r\n+\r\n+            setAfterImages(uploadedNewAfterImages); // Update state with uploaded image URLs\r\n+            console.log(\"All Uploaded Images:\", uploadedNewAfterImages);\r\n+        } catch (error) {\r\n+            console.error(\"Error uploading files:\", error);\r\n+        } finally {\r\n+            setImageLoaderAfter(false);\r\n+        }\r\n+    };\r\n+\r\n+    const handleRemoveImage3 = (index) => {\r\n+        setAfterImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n+    };\r\n+    useEffect(() => {\r\n+        let interval;\r\n+        if (timer > 0) {\r\n+            interval = setInterval(() => {\r\n+                setTimer((prev) => prev - 1);\r\n+            }, 1000);\r\n+        } else {\r\n+            clearInterval(interval);\r\n+        }\r\n+        return () => clearInterval(interval);\r\n+    }, [timer]);\r\n+\r\n+    const getDocuments = async () => {\r\n+        try {\r\n+            let params = {\r\n+                page: 1,\r\n+                limit: 999\r\n+            };\r\n+\r\n+            const data = await ApiServices.getAfterCareDocuments(params);\r\n+\r\n+\r\n+\r\n+            setDocuments(\r\n+                data?.data?.documents?.map((doc) => ({\r\n+\r\n+                    id: doc?._id, // Example transformation\r\n+                    name: doc.title, // Another example\r\n+                }))\r\n+            );\r\n+\r\n+\r\n+\r\n+        } catch (error) {\r\n+            console.error(\"Error fetching location:\", error);\r\n+        }\r\n+    };\r\n+    const getPatients = async () => {\r\n+        try {\r\n+            let params = {\r\n+                page: 1,\r\n+                limit: 999\r\n+            };\r\n+\r\n+            const data = await ApiServices.getPatients(params);\r\n+\r\n+\r\n+\r\n+            setPatients(\r\n+                data?.data?.patients?.map((doc) => ({\r\n+                    ...doc,\r\n+                    id: doc?._id, // Example transformation\r\n+                    name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n+                }))\r\n+            );\r\n+\r\n+        } catch (error) {\r\n+            console.error(\"Error fetching location:\", error);\r\n+        }\r\n+    };\r\n+    useEffect(() => {\r\n+        getPatients()\r\n+        getDocuments()\r\n+    }, [])\r\n+    useEffect(() => {\r\n+        // Disable drawing on the single canvas\r\n+        if (sigCanvas.current) {\r\n+            sigCanvas.current.off();\r\n+        }\r\n+\r\n+        // Disable drawing on all multiple canvases\r\n+        signCanvasRefs.current.forEach((canvas) => {\r\n+            if (canvas) {\r\n+                canvas.off();\r\n+            }\r\n+        });\r\n+    }, []);\r\n+    const getData = async () => {\r\n+        try {\r\n+            let params = {\r\n+                id: id,\r\n+\r\n+            };\r\n+\r\n+            const data = await ApiServices.getFormDetail(params);\r\n+            let form = data?.data?.form\r\n+            setValue('treatmentDate',dayjs(form?.treatment_date))\r\n+            setValue('consultationDate',dayjs(form?.consultation_date))\r\n+            setPermissions({\r\n+                marketing: form?.permission_marketing ?  'yes' : 'no',\r\n+                offers: form?.offers?  'yes' : 'no',\r\n+            })\r\n+            setFormData(form)\r\n+        \r\n+            setSignature(form?.treatment_plan?.patient_sign) \r\n+            setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n+            setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n+            setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n+            setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n+            setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n+            setValue(\"records\", form?.treatment_record);\r\n+            setValue(\"furtherFields\", form?.further_treatment);\r\n+            setValue(\"extranotes\", form?.extra_notes);\r\n+            setUploadedImages(form?.batch_images)\r\n+            setBeforeImages(form?.before_images)\r\n+            setAfterImages(form?.after_images)\r\n+\r\n+        } catch (error) {\r\n+            console.error(\"Error fetching location:\", error);\r\n+        }\r\n+    };\r\n+    console.log(permissions);\r\n+    \r\n+    useEffect(() => {\r\n+        getData()\r\n+    }, [])\r\n+    useEffect(() => {\r\n+        let value=patients?.find(item => item?._id == formData?.patient_id)\r\n+        setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n+        setSelectedDocument(documents?.find(item => item?._id == formData?.aftercare_document))\r\n+        \r\n+        setValue('fname', value?.first_name || \"\");\r\n+        setValue('lname', value?.last_name || \"\");\r\n+        setValue('email', value?.email || \"\");\r\n+        setValue('post', value?.post_code || \"\");\r\n+        setValue('phone', value?.phone || \"\");\r\n+        setValue('address', value?.address || \"\");\r\n+        setValue('notes', value?.notes || \"\");\r\n+        setValue('name', value?.kin_details?.name || \"\");\r\n+        setValue('kinemail', value?.kin_details?.email || \"\");\r\n+        setValue('kinphone', value?.kin_details?.phone || \"\");\r\n+        setValue('kinaddress', value?.kin_details?.address || \"\");\r\n+        setValue('genname', value?.general_practitioner?.name || \"\");\r\n+        setValue('genemail', value?.general_practitioner?.email || \"\");\r\n+        setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n+        setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n+        console.log(\"Raw DOB:\", value?.dob);\r\n+\r\n+        if (value?.dob) {\r\n+            // Convert to Dayjs format\r\n+            const parsedDate = dayjs(value.dob);\r\n+\r\n+            // Check if the conversion is valid\r\n+            if (!parsedDate.isValid()) {\r\n+                console.error(\"Invalid DOB Format:\", value.dob);\r\n+                return;\r\n+            }\r\n+\r\n+            console.log(\"Parsed Date:\", parsedDate);\r\n+            setValue(\"selectedDate\", parsedDate);\r\n+        }\r\n+\r\n+    }, [patients,documents])\r\n+    \r\n+\r\n+    return (\r\n+        <div>\r\n+\r\n+            <Paper sx={{ width: \"100%\", overflow: \"hidden\", boxShadow: 'none', backgroundColor: '#eff6ff', borderRadius: '12px' }}>\r\n+\r\n+\r\n+\r\n+                <Box component={'form'} p={3} sx={{ borderRadius: '12px' }} onSubmit={handleSubmit(UpdateConsentForm)} >\r\n+                    <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\r\n+                        Medical History Form\r\n+                    </Typography>\r\n+\r\n+                    <Grid container mt={4} spacing={2}>\r\n+\r\n+\r\n+                        <Grid item xs={3} mt={2}>\r\n+                            <InputLabel sx={{\r\n+                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                fontSize: \"14px\",\r\n+                                color: \"#333\",\r\n+                                marginBottom: \"4px\",\r\n+                            }}>\r\n+\r\n+                                Select Form :\r\n+                            </InputLabel>\r\n+                            <SelectField\r\n+                                size={'small'}\r\n+                                newLabel={'Select Form'}\r\n+                                fullWidth={true}\r\n+                                options={[]}\r\n+                                selected={title}\r\n+                                onSelect={(value) => {\r\n+                                    setTitle(value)\r\n+\r\n+\r\n+                                }}\r\n+                                error={errors?.title?.message}\r\n+                                register={register(\"title\", {\r\n+                                    required: false,\r\n+                                })}\r\n+                            />\r\n+\r\n+                        </Grid>\r\n+                        <Grid item xs={3} mt={2}>\r\n+                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n+                                <Grid container spacing={2}>\r\n+                                    {/* Single Date Selection */}\r\n+                                    <Grid item xs={12}>\r\n+                                        <Box>\r\n+                                            <InputLabel sx={{\r\n+                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                                fontSize: \"14px\",\r\n+                                                color: \"#333\",\r\n+                                                marginBottom: 1.5,\r\n+                                            }}>\r\n+                                                Treatment Date :*\r\n+                                            </InputLabel>\r\n+                                            <Controller\r\n+                                                name=\"treatmentDate\"\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: '12px',\r\n+                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n+                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.treatmentDate && (\r\n+                                                <Typography color=\"error\">{errors.treatmentDate.message}</Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n+\r\n+\r\n+\r\n+\r\n+                                </Grid>\r\n+\r\n+\r\n+                            </LocalizationProvider>\r\n+                        </Grid>\r\n+                        <Grid item xs={3} mt={2}>\r\n+                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n+                                <Grid container spacing={2}>\r\n+                                    {/* Single Date Selection */}\r\n+                                    <Grid item xs={12}>\r\n+                                        <Box>\r\n+                                            <InputLabel sx={{\r\n+                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                                fontSize: \"14px\",\r\n+                                                color: \"#333\",\r\n+                                                marginBottom: 1.5,\r\n+                                            }}>\r\n+                                                Consultation Date :*\r\n+                                            </InputLabel>\r\n+                                            <Controller\r\n+                                                name=\"consultationDate\"\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: '12px',\r\n+                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n+                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.consultationDate && (\r\n+                                                <Typography color=\"error\">{errors.consultationDate.message}</Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n+\r\n+\r\n+\r\n+\r\n+                                </Grid>\r\n+\r\n+\r\n+                            </LocalizationProvider>\r\n+                        </Grid>\r\n+                        <Grid container p={2} spacing={2} >\r\n+\r\n+                            <Grid item xs={3} mt={2}>\r\n+                                <InputLabel sx={{\r\n+                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                    fontSize: \"14px\",\r\n+                                    color: \"#333\",\r\n+                                    marginBottom: \"4px\",\r\n+                                }}>\r\n+\r\n+                                    Existing or New Patient :\r\n+                                </InputLabel>\r\n+                                <FormControl component=\"fieldset\">\r\n+\r\n+                                    <RadioGroup row value={patientType} onChange={handleChange}>\r\n+                                        <FormControlLabel value=\"existing\" control={<Radio />} label=\"Existing\" />\r\n+                                        <FormControlLabel value=\"new\" control={<Radio />} label=\"New\" />\r\n+                                    </RadioGroup>\r\n+                                </FormControl>\r\n+                            </Grid>\r\n+                            <Grid item xs={3} mt={2}>\r\n+                                {patientType == 'existing' && <> <InputLabel sx={{\r\n+                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                    fontSize: \"14px\",\r\n+                                    color: \"#333\",\r\n+                                    marginBottom: \"4px\",\r\n+                                }}>\r\n+\r\n+                                    Select Patient :\r\n+                                </InputLabel>\r\n+                                    <SelectField\r\n+                                        size={'small'}\r\n+                                        newLabel={'Select Patient'}\r\n+                                        fullWidth={true}\r\n+                                        disabled={true}\r\n+                                        options={patients}\r\n+                                        selected={selectedPatient}\r\n+                                        onSelect={(value) => {\r\n+                                            setSelectedPatient(value);\r\n+                                            console.log(\"Selected Patient:\", value);\r\n+\r\n+                                            setValue('fname', value?.first_name || \"\");\r\n+                                            setValue('lname', value?.last_name || \"\");\r\n+                                            setValue('email', value?.email || \"\");\r\n+                                            setValue('post', value?.post_code || \"\");\r\n+                                            setValue('phone', value?.phone || \"\");\r\n+                                            setValue('address', value?.address || \"\");\r\n+                                            setValue('notes', value?.notes || \"\");\r\n+                                            setValue('name', value?.kin_details?.name || \"\");\r\n+                                            setValue('kinemail', value?.kin_details?.email || \"\");\r\n+                                            setValue('kinphone', value?.kin_details?.phone || \"\");\r\n+                                            setValue('kinaddress', value?.kin_details?.address || \"\");\r\n+                                            setValue('genname', value?.general_practitioner?.name || \"\");\r\n+                                            setValue('genemail', value?.general_practitioner?.email || \"\");\r\n+                                            setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n+                                            setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n+                                            console.log(\"Raw DOB:\", value?.dob);\r\n+\r\n+                                            if (value?.dob) {\r\n+                                                // Convert to Dayjs format\r\n+                                                const parsedDate = dayjs(value.dob);\r\n+\r\n+                                                // Check if the conversion is valid\r\n+                                                if (!parsedDate.isValid()) {\r\n+                                                    console.error(\"Invalid DOB Format:\", value.dob);\r\n+                                                    return;\r\n+                                                }\r\n+\r\n+                                                console.log(\"Parsed Date:\", parsedDate);\r\n+                                                setValue(\"selectedDate\", parsedDate);\r\n+                                            }\r\n+                                        }}\r\n+                                        error={errors?.patient?.message}\r\n+                                        register={register(\"patient\", {\r\n+                                            required: false,\r\n+                                        })}\r\n+                                    />\r\n+                                </>}\r\n+                            </Grid>\r\n+                            <Grid item xs={3} mt={2}>\r\n+                                {patientType == 'existing' && <><InputLabel sx={{\r\n+                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                    fontSize: \"14px\",\r\n+                                    color: \"#333\",\r\n+                                    marginBottom: \"4px\",\r\n+                                }}>\r\n+\r\n+                                    Select Aftercare Document :\r\n+                                </InputLabel>\r\n+                                    <SelectField\r\n+                                        size={'small'}\r\n+                                        newLabel={'Select Document'}\r\n+                                        fullWidth={true}\r\n+                                        options={documents}\r\n+                                        selected={selectedDocument}\r\n+                                        onSelect={(value) => {\r\n+                                            setSelectedDocument(value)\r\n+\r\n+\r\n+                                        }}\r\n+                                        error={errors?.document?.message}\r\n+                                        register={register(\"document\", {\r\n+                                            required: false,\r\n+                                        })}\r\n+                                    /> </>}\r\n+                            </Grid>\r\n+                        </Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Patient First Name :*\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Patient First Name\"}\r\n+                            error={errors?.fname?.message}\r\n+                            register={register(\"fname\", {\r\n+                                required:\r\n+                                    \"Please enter your fname.\"\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Patient Last Name :*\"}\r\n+                            size={'small'}\r\n+                            placeholder={\" Patient Last Name\"}\r\n+                            error={errors?.lname?.message}\r\n+                            register={register(\"lname\", {\r\n+                                required:\r\n+                                    \"Please enter your lname.\"\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Patient Email :*\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Patient Email\"}\r\n+                            error={errors?.email?.message}\r\n+                            register={register(\"email\", {\r\n+                                required:\r\n+                                    \"Please enter your email.\"\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}>\r\n+                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n+                                <Grid container spacing={2}>\r\n+                                    {/* Single Date Selection */}\r\n+                                    <Grid item xs={12}>\r\n+                                        <Box>\r\n+                                            <InputLabel sx={{\r\n+                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                                fontSize: \"14px\",\r\n+                                                color: \"#333\",\r\n+                                                marginBottom: 1.5,\r\n+                                            }}>\r\n+                                                DOB :*\r\n+                                            </InputLabel>\r\n+                                            <Controller\r\n+                                                name=\"selectedDate\"\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: '12px',\r\n+                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n+                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.selectedDate && (\r\n+                                                <Typography color=\"error\">{errors.selectedDate.message}</Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n+\r\n+\r\n+\r\n+\r\n+                                </Grid>\r\n+\r\n+\r\n+                            </LocalizationProvider>\r\n+                        </Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Phone Number :*\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Phone Number\"}\r\n+                            error={errors?.phone?.message}\r\n+                            register={register(\"phone\", {\r\n+                                required:\r\n+                                    \"Please enter your phone.\"\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Post Code :*\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Post Code\"}\r\n+                            error={errors?.post?.message}\r\n+                            register={register(\"post\", {\r\n+                                required:\r\n+                                    \"Please enter your postcode.\"\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Address :*\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Address\"}\r\n+                            error={errors?.address?.message}\r\n+                            register={register(\"address\", {\r\n+                                required:\r\n+                                    \"Please enter your address.\"\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Notes :\"}\r\n+                            multiline\r\n+                            rows={3}\r\n+                            size={'small'}\r\n+                            placeholder={\"Notes\"}\r\n+                            error={errors?.notes?.message}\r\n+                            register={register(\"notes\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+\r\n+                    </Grid>\r\n+                    <Divider sx={{ mt: 4 }} />\r\n+                    <Typography variant=\"h5\" sx={{ fontWeight: 700, mt: 4 }}>\r\n+                        Next of Kin Details\r\n+                    </Typography>\r\n+                    <Grid container mt={4} spacing={2}>\r\n+\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Name :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Name\"}\r\n+                            error={errors?.name?.message}\r\n+                            register={register(\"name\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Email :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Email\"}\r\n+                            error={errors?.kinemail?.message}\r\n+                            register={register(\"kinemail\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Phone Number :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Phone Number\"}\r\n+                            error={errors?.kinphone?.message}\r\n+                            register={register(\"kinphone\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Address :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Address\"}\r\n+                            error={errors?.kinaddress?.message}\r\n+                            register={register(\"kinaddress\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+\r\n+\r\n+                    </Grid>\r\n+                    <Divider sx={{ mt: 4 }} />\r\n+                    <Typography variant=\"h5\" sx={{ fontWeight: 700, mt: 4 }}>\r\n+                        General Practitioners(GP / Doctors)\r\n+                    </Typography>\r\n+                    <Grid container mt={4} spacing={2}>\r\n+\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Name :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Name\"}\r\n+                            error={errors?.genname?.message}\r\n+                            register={register(\"genname\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Email :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Email\"}\r\n+                            error={errors?.genemail?.message}\r\n+                            register={register(\"genemail\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Phone Number :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Phone Number\"}\r\n+                            error={errors?.genphone?.message}\r\n+                            register={register(\"genphone\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+\r\n+                        <Grid item xs={3} mt={2}><InputField\r\n+                            label={\"Address :\"}\r\n+                            size={'small'}\r\n+                            placeholder={\"Address\"}\r\n+                            error={errors?.genaddress?.message}\r\n+                            register={register(\"genaddress\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Grid container spacing={2} p={2}>\r\n+                            {/* Marketing Permission */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we have permission to use your images for marketing?</FormLabel>\r\n+                                <FormControl component=\"fieldset\">\r\n+\r\n+                                    <RadioGroup row name=\"marketing\" value={permissions.marketing} onChange={handleChange2}>\r\n+                                        <FormControlLabel value=\"yes\" control={<Radio />} label=\"Yes\" />\r\n+                                        <FormControlLabel value=\"no\" control={<Radio />} label=\"No\" />\r\n+                                    </RadioGroup>\r\n+                                </FormControl>\r\n+                            </Grid>\r\n+\r\n+                            {/* Offers & Reminders Permission */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we send you offers & reminders by text email & WhatsApp?</FormLabel>\r\n+                                <FormControl component=\"fieldset\">\r\n+\r\n+                                    <RadioGroup row name=\"offers\" value={permissions.offers} onChange={handleChange2}>\r\n+                                        <FormControlLabel value=\"yes\" control={<Radio />} label=\"Yes\" />\r\n+                                        <FormControlLabel value=\"no\" control={<Radio />} label=\"No\" />\r\n+                                    </RadioGroup>\r\n+                                </FormControl>\r\n+                            </Grid>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Typography variant=\"h5\" fontWeight=\"bold\" mb={2} p={2}>\r\n+                            Treatment plan section\r\n+                        </Typography>\r\n+\r\n+                        <Grid container spacing={2} p={2}>\r\n+                            {/* Patient Concerns */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <InputField\r\n+                                    label=\"Patient concerns\"\r\n+                                    size=\"small\"\r\n+                                    placeholder=\"Patient concerns\"\r\n+                                    error={errors?.patientConcerns?.message}\r\n+                                    register={register(\"patientConcerns\", { required: false })}\r\n+                                    multiline\r\n+                                    rows={4}\r\n+                                />\r\n+                            </Grid>\r\n+\r\n+                            {/* Patient Goal */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <InputField\r\n+                                    label=\"Patient goal\"\r\n+                                    size=\"small\"\r\n+                                    placeholder=\"Patient goal\"\r\n+                                    error={errors?.patientGoal?.message}\r\n+                                    register={register(\"patientGoal\", { required: false })}\r\n+                                    multiline\r\n+                                    rows={4}\r\n+                                />\r\n+                            </Grid>\r\n+\r\n+                            {/* Advised Plan/Product */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <InputField\r\n+                                    label=\"Advised Plan/product\"\r\n+                                    size=\"small\"\r\n+                                    placeholder=\"Advised Plan/product\"\r\n+                                    error={errors?.advisedPlan?.message}\r\n+                                    register={register(\"advisedPlan\", { required: false })}\r\n+                                    multiline\r\n+                                    rows={4}\r\n+                                />\r\n+                            </Grid>\r\n+\r\n+                            {/* Expected Result */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <InputField\r\n+                                    label=\"Expected Result\"\r\n+                                    size=\"small\"\r\n+                                    placeholder=\"Expected Result\"\r\n+                                    error={errors?.expectedResult?.message}\r\n+                                    register={register(\"expectedResult\", { required: false })}\r\n+                                    multiline\r\n+                                    rows={4}\r\n+                                />\r\n+                            </Grid>\r\n+                        </Grid>\r\n+                        <Typography variant=\"p\" fontWeight={500} mb={2} p={2}>\r\n+                            I confirm my medical history to be true and correct. I agree I have read and understood all the contents of this document. I have read and understood all the content of this document and agree with the treatment plan. I give my consent to treatment and understand the possible complications and side effects. I confirm I have received an aftercare sheet\r\n+                        </Typography>\r\n+                        <Grid container spacing={5} p={2} alignItems=\"center\">\r\n+                            {/* Date Field */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n+                                    <Grid container spacing={2}>\r\n+                                        {/* Single Date Selection */}\r\n+                                        <Grid item xs={12}>\r\n+                                            <Box>\r\n+                                                <InputLabel sx={{\r\n+                                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n+\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}>\r\n+                                                    Patient Date :*\r\n+                                                </InputLabel>\r\n+                                                <Controller\r\n+                                                    name=\"patientDate\"\r\n+                                                    control={control}\r\n+                                                    rules={{ required: \"Please select a date\" }}\r\n+                                                    render={({ field }) => (\r\n+                                                        <DatePicker\r\n+                                                            {...field}\r\n+                                                            value={field.value || null}\r\n+                                                            onChange={(newValue) => field.onChange(newValue)}\r\n+                                                            slotProps={{\r\n+                                                                textField: {\r\n+                                                                    size: \"small\",\r\n+                                                                    fullWidth: true,\r\n+                                                                    sx: {\r\n+                                                                        \"& .MuiOutlinedInput-root\": {\r\n+                                                                            borderRadius: '12px',\r\n+                                                                            \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n+                                                                            \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n+                                                                            \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n+                                                                        },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            }}\r\n+                                                        />\r\n+                                                    )}\r\n+                                                />\r\n+                                                {errors.patientDate && (\r\n+                                                    <Typography color=\"error\">{errors.patientDate.message}</Typography>\r\n+                                                )}\r\n+                                            </Box>\r\n+                                        </Grid>\r\n+\r\n+\r\n+\r\n+\r\n+                                    </Grid>\r\n+\r\n+\r\n+                                </LocalizationProvider>\r\n+                            </Grid>\r\n+\r\n+                            {/* Signature Canvas */}\r\n+                            <Grid item xs={6} mt={2}>\r\n+                                <Typography>Patient Signature:</Typography>\r\n+                                <SignatureCanvas\r\n+                                    ref={sigCanvas}\r\n+                                    penColor=\"black\"\r\n+                                    canvasProps={{\r\n+                                        width: 300,\r\n+                                        height: 150,\r\n+                                        className: \"sigCanvas\",\r\n+                                        style: { border: \"1px dashed black\" },\r\n+                                    }}\r\n+                                />\r\n+                                <Grid container spacing={1} mt={1}>\r\n+                                    <Grid item>\r\n+                                        <Button variant=\"contained\" color=\"secondary\" onClick={handleClear}>\r\n+                                            Clear Signature\r\n+                                        </Button>\r\n+                                    </Grid>\r\n+                                    <Grid item>\r\n+                                        <Button variant=\"contained\" color=\"primary\" onClick={handleSave}>\r\n+                                            Save Signature\r\n+                                        </Button>\r\n+                                    </Grid>\r\n+\r\n+                                </Grid>\r\n+\r\n+\r\n+                            </Grid>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n+\r\n+                        <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n+                            {fields.map((item, index) => (\r\n+                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+\r\n+                                    {/* Patient Date Selection */}\r\n+                                    <Grid item xs={3}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Date :*\r\n+                                            </InputLabel>\r\n+\r\n+                                            <Controller\r\n+                                                name={`records.${index}.date`}\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: \"12px\",\r\n+                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.records?.[index]?.date && (\r\n+                                                <Typography color=\"error\">\r\n+                                                    {errors.records[index].date.message}\r\n+                                                </Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n+\r\n+                                    {/* Amount Field */}\r\n+                                    <Grid item xs={3} mt={2}>\r\n+                                        <InputField\r\n+                                            label=\"Amount\"\r\n+                                            placeholder=\"Order Amount\"\r\n+                                            size=\"small\"\r\n+                                            {...register(`records.${index}.amount`)}\r\n+                                        />\r\n+                                    </Grid>\r\n+\r\n+\r\n+\r\n+                                    {/* Description Field */}\r\n+                                    <Grid item xs={4}>\r\n+                                        <InputField\r\n+                                            label=\"Description\"\r\n+                                            multiline\r\n+                                            rows={3}\r\n+                                            placeholder=\"Description\"\r\n+                                            {...register(`records.${index}.description`)}\r\n+                                        />\r\n+                                    </Grid>\r\n+                                    {/* Remove Button (only for additional fields) */}\r\n+                                    <Grid item xs={1}>\r\n+                                        {index > 0 && (\r\n+                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                                                <DeleteIcon />\r\n+                                            </IconButton>\r\n+                                        )}\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            ))}\r\n+                        </LocalizationProvider>\r\n+\r\n+\r\n+\r\n+                        <Grid container p={2}>\r\n+                            <Button\r\n+                                variant=\"contained\"\r\n+                                color=\"primary\"\r\n+                                onClick={() => append({ date: \"\", amount: \"\", description: \"\" })}\r\n+                                sx={{ mt: 2, textTransform: 'capitalize' }}\r\n+                            >\r\n+                                Add More\r\n+                            </Button>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Grid item xs={12} sm={5}>\r\n+                            <InputLabel sx={{\r\n+                                textTransform: \"capitalize\", mt: 2,\r\n+                                textAlign: \"left\",\r\n+                                fontWeight: 600,\r\n+                                fontSize: \"14px\",\r\n+                                color: \"#333\",\r\n+                                marginBottom: \"4px\",\r\n+                            }}>\r\n+                                Upload Batch Images :*\r\n+                            </InputLabel>\r\n+\r\n+                            <Controller\r\n+                                name=\"media\"\r\n+                                control={control}\r\n+                                rules={{\r\n+                                    required: \"At least one image file is required\",\r\n+                                    validate: (value) => {\r\n+                                        if (!value || value.length === 0) {\r\n+                                            return \"At least one image file is required\";\r\n+                                        }\r\n+                                        for (let i = 0; i < value.length; i++) {\r\n+                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n+                                                return \"Each file must be smaller than 10MB\";\r\n+                                            }\r\n+                                            if (!value[i].type.startsWith(\"image/\")) {\r\n+                                                return \"Only image files are allowed\";\r\n+                                            }\r\n+                                        }\r\n+                                        return true;\r\n+                                    },\r\n+                                }}\r\n+                                render={({ field: { onChange } }) => (\r\n+                                    <>\r\n+                                        <Box\r\n+                                            sx={{\r\n+                                                borderRadius: \"8px\",\r\n+                                                padding: \"20px\",\r\n+                                                textAlign: \"center\",\r\n+                                                cursor: \"pointer\",\r\n+                                                backgroundColor: \"#f9f9f9\",\r\n+                                                height: '135px',\r\n+                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n+                                            }}\r\n+                                            onClick={() => document.getElementById(\"upload-media\").click()}\r\n+                                        >\r\n+                                            {!imageLoader ? (\r\n+                                                <>\r\n+                                                    <input\r\n+                                                        type=\"file\"\r\n+                                                        accept=\"image/*\"\r\n+                                                        multiple\r\n+                                                        style={{ display: \"none\" }}\r\n+                                                        id=\"upload-media\"\r\n+                                                        onChange={(e) => {\r\n+                                                            const files = Array.from(e.target.files);\r\n+                                                            onChange(files); // Update react-hook-form\r\n+                                                            handleFileChange2(e); // Handle upload logic\r\n+                                                        }}\r\n+                                                    />\r\n+                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n+                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n+                                                        Drag & drop or click to upload images\r\n+                                                    </Typography>\r\n+                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n+                                                        Allowed: Images (Max 10MB per file)\r\n+                                                    </Typography>\r\n+                                                </>\r\n+                                            ) : (\r\n+                                                <CircularProgress size={90} />\r\n+                                            )}\r\n+                                        </Box>\r\n+\r\n+                                        {errors.media && (\r\n+                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n+                                                {errors.media.message}\r\n+                                            </Typography>\r\n+                                        )}\r\n+                                    </>\r\n+                                )}\r\n+                            />\r\n+                        </Grid>\r\n+\r\n+                        <Grid container p={2}>\r\n+                            {uploadedImages?.length > 0 && (\r\n+                                <Grid item xs={12}>\r\n+                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n+                                        Uploaded Batch Images :\r\n+                                    </InputLabel>\r\n+                                </Grid>\r\n+                            )}\r\n+                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n+                                {uploadedImages?.length > 0 &&\r\n+                                    uploadedImages.map((file, index) => (\r\n+                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n+                                            <img\r\n+                                                src={file}\r\n+                                                alt=\"Uploaded Preview\"\r\n+                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n+                                            />\r\n+                                            <Typography\r\n+                                                variant=\"caption\"\r\n+                                                sx={{\r\n+                                                    display: \"block\",\r\n+                                                    mt: 1,\r\n+                                                    maxWidth: \"150px\",\r\n+                                                    whiteSpace: \"nowrap\",\r\n+                                                    overflow: \"hidden\",\r\n+                                                    textOverflow: \"ellipsis\",\r\n+                                                }}\r\n+                                            >\r\n+                                                {file.split(\"/\").pop()}\r\n+                                            </Typography>\r\n+                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n+                                                <IconButton\r\n+                                                    onClick={() => handleRemoveImage(index)}\r\n+                                                    sx={{\r\n+                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n+                                                        color: \"#fff\",\r\n+                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n+                                                        width: 20,\r\n+                                                        height: 20,\r\n+                                                        borderRadius: \"50%\",\r\n+                                                        p: 0.5,\r\n+                                                    }}\r\n+                                                >\r\n+                                                    <CloseIcon fontSize=\"small\" />\r\n+                                                </IconButton>\r\n+                                            </Box>\r\n+                                        </Box>\r\n+                                    ))}\r\n+                            </Box>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Grid item xs={12} sm={5}>\r\n+                            <InputLabel sx={{\r\n+                                textTransform: \"capitalize\", mt: 2,\r\n+                                textAlign: \"left\",\r\n+                                fontWeight: 600,\r\n+                                fontSize: \"14px\",\r\n+                                color: \"#333\",\r\n+                                marginBottom: \"4px\",\r\n+                            }}>\r\n+                                Upload Before Images :*\r\n+                            </InputLabel>\r\n+\r\n+                            <Controller\r\n+                                name=\"media2\"\r\n+                                control={control}\r\n+                                rules={{\r\n+                                    required: \"At least one image file is required\",\r\n+                                    validate: (value) => {\r\n+                                        if (!value || value.length === 0) {\r\n+                                            return \"At least one image file is required\";\r\n+                                        }\r\n+                                        for (let i = 0; i < value.length; i++) {\r\n+                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n+                                                return \"Each file must be smaller than 10MB\";\r\n+                                            }\r\n+                                            if (!value[i].type.startsWith(\"image/\")) {\r\n+                                                return \"Only image files are allowed\";\r\n+                                            }\r\n+                                        }\r\n+                                        return true;\r\n+                                    },\r\n+                                }}\r\n+                                render={({ field: { onChange } }) => (\r\n+                                    <>\r\n+                                        <Box\r\n+                                            sx={{\r\n+                                                borderRadius: \"8px\",\r\n+                                                padding: \"20px\",\r\n+                                                textAlign: \"center\",\r\n+                                                cursor: \"pointer\",\r\n+                                                backgroundColor: \"#f9f9f9\",\r\n+                                                height: '135px',\r\n+                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n+                                            }}\r\n+                                            onClick={() => document.getElementById(\"upload-media2\").click()}\r\n+                                        >\r\n+                                            {!imageLoaderBefore ? (\r\n+                                                <>\r\n+                                                    <input\r\n+                                                        type=\"file\"\r\n+                                                        accept=\"image/*\"\r\n+                                                        multiple\r\n+                                                        style={{ display: \"none\" }}\r\n+                                                        id=\"upload-media2\"\r\n+                                                        onChange={(e) => {\r\n+                                                            const files = Array.from(e.target.files);\r\n+                                                            onChange(files); // Update react-hook-form\r\n+                                                            handleFileChange3(e); // Handle upload logic\r\n+                                                        }}\r\n+                                                    />\r\n+                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n+                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n+                                                        Drag & drop or click to upload images\r\n+                                                    </Typography>\r\n+                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n+                                                        Allowed: Images (Max 10MB per file)\r\n+                                                    </Typography>\r\n+                                                </>\r\n+                                            ) : (\r\n+                                                <CircularProgress size={90} />\r\n+                                            )}\r\n+                                        </Box>\r\n+\r\n+                                        {errors.media2 && (\r\n+                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n+                                                {errors.media2.message}\r\n+                                            </Typography>\r\n+                                        )}\r\n+                                    </>\r\n+                                )}\r\n+                            />\r\n+                        </Grid>\r\n+\r\n+                        <Grid container p={2}>\r\n+                            {beforeImages?.length > 0 && (\r\n+                                <Grid item xs={12}>\r\n+                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n+                                        Uploaded Before Images :\r\n+                                    </InputLabel>\r\n+                                </Grid>\r\n+                            )}\r\n+                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n+                                {beforeImages?.length > 0 &&\r\n+                                    beforeImages.map((file, index) => (\r\n+                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n+                                            <img\r\n+                                                src={file}\r\n+                                                alt=\"Uploaded Preview\"\r\n+                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n+                                            />\r\n+                                            <Typography\r\n+                                                variant=\"caption\"\r\n+                                                sx={{\r\n+                                                    display: \"block\",\r\n+                                                    mt: 1,\r\n+                                                    maxWidth: \"150px\",\r\n+                                                    whiteSpace: \"nowrap\",\r\n+                                                    overflow: \"hidden\",\r\n+                                                    textOverflow: \"ellipsis\",\r\n+                                                }}\r\n+                                            >\r\n+                                                {file.split(\"/\").pop()}\r\n+                                            </Typography>\r\n+                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n+                                                <IconButton\r\n+                                                    onClick={() => handleRemoveImage2(index)}\r\n+                                                    sx={{\r\n+                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n+                                                        color: \"#fff\",\r\n+                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n+                                                        width: 20,\r\n+                                                        height: 20,\r\n+                                                        borderRadius: \"50%\",\r\n+                                                        p: 0.5,\r\n+                                                    }}\r\n+                                                >\r\n+                                                    <CloseIcon fontSize=\"small\" />\r\n+                                                </IconButton>\r\n+                                            </Box>\r\n+                                        </Box>\r\n+                                    ))}\r\n+                            </Box>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Grid item xs={12} sm={5}>\r\n+                            <InputLabel sx={{\r\n+                                textTransform: \"capitalize\", mt: 2,\r\n+                                textAlign: \"left\",\r\n+                                fontWeight: 600,\r\n+                                fontSize: \"14px\",\r\n+                                color: \"#333\",\r\n+                                marginBottom: \"4px\",\r\n+                            }}>\r\n+                                Upload After Images :*\r\n+                            </InputLabel>\r\n+\r\n+                            <Controller\r\n+                                name=\"media3\"\r\n+                                control={control}\r\n+                                rules={{\r\n+                                    required: \"At least one image file is required\",\r\n+                                    validate: (value) => {\r\n+                                        if (!value || value.length === 0) {\r\n+                                            return \"At least one image file is required\";\r\n+                                        }\r\n+                                        for (let i = 0; i < value.length; i++) {\r\n+                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n+                                                return \"Each file must be smaller than 10MB\";\r\n+                                            }\r\n+                                            if (!value[i].type.startsWith(\"image/\")) {\r\n+                                                return \"Only image files are allowed\";\r\n+                                            }\r\n+                                        }\r\n+                                        return true;\r\n+                                    },\r\n+                                }}\r\n+                                render={({ field: { onChange } }) => (\r\n+                                    <>\r\n+                                        <Box\r\n+                                            sx={{\r\n+                                                borderRadius: \"8px\",\r\n+                                                padding: \"20px\",\r\n+                                                textAlign: \"center\",\r\n+                                                cursor: \"pointer\",\r\n+                                                backgroundColor: \"#f9f9f9\",\r\n+                                                height: '135px',\r\n+                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n+                                            }}\r\n+                                            onClick={() => document.getElementById(\"upload-media3\").click()}\r\n+                                        >\r\n+                                            {!imageLoaderAfter ? (\r\n+                                                <>\r\n+                                                    <input\r\n+                                                        type=\"file\"\r\n+                                                        accept=\"image/*\"\r\n+                                                        multiple\r\n+                                                        style={{ display: \"none\" }}\r\n+                                                        id=\"upload-media3\"\r\n+                                                        onChange={(e) => {\r\n+                                                            const files = Array.from(e.target.files);\r\n+                                                            onChange(files); // Update react-hook-form\r\n+                                                            handleFileChange4(e); // Handle upload logic\r\n+                                                        }}\r\n+                                                    />\r\n+                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n+                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n+                                                        Drag & drop or click to upload images\r\n+                                                    </Typography>\r\n+                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n+                                                        Allowed: Images (Max 10MB per file)\r\n+                                                    </Typography>\r\n+                                                </>\r\n+                                            ) : (\r\n+                                                <CircularProgress size={90} />\r\n+                                            )}\r\n+                                        </Box>\r\n+\r\n+                                        {errors.media3 && (\r\n+                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n+                                                {errors.media3.message}\r\n+                                            </Typography>\r\n+                                        )}\r\n+                                    </>\r\n+                                )}\r\n+                            />\r\n+                        </Grid>\r\n+\r\n+                        <Grid container p={2}>\r\n+                            {afterImages?.length > 0 && (\r\n+                                <Grid item xs={12}>\r\n+                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n+                                        Uploaded After Images :\r\n+                                    </InputLabel>\r\n+                                </Grid>\r\n+                            )}\r\n+                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n+                                {afterImages?.length > 0 &&\r\n+                                    afterImages.map((file, index) => (\r\n+                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n+                                            <img\r\n+                                                src={file}\r\n+                                                alt=\"Uploaded Preview\"\r\n+                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n+                                            />\r\n+                                            <Typography\r\n+                                                variant=\"caption\"\r\n+                                                sx={{\r\n+                                                    display: \"block\",\r\n+                                                    mt: 1,\r\n+                                                    maxWidth: \"150px\",\r\n+                                                    whiteSpace: \"nowrap\",\r\n+                                                    overflow: \"hidden\",\r\n+                                                    textOverflow: \"ellipsis\",\r\n+                                                }}\r\n+                                            >\r\n+                                                {file.split(\"/\").pop()}\r\n+                                            </Typography>\r\n+                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n+                                                <IconButton\r\n+                                                    onClick={() => handleRemoveImage3(index)}\r\n+                                                    sx={{\r\n+                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n+                                                        color: \"#fff\",\r\n+                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n+                                                        width: 20,\r\n+                                                        height: 20,\r\n+                                                        borderRadius: \"50%\",\r\n+                                                        p: 0.5,\r\n+                                                    }}\r\n+                                                >\r\n+                                                    <CloseIcon fontSize=\"small\" />\r\n+                                                </IconButton>\r\n+                                            </Box>\r\n+                                        </Box>\r\n+                                    ))}\r\n+                            </Box>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Typography variant=\"h6\" p={2} sx={{ mt: 4, fontWeight: 'bold' }}>Further Records</Typography>\r\n+\r\n+                        <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n+                            {furtherFields.map((item, index) => (\r\n+                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                                    {/* Date Selection */}\r\n+                                    <Grid item xs={5}>\r\n+                                        <Box>\r\n+                                            <InputLabel sx={{ fontWeight: 700, fontSize: \"14px\", marginBottom: 1.5 }}>\r\n+                                                Further Date :*\r\n+                                            </InputLabel>\r\n+                                            <Controller\r\n+                                                name={`furtherFields.${index}.date`}\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: \"12px\",\r\n+                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.furtherFields?.[index]?.date && (\r\n+                                                <Typography color=\"error\">\r\n+                                                    {errors.furtherFields[index].date.message}\r\n+                                                </Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                        <Typography mt={2}>\r\n+                                            I confirm there has not been any changes to my medical history or my health since completing this form , it is still true and up to date.\r\n+                                        </Typography>\r\n+                                    </Grid>\r\n+\r\n+                                    {/* Signature Field */}\r\n+                                    <Grid item xs={5}>\r\n+                                        <Box>\r\n+                                            <InputLabel sx={{ fontWeight: 700, fontSize: \"14px\", marginBottom: 1 }}>\r\n+                                                Signature :*\r\n+                                            </InputLabel>\r\n+                                            <SignatureCanvas\r\n+                                                ref={(el) => (signCanvasRefs.current[index] = el)}\r\n+                                                penColor=\"black\"\r\n+                                                canvasProps={{ width: 300, height: 150, style: { border: \"1px dashed black\" } }}\r\n+                                            />\r\n+\r\n+                                        </Box>\r\n+                                        <Grid container spacing={1} mt={1}>\r\n+                                            <Grid item>\r\n+                                                <Button variant=\"contained\" color=\"secondary\" onClick={() => clearSignature(index)}>\r\n+                                                    Clear Signature\r\n+                                                </Button>\r\n+                                            </Grid>\r\n+                                            <Grid item>\r\n+                                                <Button variant=\"contained\" color=\"primary\" onClick={() => updateSignature(index)}>\r\n+                                                    Save Signature\r\n+                                                </Button>\r\n+                                            </Grid>\r\n+\r\n+                                        </Grid>\r\n+                                    </Grid>\r\n+\r\n+                                    {/* Remove Button */}\r\n+                                    <Grid item xs={1} display=\"flex\" justifyContent=\"flex-end\">\r\n+                                        {furtherFields.length > 1 && (\r\n+                                            <IconButton color=\"error\" onClick={() => removeFurther(index)}>\r\n+                                                <DeleteIcon />\r\n+                                            </IconButton>\r\n+                                        )}\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            ))}\r\n+                        </LocalizationProvider>\r\n+\r\n+                        <Grid p={2}>\r\n+                            <Button variant=\"contained\" color=\"secondary\" onClick={() => appendFurther({ date: null, sign: \"\" })} sx={{ mt: 2 }}>\r\n+                                Add More Further Records\r\n+                            </Button>\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Grid item xs={6} mt={2}><InputField\r\n+                            label={\"Notes :\"}\r\n+                            multiline\r\n+                            rows={3}\r\n+                            size={'small'}\r\n+                            placeholder={\"Notes\"}\r\n+                            error={errors?.extranotes?.message}\r\n+                            register={register(\"extranotes\", {\r\n+                                required:\r\n+                                    false\r\n+\r\n+                            })}\r\n+                        /></Grid>\r\n+                    </Grid>\r\n+                    <Box sx={{ display: 'flex', justifyContent: 'flex-end', width: '100%', mt: 2 }}>\r\n+                        <PrimaryButton loader={loader} disabled={loader} type={'submit'} title={\"Update\"} />\r\n+                    </Box>\r\n+                </Box>\r\n+            </Paper>\r\n+        </div >\r\n+    )\r\n+}\r\n+\r\n+export default UpdateConsentForm\r\n"
                },
                {
                    "date": 1743283114948,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -660,9 +660,11 @@\n                 marketing: form?.permission_marketing ?  'yes' : 'no',\r\n                 offers: form?.offers?  'yes' : 'no',\r\n             })\r\n             setFormData(form)\r\n-        \r\n+            setValue(\"media\", { shouldValidate: true });\r\n+            setValue(\"media2\", { shouldValidate: true });\r\n+            setValue(\"media2\", { shouldValidate: true });\r\n             setSignature(form?.treatment_plan?.patient_sign) \r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n@@ -2051,2058 +2053,4 @@\n     )\r\n }\r\n \r\n export default UpdateConsentForm\r\n-import { useEffect, useRef, useState } from \"react\";\r\n-import ApiServices from \"../../../services/Apis\";\r\n-import { PrimaryButton } from \"../../../components/buttons\";\r\n-import { Avatar, Box, Button, CircularProgress, Dialog, DialogContent, DialogTitle, Divider, FormControl, FormControlLabel, FormLabel, Grid, IconButton, InputAdornment, InputLabel, Paper, Radio, RadioGroup, TextField, Typography } from \"@mui/material\";\r\n-import InputField from \"../../../components/input\";\r\n-import { Controller, useFieldArray, useForm } from \"react-hook-form\";\r\n-import { useNavigate, useParams } from \"react-router-dom\";\r\n-import axios from \"axios\";\r\n-import { showErrorToast, showPromiseToast, showSuccessToast } from \"../../../components/Toaster\";\r\n-import UploadIcon from \"@mui/icons-material/Upload\";\r\n-import OTPInput from \"react-otp-input\";\r\n-import VisibilityIcon from \"@mui/icons-material/Visibility\";\r\n-import VisibilityOffIcon from \"@mui/icons-material/VisibilityOff\";\r\n-import { Visibility, VisibilityOff } from \"@mui/icons-material\";\r\n-import { DatePicker, LocalizationProvider } from \"@mui/x-date-pickers\";\r\n-import { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\r\n-import SelectField from \"../../../components/select\";\r\n-import SignatureCanvas from \"react-signature-canvas\";\r\n-import moment from \"moment\";\r\n-import DeleteIcon from \"@mui/icons-material/Delete\";\r\n-import UploadFileIcon from '@mui/icons-material/UploadFile';\r\n-import CloseIcon from '@mui/icons-material/Close';\r\n-import dayjs from \"dayjs\";\r\n-import { id } from \"date-fns/locale\";\r\n-\r\n-\r\n-const UpdateConsentForm = () => {\r\n-    const { id } = useParams()\r\n-    const navigate = useNavigate()\r\n-    const [userData, setUserData] = useState(null)\r\n-    const { register, control, handleSubmit, setValue, getValues, formState: { errors }, reset, watch } = useForm({\r\n-        defaultValues: {\r\n-            records: [{ date: \"\", amount: \"\", description: \"\" }], // Initial field (cannot be removed)\r\n-            furtherFields: [{ date: null, sign: \"\" }], // Additional dynamic section\r\n-        },\r\n-    });\r\n-    const { fields: furtherFields, append: appendFurther, remove: removeFurther } = useFieldArray({\r\n-        control,\r\n-        name: \"furtherFields\",\r\n-    });\r\n-\r\n-    const { fields, append, remove } = useFieldArray({\r\n-        control,\r\n-        name: \"records\",\r\n-    });\r\n-\r\n-\r\n-    const signCanvasRefs = useRef([]);\r\n-\r\n-    // Clear Signature Function\r\n-    const clearSignature = (index) => {\r\n-        if (signCanvasRefs.current[index]) {\r\n-            signCanvasRefs.current[index].clear();\r\n-            setValue(`furtherFields.${index}.sign`, \"\");\r\n-        }\r\n-    };\r\n-    // Function to update signature in the form state\r\n-    const updateSignature = async (index) => {\r\n-        if (signCanvasRefs.current[index]) {\r\n-            const signData = await signCanvasRefs.current[index].toDataURL();\r\n-            setValue(`furtherFields.${index}.sign`, signData);\r\n-            try {\r\n-                const file = signData;\r\n-                if (file) {\r\n-                    setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n-                }\r\n-\r\n-                let obj = {\r\n-                    document: signData,\r\n-                    filename: moment().unix() + \"_Sign.png\"\r\n-                }\r\n-\r\n-                const response = await axios.post(\r\n-                    'https://cosmetic.theappkit.com/api/system/uploadDoc',\r\n-                    obj\r\n-                );\r\n-\r\n-                console.log(response?.data?.data?.path);\r\n-\r\n-\r\n-                setValue(`furtherFields.${index}.sign`, 'https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n-\r\n-\r\n-            } catch (error) {\r\n-                console.log(error);\r\n-\r\n-            }\r\n-        }\r\n-    };\r\n-    const [title, setTitle] = useState(null)\r\n-const [formData, setFormData] = useState(null)\r\n-    const [step, setStep] = useState(1); // 1: OTP, 2: Reset Password\r\n-    const [otp, setOtp] = useState(\"\");\r\n-    const [otpError, setOtpError] = useState(false);\r\n-    const [timer, setTimer] = useState(30);\r\n-    const [isLoading, setIsLoading] = useState(false);\r\n-    const [open, setOpen] = useState(false)\r\n-    const [password, setPassword] = useState(\"\");\r\n-    const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n-\r\n-    const [showPassword2, setShowPassword2] = useState(false);\r\n-    const [otpToken, setOtpToken] = useState(null)\r\n-    const [showPassword, setShowPassword] = useState(false);\r\n-    const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n-    const [patientType, setPatientType] = useState(\"existing\");\r\n-    const [patients, setPatients] = useState([])\r\n-    const [selectedPatient, setSelectedPatient] = useState(null)\r\n-    const [documents, setDocuments] = useState([])\r\n-    const [selectedDocument, setSelectedDocument] = useState(null)\r\n-    const sigCanvas = useRef(null);\r\n-    const [signature, setSignature] = useState(null);\r\n-    const [uploadedImages, setUploadedImages] = useState([])\r\n-    const [imageLoader, setImageLoader] = useState(false)\r\n-    const [beforeImages, setBeforeImages] = useState([])\r\n-    const [imageLoaderBefore, setImageLoaderBefore] = useState(false)\r\n-    const [afterImages, setAfterImages] = useState([])\r\n-    const [imageLoaderAfter, setImageLoaderAfter] = useState(false)\r\n-\r\n-    // Handle Save Signature\r\n-    const handleSave = async () => {\r\n-        if (sigCanvas.current) {\r\n-            const dataURL = await sigCanvas.current.toDataURL();\r\n-            setSignature(dataURL);\r\n-            try {\r\n-                const file = dataURL;\r\n-                if (file) {\r\n-                    setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n-                }\r\n-\r\n-                let obj = {\r\n-                    document: dataURL,\r\n-                    filename: moment().unix() + \"_Sign.png\"\r\n-                }\r\n-\r\n-                const response = await axios.post(\r\n-                    'https://cosmetic.theappkit.com/api/system/uploadDoc',\r\n-                    obj\r\n-                );\r\n-\r\n-                console.log(response?.data?.data?.path);\r\n-\r\n-                setSignature('https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n-\r\n-\r\n-            } catch (error) {\r\n-                console.log(error);\r\n-\r\n-            }\r\n-        }\r\n-    };\r\n-\r\n-    // Handle Clear Signature\r\n-    const handleClear = () => {\r\n-        if (sigCanvas.current) {\r\n-            sigCanvas.current.clear();\r\n-            setSignature(null);\r\n-        }\r\n-    };\r\n-    const [permissions, setPermissions] = useState({\r\n-        marketing: \"\",\r\n-        offers: \"\",\r\n-    });\r\n-\r\n-    const handleChange2 = (event) => {\r\n-        setPermissions({\r\n-            ...permissions,\r\n-            [event.target.name]: event.target.value,\r\n-        });\r\n-    };\r\n-    const handleChange = (event) => {\r\n-        setPatientType(event.target.value);\r\n-    };\r\n-    const {\r\n-        register: register4,\r\n-        handleSubmit: handleSubmit4,\r\n-        setValue: setValue4,\r\n-        getValues: getValues4,\r\n-        reset: reset4,\r\n-        formState: { errors: errors4 },\r\n-    } = useForm();\r\n-\r\n-    // Simulate OTP Submission\r\n-    const handleOtpSubmit = () => {\r\n-        if (otp.length !== 4) {\r\n-            setOtpError(true);\r\n-            return;\r\n-        }\r\n-        setIsLoading(true);\r\n-        setTimeout(() => {\r\n-            setIsLoading(false);\r\n-            SubmitOTP()\r\n-            setStep(2); // Move to reset password step\r\n-        }, 2000);\r\n-    };\r\n-\r\n-    // Simulate Reset Password Submission\r\n-    const handleResetSubmit = () => {\r\n-        if (password !== confirmPassword) {\r\n-            alert(\"Passwords do not match!\");\r\n-            return;\r\n-        }\r\n-        setIsLoading(true);\r\n-        setTimeout(() => {\r\n-            setIsLoading(false);\r\n-            // Close dialog after password reset\r\n-        }, 2000);\r\n-    };\r\n-    const fileInputRef = useRef(null);\r\n-\r\n-    const [loader, setLoader] = useState(false)\r\n-\r\n-    const [imageURL, setImageURL] = useState()\r\n-    const [hovered, setHovered] = useState(false);\r\n-\r\n-\r\n-\r\n-\r\n-    const handleImageClick = () => {\r\n-        fileInputRef.current.click();\r\n-    };\r\n-\r\n-    const handleFileChange = async (e) => {\r\n-        try {\r\n-            const file = e.target.files[0];\r\n-            if (file) {\r\n-                setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n-            }\r\n-            const formData = new FormData();\r\n-            formData.append(\"document\", e.target.files[0]);\r\n-\r\n-            const response = await axios.post(\r\n-                'https://cosmetic.theappkit.com/api/system/upload',\r\n-                formData,\r\n-                {\r\n-                    headers: {\r\n-                        'Content-Type': 'multipart/form-data'\r\n-                    }\r\n-                }\r\n-            );\r\n-\r\n-            console.log(response?.data?.data?.path);\r\n-\r\n-            setImageURL('https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n-\r\n-\r\n-        } catch (error) {\r\n-            console.log(error);\r\n-\r\n-        }\r\n-    };\r\n-    const UpdateConsentForm = async () => {\r\n-        setLoader(true);\r\n-        try {\r\n-            let obj = {\r\n-                _id:id,\r\n-                patient_id: patientType == 'existing' ?  selectedPatient?.id : null,\r\n-                form_id: null,\r\n-                aftercare_document: selectedDocument?._id,\r\n-                treatment_date: getValues('treatmentDate'),\r\n-                consultation_date: getValues('consultationDate'),\r\n-                first_name: getValues('fname'),\r\n-                last_name: getValues('lname'),\r\n-                dob: getValues('selectedDate'),\r\n-                address: getValues('address'),\r\n-                email: getValues('email'),\r\n-                post_code: getValues('post'),\r\n-                phone: getValues('phone'),\r\n-                notes: getValues('notes'),\r\n-                picture: imageURL,\r\n-                kin_details: {\r\n-                    name: getValues('name'),\r\n-                    address: getValues('kinaddress'),\r\n-                    email: getValues('kinemail'),\r\n-                    phone: getValues('kinphone'),\r\n-                },\r\n-                general_practitioner: {\r\n-                    name: getValues('genname'),\r\n-                    address: getValues('genaddress'),\r\n-                    email: getValues('genemail'),\r\n-                    phone: getValues('genphone'),\r\n-                },\r\n-                treatment_plan: {\r\n-                    patient_concerns: getValues('patientConcerns'),\r\n-                    patient_goals: getValues('patientGoal'),\r\n-                    advised_plan: getValues('advisedPlan'),\r\n-                    expected_result: getValues('expectedResult'),\r\n-                    date: getValues('patientDate'),\r\n-                    patient_sign: signature\r\n-                },\r\n-                batch_images: uploadedImages,\r\n-                before_images: beforeImages,\r\n-                after_images: afterImages,\r\n-                further_treatment: furtherFields,\r\n-                treatment_record: fields,\r\n-                extra_notes: getValues('extranotes'),\r\n-                permission_marketing: permissions?.marketing,\r\n-                offers: permissions?.offers,\r\n-\r\n-\r\n-            };\r\n-\r\n-            const promise = ApiServices.UpdateForm(obj);\r\n-\r\n-            // Handle the API response properly\r\n-            const response = await promise;\r\n-            console.log(response);\r\n-\r\n-            showPromiseToast(\r\n-                promise,\r\n-                \"Saving...\",\r\n-                \"Added Successfully\",\r\n-                \"Something Went Wrong\"\r\n-            );\r\n-\r\n-            // Navigate if response is successful\r\n-            if (response?.responseCode === 200) {\r\n-                console.log(response);\r\n-                setImageURL(null)\r\n-                navigate('/consent-forms')\r\n-\r\n-\r\n-            }\r\n-\r\n-        } catch (error) {\r\n-            console.log(error);\r\n-            showErrorToast(error)\r\n-        } finally {\r\n-\r\n-            setLoader(false);\r\n-        }\r\n-    };\r\n-\r\n-    const SendOtp = async (val) => {\r\n-        if (val != 'resend') {\r\n-            setIsLoading(true)\r\n-        }\r\n-\r\n-\r\n-        setTimer(60);\r\n-        try {\r\n-            let obj = {\r\n-                email: userData?.email\r\n-            };\r\n-\r\n-            const data = await ApiServices.SendOtp(obj);\r\n-            console.log(data);\r\n-            if (data.responseCode == 206) {\r\n-                setOtp('')\r\n-                showSuccessToast('Otp Sent Successfully')\r\n-\r\n-            }\r\n-\r\n-        } catch (error) {\r\n-\r\n-            console.log(error)\r\n-        }\r\n-        finally {\r\n-            setIsLoading(false)\r\n-            setStep(1)\r\n-            setOpen(true)\r\n-\r\n-        }\r\n-    }\r\n-\r\n-    const UpdatePassword = async (sendData, result) => {\r\n-        setIsLoading(true)\r\n-        console.log(otpToken, \"otpToken2\");\r\n-        try {\r\n-            let obj = {\r\n-                otp_token: otpToken,\r\n-                email: userData?.email,\r\n-                password: getValues4('password'),\r\n-                confirm_password: getValues4('confirmPassword'),\r\n-            };\r\n-\r\n-            const data = await ApiServices.SendOtp(obj);\r\n-            console.log(data);\r\n-            if (data.responseCode == 200) {\r\n-                setOtp('')\r\n-\r\n-                reset4()\r\n-                setConfirmPassword(false)\r\n-\r\n-\r\n-\r\n-            }\r\n-        } catch (error) {\r\n-            setOtpError(true)\r\n-        }\r\n-        finally {\r\n-            setIsLoading(false)\r\n-            setOpen(false)\r\n-            showSuccessToast('Password Reset Successfully')\r\n-        }\r\n-    };\r\n-\r\n-    const SubmitOTP = async (val) => {\r\n-\r\n-        setIsLoading(true)\r\n-\r\n-\r\n-\r\n-        try {\r\n-            let obj = {\r\n-                email: userData?.email,\r\n-                otp: otp,\r\n-            };\r\n-\r\n-            const data = await ApiServices.SendOtp(obj);\r\n-            console.log(data?.data, 'tesetttt');\r\n-            if (data.responseCode == 206) {\r\n-                console.log(data);\r\n-                setOtpToken(data?.data?.otp_token)\r\n-\r\n-\r\n-            }\r\n-        } catch (error) {\r\n-            setOtpError(true)\r\n-        }\r\n-        finally {\r\n-            setIsLoading(false)\r\n-\r\n-        }\r\n-    };\r\n-\r\n-    const handleFileChange2 = async (e) => {\r\n-        setUploadedImages([]);\r\n-        setImageLoader(true);\r\n-\r\n-        try {\r\n-            const files = e.target.files;\r\n-            if (!files || files.length === 0) return; // Exit if no files are selected\r\n-\r\n-            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n-\r\n-            const uploadedNewBatchImages = [];\r\n-\r\n-            for (let i = 0; i < files.length; i++) {\r\n-                const formData = new FormData();\r\n-                formData.append(\"document\", files[i]);\r\n-\r\n-                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n-\r\n-                const response = await axios.post(\r\n-                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n-                    formData,\r\n-                    {\r\n-                        headers: {\r\n-                            \"Content-Type\": \"multipart/form-data\",\r\n-                        },\r\n-                    }\r\n-                );\r\n-\r\n-                const imagePath = response?.data?.data?.path;\r\n-                if (imagePath) {\r\n-                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n-                    uploadedNewBatchImages.push(fullImageUrl);\r\n-                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n-                }\r\n-            }\r\n-\r\n-            setUploadedImages(uploadedNewBatchImages); // Update state with uploaded image URLs\r\n-            console.log(\"All Uploaded Images:\", uploadedNewBatchImages);\r\n-        } catch (error) {\r\n-            console.error(\"Error uploading files:\", error);\r\n-        } finally {\r\n-            setImageLoader(false);\r\n-        }\r\n-    };\r\n-\r\n-    const handleRemoveImage = (index) => {\r\n-        setUploadedImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n-    };\r\n-\r\n-    const handleFileChange3 = async (e) => {\r\n-        setBeforeImages([]);\r\n-        setImageLoaderBefore(true);\r\n-\r\n-        try {\r\n-            const files = e.target.files;\r\n-            if (!files || files.length === 0) return; // Exit if no files are selected\r\n-\r\n-            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n-\r\n-            const uploadedNewBeforeImages = [];\r\n-\r\n-            for (let i = 0; i < files.length; i++) {\r\n-                const formData = new FormData();\r\n-                formData.append(\"document\", files[i]);\r\n-\r\n-                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n-\r\n-                const response = await axios.post(\r\n-                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n-                    formData,\r\n-                    {\r\n-                        headers: {\r\n-                            \"Content-Type\": \"multipart/form-data\",\r\n-                        },\r\n-                    }\r\n-                );\r\n-\r\n-                const imagePath = response?.data?.data?.path;\r\n-                if (imagePath) {\r\n-                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n-                    uploadedNewBeforeImages.push(fullImageUrl);\r\n-                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n-                }\r\n-            }\r\n-\r\n-            setBeforeImages(uploadedNewBeforeImages); // Update state with uploaded image URLs\r\n-            console.log(\"All Uploaded Images:\", uploadedNewBeforeImages);\r\n-        } catch (error) {\r\n-            console.error(\"Error uploading files:\", error);\r\n-        } finally {\r\n-            setImageLoaderBefore(false);\r\n-        }\r\n-    };\r\n-\r\n-    const handleRemoveImage2 = (index) => {\r\n-        setBeforeImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n-    };\r\n-    const handleFileChange4 = async (e) => {\r\n-        setAfterImages([]);\r\n-        setImageLoaderAfter(true);\r\n-\r\n-        try {\r\n-            const files = e.target.files;\r\n-            if (!files || files.length === 0) return; // Exit if no files are selected\r\n-\r\n-            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n-\r\n-            const uploadedNewAfterImages = [];\r\n-\r\n-            for (let i = 0; i < files.length; i++) {\r\n-                const formData = new FormData();\r\n-                formData.append(\"document\", files[i]);\r\n-\r\n-                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n-\r\n-                const response = await axios.post(\r\n-                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n-                    formData,\r\n-                    {\r\n-                        headers: {\r\n-                            \"Content-Type\": \"multipart/form-data\",\r\n-                        },\r\n-                    }\r\n-                );\r\n-\r\n-                const imagePath = response?.data?.data?.path;\r\n-                if (imagePath) {\r\n-                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n-                    uploadedNewAfterImages.push(fullImageUrl);\r\n-                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n-                }\r\n-            }\r\n-\r\n-            setAfterImages(uploadedNewAfterImages); // Update state with uploaded image URLs\r\n-            console.log(\"All Uploaded Images:\", uploadedNewAfterImages);\r\n-        } catch (error) {\r\n-            console.error(\"Error uploading files:\", error);\r\n-        } finally {\r\n-            setImageLoaderAfter(false);\r\n-        }\r\n-    };\r\n-\r\n-    const handleRemoveImage3 = (index) => {\r\n-        setAfterImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n-    };\r\n-    useEffect(() => {\r\n-        let interval;\r\n-        if (timer > 0) {\r\n-            interval = setInterval(() => {\r\n-                setTimer((prev) => prev - 1);\r\n-            }, 1000);\r\n-        } else {\r\n-            clearInterval(interval);\r\n-        }\r\n-        return () => clearInterval(interval);\r\n-    }, [timer]);\r\n-\r\n-    const getDocuments = async () => {\r\n-        try {\r\n-            let params = {\r\n-                page: 1,\r\n-                limit: 999\r\n-            };\r\n-\r\n-            const data = await ApiServices.getAfterCareDocuments(params);\r\n-\r\n-\r\n-\r\n-            setDocuments(\r\n-                data?.data?.documents?.map((doc) => ({\r\n-\r\n-                    id: doc?._id, // Example transformation\r\n-                    name: doc.title, // Another example\r\n-                }))\r\n-            );\r\n-\r\n-\r\n-\r\n-        } catch (error) {\r\n-            console.error(\"Error fetching location:\", error);\r\n-        }\r\n-    };\r\n-    const getPatients = async () => {\r\n-        try {\r\n-            let params = {\r\n-                page: 1,\r\n-                limit: 999\r\n-            };\r\n-\r\n-            const data = await ApiServices.getPatients(params);\r\n-\r\n-\r\n-\r\n-            setPatients(\r\n-                data?.data?.patients?.map((doc) => ({\r\n-                    ...doc,\r\n-                    id: doc?._id, // Example transformation\r\n-                    name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n-                }))\r\n-            );\r\n-\r\n-        } catch (error) {\r\n-            console.error(\"Error fetching location:\", error);\r\n-        }\r\n-    };\r\n-    useEffect(() => {\r\n-        getPatients()\r\n-        getDocuments()\r\n-    }, [])\r\n-    useEffect(() => {\r\n-        // Disable drawing on the single canvas\r\n-        if (sigCanvas.current) {\r\n-            sigCanvas.current.off();\r\n-        }\r\n-\r\n-        // Disable drawing on all multiple canvases\r\n-        signCanvasRefs.current.forEach((canvas) => {\r\n-            if (canvas) {\r\n-                canvas.off();\r\n-            }\r\n-        });\r\n-    }, []);\r\n-    const getData = async () => {\r\n-        try {\r\n-            let params = {\r\n-                id: id,\r\n-\r\n-            };\r\n-\r\n-            const data = await ApiServices.getFormDetail(params);\r\n-            let form = data?.data?.form\r\n-            setValue('treatmentDate',dayjs(form?.treatment_date))\r\n-            setValue('consultationDate',dayjs(form?.consultation_date))\r\n-            setPermissions({\r\n-                marketing: form?.permission_marketing ?  'yes' : 'no',\r\n-                offers: form?.offers?  'yes' : 'no',\r\n-            })\r\n-            setFormData(form)\r\n-        \r\n-            setSignature(form?.treatment_plan?.patient_sign) \r\n-            setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n-            setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n-            setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n-            setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n-            setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n-            setValue(\"records\", form?.treatment_record);\r\n-            setValue(\"furtherFields\", form?.further_treatment);\r\n-            setValue(\"extranotes\", form?.extra_notes);\r\n-            setUploadedImages(form?.batch_images)\r\n-            setBeforeImages(form?.before_images)\r\n-            setAfterImages(form?.after_images)\r\n-\r\n-        } catch (error) {\r\n-            console.error(\"Error fetching location:\", error);\r\n-        }\r\n-    };\r\n-    console.log(permissions);\r\n-    \r\n-    useEffect(() => {\r\n-        getData()\r\n-    }, [])\r\n-    useEffect(() => {\r\n-        let value=patients?.find(item => item?._id == formData?.patient_id)\r\n-        setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n-        setSelectedDocument(documents?.find(item => item?._id == formData?.aftercare_document))\r\n-        \r\n-        setValue('fname', value?.first_name || \"\");\r\n-        setValue('lname', value?.last_name || \"\");\r\n-        setValue('email', value?.email || \"\");\r\n-        setValue('post', value?.post_code || \"\");\r\n-        setValue('phone', value?.phone || \"\");\r\n-        setValue('address', value?.address || \"\");\r\n-        setValue('notes', value?.notes || \"\");\r\n-        setValue('name', value?.kin_details?.name || \"\");\r\n-        setValue('kinemail', value?.kin_details?.email || \"\");\r\n-        setValue('kinphone', value?.kin_details?.phone || \"\");\r\n-        setValue('kinaddress', value?.kin_details?.address || \"\");\r\n-        setValue('genname', value?.general_practitioner?.name || \"\");\r\n-        setValue('genemail', value?.general_practitioner?.email || \"\");\r\n-        setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n-        setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n-        console.log(\"Raw DOB:\", value?.dob);\r\n-\r\n-        if (value?.dob) {\r\n-            // Convert to Dayjs format\r\n-            const parsedDate = dayjs(value.dob);\r\n-\r\n-            // Check if the conversion is valid\r\n-            if (!parsedDate.isValid()) {\r\n-                console.error(\"Invalid DOB Format:\", value.dob);\r\n-                return;\r\n-            }\r\n-\r\n-            console.log(\"Parsed Date:\", parsedDate);\r\n-            setValue(\"selectedDate\", parsedDate);\r\n-        }\r\n-\r\n-    }, [patients,documents])\r\n-    \r\n-\r\n-    return (\r\n-        <div>\r\n-\r\n-            <Paper sx={{ width: \"100%\", overflow: \"hidden\", boxShadow: 'none', backgroundColor: '#eff6ff', borderRadius: '12px' }}>\r\n-\r\n-\r\n-\r\n-                <Box component={'form'} p={3} sx={{ borderRadius: '12px' }} onSubmit={handleSubmit(UpdateConsentForm)} >\r\n-                    <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\r\n-                        Medical History Form\r\n-                    </Typography>\r\n-\r\n-                    <Grid container mt={4} spacing={2}>\r\n-\r\n-\r\n-                        <Grid item xs={3} mt={2}>\r\n-                            <InputLabel sx={{\r\n-                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                fontSize: \"14px\",\r\n-                                color: \"#333\",\r\n-                                marginBottom: \"4px\",\r\n-                            }}>\r\n-\r\n-                                Select Form :\r\n-                            </InputLabel>\r\n-                            <SelectField\r\n-                                size={'small'}\r\n-                                newLabel={'Select Form'}\r\n-                                fullWidth={true}\r\n-                                options={[]}\r\n-                                selected={title}\r\n-                                onSelect={(value) => {\r\n-                                    setTitle(value)\r\n-\r\n-\r\n-                                }}\r\n-                                error={errors?.title?.message}\r\n-                                register={register(\"title\", {\r\n-                                    required: false,\r\n-                                })}\r\n-                            />\r\n-\r\n-                        </Grid>\r\n-                        <Grid item xs={3} mt={2}>\r\n-                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                                <Grid container spacing={2}>\r\n-                                    {/* Single Date Selection */}\r\n-                                    <Grid item xs={12}>\r\n-                                        <Box>\r\n-                                            <InputLabel sx={{\r\n-                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                                fontSize: \"14px\",\r\n-                                                color: \"#333\",\r\n-                                                marginBottom: 1.5,\r\n-                                            }}>\r\n-                                                Treatment Date :*\r\n-                                            </InputLabel>\r\n-                                            <Controller\r\n-                                                name=\"treatmentDate\"\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: '12px',\r\n-                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n-                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.treatmentDate && (\r\n-                                                <Typography color=\"error\">{errors.treatmentDate.message}</Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n-\r\n-\r\n-\r\n-\r\n-                                </Grid>\r\n-\r\n-\r\n-                            </LocalizationProvider>\r\n-                        </Grid>\r\n-                        <Grid item xs={3} mt={2}>\r\n-                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                                <Grid container spacing={2}>\r\n-                                    {/* Single Date Selection */}\r\n-                                    <Grid item xs={12}>\r\n-                                        <Box>\r\n-                                            <InputLabel sx={{\r\n-                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                                fontSize: \"14px\",\r\n-                                                color: \"#333\",\r\n-                                                marginBottom: 1.5,\r\n-                                            }}>\r\n-                                                Consultation Date :*\r\n-                                            </InputLabel>\r\n-                                            <Controller\r\n-                                                name=\"consultationDate\"\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: '12px',\r\n-                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n-                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.consultationDate && (\r\n-                                                <Typography color=\"error\">{errors.consultationDate.message}</Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n-\r\n-\r\n-\r\n-\r\n-                                </Grid>\r\n-\r\n-\r\n-                            </LocalizationProvider>\r\n-                        </Grid>\r\n-                        <Grid container p={2} spacing={2} >\r\n-\r\n-                            <Grid item xs={3} mt={2}>\r\n-                                <InputLabel sx={{\r\n-                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                    fontSize: \"14px\",\r\n-                                    color: \"#333\",\r\n-                                    marginBottom: \"4px\",\r\n-                                }}>\r\n-\r\n-                                    Existing or New Patient :\r\n-                                </InputLabel>\r\n-                                <FormControl component=\"fieldset\">\r\n-\r\n-                                    <RadioGroup row value={patientType} onChange={handleChange}>\r\n-                                        <FormControlLabel value=\"existing\" control={<Radio />} label=\"Existing\" />\r\n-                                        <FormControlLabel value=\"new\" control={<Radio />} label=\"New\" />\r\n-                                    </RadioGroup>\r\n-                                </FormControl>\r\n-                            </Grid>\r\n-                            <Grid item xs={3} mt={2}>\r\n-                                {patientType == 'existing' && <> <InputLabel sx={{\r\n-                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                    fontSize: \"14px\",\r\n-                                    color: \"#333\",\r\n-                                    marginBottom: \"4px\",\r\n-                                }}>\r\n-\r\n-                                    Select Patient :\r\n-                                </InputLabel>\r\n-                                    <SelectField\r\n-                                        size={'small'}\r\n-                                        newLabel={'Select Patient'}\r\n-                                        fullWidth={true}\r\n-                                        disabled={true}\r\n-                                        options={patients}\r\n-                                        selected={selectedPatient}\r\n-                                        onSelect={(value) => {\r\n-                                            setSelectedPatient(value);\r\n-                                            console.log(\"Selected Patient:\", value);\r\n-\r\n-                                            setValue('fname', value?.first_name || \"\");\r\n-                                            setValue('lname', value?.last_name || \"\");\r\n-                                            setValue('email', value?.email || \"\");\r\n-                                            setValue('post', value?.post_code || \"\");\r\n-                                            setValue('phone', value?.phone || \"\");\r\n-                                            setValue('address', value?.address || \"\");\r\n-                                            setValue('notes', value?.notes || \"\");\r\n-                                            setValue('name', value?.kin_details?.name || \"\");\r\n-                                            setValue('kinemail', value?.kin_details?.email || \"\");\r\n-                                            setValue('kinphone', value?.kin_details?.phone || \"\");\r\n-                                            setValue('kinaddress', value?.kin_details?.address || \"\");\r\n-                                            setValue('genname', value?.general_practitioner?.name || \"\");\r\n-                                            setValue('genemail', value?.general_practitioner?.email || \"\");\r\n-                                            setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n-                                            setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n-                                            console.log(\"Raw DOB:\", value?.dob);\r\n-\r\n-                                            if (value?.dob) {\r\n-                                                // Convert to Dayjs format\r\n-                                                const parsedDate = dayjs(value.dob);\r\n-\r\n-                                                // Check if the conversion is valid\r\n-                                                if (!parsedDate.isValid()) {\r\n-                                                    console.error(\"Invalid DOB Format:\", value.dob);\r\n-                                                    return;\r\n-                                                }\r\n-\r\n-                                                console.log(\"Parsed Date:\", parsedDate);\r\n-                                                setValue(\"selectedDate\", parsedDate);\r\n-                                            }\r\n-                                        }}\r\n-                                        error={errors?.patient?.message}\r\n-                                        register={register(\"patient\", {\r\n-                                            required: false,\r\n-                                        })}\r\n-                                    />\r\n-                                </>}\r\n-                            </Grid>\r\n-                            <Grid item xs={3} mt={2}>\r\n-                                {patientType == 'existing' && <><InputLabel sx={{\r\n-                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                    fontSize: \"14px\",\r\n-                                    color: \"#333\",\r\n-                                    marginBottom: \"4px\",\r\n-                                }}>\r\n-\r\n-                                    Select Aftercare Document :\r\n-                                </InputLabel>\r\n-                                    <SelectField\r\n-                                        size={'small'}\r\n-                                        newLabel={'Select Document'}\r\n-                                        fullWidth={true}\r\n-                                        options={documents}\r\n-                                        selected={selectedDocument}\r\n-                                        onSelect={(value) => {\r\n-                                            setSelectedDocument(value)\r\n-\r\n-\r\n-                                        }}\r\n-                                        error={errors?.document?.message}\r\n-                                        register={register(\"document\", {\r\n-                                            required: false,\r\n-                                        })}\r\n-                                    /> </>}\r\n-                            </Grid>\r\n-                        </Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Patient First Name :*\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Patient First Name\"}\r\n-                            error={errors?.fname?.message}\r\n-                            register={register(\"fname\", {\r\n-                                required:\r\n-                                    \"Please enter your fname.\"\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Patient Last Name :*\"}\r\n-                            size={'small'}\r\n-                            placeholder={\" Patient Last Name\"}\r\n-                            error={errors?.lname?.message}\r\n-                            register={register(\"lname\", {\r\n-                                required:\r\n-                                    \"Please enter your lname.\"\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Patient Email :*\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Patient Email\"}\r\n-                            error={errors?.email?.message}\r\n-                            register={register(\"email\", {\r\n-                                required:\r\n-                                    \"Please enter your email.\"\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}>\r\n-                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                                <Grid container spacing={2}>\r\n-                                    {/* Single Date Selection */}\r\n-                                    <Grid item xs={12}>\r\n-                                        <Box>\r\n-                                            <InputLabel sx={{\r\n-                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                                fontSize: \"14px\",\r\n-                                                color: \"#333\",\r\n-                                                marginBottom: 1.5,\r\n-                                            }}>\r\n-                                                DOB :*\r\n-                                            </InputLabel>\r\n-                                            <Controller\r\n-                                                name=\"selectedDate\"\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: '12px',\r\n-                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n-                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.selectedDate && (\r\n-                                                <Typography color=\"error\">{errors.selectedDate.message}</Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n-\r\n-\r\n-\r\n-\r\n-                                </Grid>\r\n-\r\n-\r\n-                            </LocalizationProvider>\r\n-                        </Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Phone Number :*\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Phone Number\"}\r\n-                            error={errors?.phone?.message}\r\n-                            register={register(\"phone\", {\r\n-                                required:\r\n-                                    \"Please enter your phone.\"\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Post Code :*\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Post Code\"}\r\n-                            error={errors?.post?.message}\r\n-                            register={register(\"post\", {\r\n-                                required:\r\n-                                    \"Please enter your postcode.\"\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Address :*\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Address\"}\r\n-                            error={errors?.address?.message}\r\n-                            register={register(\"address\", {\r\n-                                required:\r\n-                                    \"Please enter your address.\"\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Notes :\"}\r\n-                            multiline\r\n-                            rows={3}\r\n-                            size={'small'}\r\n-                            placeholder={\"Notes\"}\r\n-                            error={errors?.notes?.message}\r\n-                            register={register(\"notes\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-\r\n-                    </Grid>\r\n-                    <Divider sx={{ mt: 4 }} />\r\n-                    <Typography variant=\"h5\" sx={{ fontWeight: 700, mt: 4 }}>\r\n-                        Next of Kin Details\r\n-                    </Typography>\r\n-                    <Grid container mt={4} spacing={2}>\r\n-\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Name :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Name\"}\r\n-                            error={errors?.name?.message}\r\n-                            register={register(\"name\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Email :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Email\"}\r\n-                            error={errors?.kinemail?.message}\r\n-                            register={register(\"kinemail\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Phone Number :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Phone Number\"}\r\n-                            error={errors?.kinphone?.message}\r\n-                            register={register(\"kinphone\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Address :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Address\"}\r\n-                            error={errors?.kinaddress?.message}\r\n-                            register={register(\"kinaddress\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-\r\n-\r\n-                    </Grid>\r\n-                    <Divider sx={{ mt: 4 }} />\r\n-                    <Typography variant=\"h5\" sx={{ fontWeight: 700, mt: 4 }}>\r\n-                        General Practitioners(GP / Doctors)\r\n-                    </Typography>\r\n-                    <Grid container mt={4} spacing={2}>\r\n-\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Name :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Name\"}\r\n-                            error={errors?.genname?.message}\r\n-                            register={register(\"genname\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Email :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Email\"}\r\n-                            error={errors?.genemail?.message}\r\n-                            register={register(\"genemail\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Phone Number :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Phone Number\"}\r\n-                            error={errors?.genphone?.message}\r\n-                            register={register(\"genphone\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-\r\n-                        <Grid item xs={3} mt={2}><InputField\r\n-                            label={\"Address :\"}\r\n-                            size={'small'}\r\n-                            placeholder={\"Address\"}\r\n-                            error={errors?.genaddress?.message}\r\n-                            register={register(\"genaddress\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Grid container spacing={2} p={2}>\r\n-                            {/* Marketing Permission */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we have permission to use your images for marketing?</FormLabel>\r\n-                                <FormControl component=\"fieldset\">\r\n-\r\n-                                    <RadioGroup row name=\"marketing\" value={permissions.marketing} onChange={handleChange2}>\r\n-                                        <FormControlLabel value=\"yes\" control={<Radio />} label=\"Yes\" />\r\n-                                        <FormControlLabel value=\"no\" control={<Radio />} label=\"No\" />\r\n-                                    </RadioGroup>\r\n-                                </FormControl>\r\n-                            </Grid>\r\n-\r\n-                            {/* Offers & Reminders Permission */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we send you offers & reminders by text email & WhatsApp?</FormLabel>\r\n-                                <FormControl component=\"fieldset\">\r\n-\r\n-                                    <RadioGroup row name=\"offers\" value={permissions.offers} onChange={handleChange2}>\r\n-                                        <FormControlLabel value=\"yes\" control={<Radio />} label=\"Yes\" />\r\n-                                        <FormControlLabel value=\"no\" control={<Radio />} label=\"No\" />\r\n-                                    </RadioGroup>\r\n-                                </FormControl>\r\n-                            </Grid>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Typography variant=\"h5\" fontWeight=\"bold\" mb={2} p={2}>\r\n-                            Treatment plan section\r\n-                        </Typography>\r\n-\r\n-                        <Grid container spacing={2} p={2}>\r\n-                            {/* Patient Concerns */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <InputField\r\n-                                    label=\"Patient concerns\"\r\n-                                    size=\"small\"\r\n-                                    placeholder=\"Patient concerns\"\r\n-                                    error={errors?.patientConcerns?.message}\r\n-                                    register={register(\"patientConcerns\", { required: false })}\r\n-                                    multiline\r\n-                                    rows={4}\r\n-                                />\r\n-                            </Grid>\r\n-\r\n-                            {/* Patient Goal */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <InputField\r\n-                                    label=\"Patient goal\"\r\n-                                    size=\"small\"\r\n-                                    placeholder=\"Patient goal\"\r\n-                                    error={errors?.patientGoal?.message}\r\n-                                    register={register(\"patientGoal\", { required: false })}\r\n-                                    multiline\r\n-                                    rows={4}\r\n-                                />\r\n-                            </Grid>\r\n-\r\n-                            {/* Advised Plan/Product */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <InputField\r\n-                                    label=\"Advised Plan/product\"\r\n-                                    size=\"small\"\r\n-                                    placeholder=\"Advised Plan/product\"\r\n-                                    error={errors?.advisedPlan?.message}\r\n-                                    register={register(\"advisedPlan\", { required: false })}\r\n-                                    multiline\r\n-                                    rows={4}\r\n-                                />\r\n-                            </Grid>\r\n-\r\n-                            {/* Expected Result */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <InputField\r\n-                                    label=\"Expected Result\"\r\n-                                    size=\"small\"\r\n-                                    placeholder=\"Expected Result\"\r\n-                                    error={errors?.expectedResult?.message}\r\n-                                    register={register(\"expectedResult\", { required: false })}\r\n-                                    multiline\r\n-                                    rows={4}\r\n-                                />\r\n-                            </Grid>\r\n-                        </Grid>\r\n-                        <Typography variant=\"p\" fontWeight={500} mb={2} p={2}>\r\n-                            I confirm my medical history to be true and correct. I agree I have read and understood all the contents of this document. I have read and understood all the content of this document and agree with the treatment plan. I give my consent to treatment and understand the possible complications and side effects. I confirm I have received an aftercare sheet\r\n-                        </Typography>\r\n-                        <Grid container spacing={5} p={2} alignItems=\"center\">\r\n-                            {/* Date Field */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                                    <Grid container spacing={2}>\r\n-                                        {/* Single Date Selection */}\r\n-                                        <Grid item xs={12}>\r\n-                                            <Box>\r\n-                                                <InputLabel sx={{\r\n-                                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n-\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}>\r\n-                                                    Patient Date :*\r\n-                                                </InputLabel>\r\n-                                                <Controller\r\n-                                                    name=\"patientDate\"\r\n-                                                    control={control}\r\n-                                                    rules={{ required: \"Please select a date\" }}\r\n-                                                    render={({ field }) => (\r\n-                                                        <DatePicker\r\n-                                                            {...field}\r\n-                                                            value={field.value || null}\r\n-                                                            onChange={(newValue) => field.onChange(newValue)}\r\n-                                                            slotProps={{\r\n-                                                                textField: {\r\n-                                                                    size: \"small\",\r\n-                                                                    fullWidth: true,\r\n-                                                                    sx: {\r\n-                                                                        \"& .MuiOutlinedInput-root\": {\r\n-                                                                            borderRadius: '12px',\r\n-                                                                            \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n-                                                                            \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n-                                                                            \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n-                                                                        },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            }}\r\n-                                                        />\r\n-                                                    )}\r\n-                                                />\r\n-                                                {errors.patientDate && (\r\n-                                                    <Typography color=\"error\">{errors.patientDate.message}</Typography>\r\n-                                                )}\r\n-                                            </Box>\r\n-                                        </Grid>\r\n-\r\n-\r\n-\r\n-\r\n-                                    </Grid>\r\n-\r\n-\r\n-                                </LocalizationProvider>\r\n-                            </Grid>\r\n-\r\n-                            {/* Signature Canvas */}\r\n-                            <Grid item xs={6} mt={2}>\r\n-                                <Typography>Patient Signature:</Typography>\r\n-                                <SignatureCanvas\r\n-                                    ref={sigCanvas}\r\n-                                    penColor=\"black\"\r\n-                                    canvasProps={{\r\n-                                        width: 300,\r\n-                                        height: 150,\r\n-                                        className: \"sigCanvas\",\r\n-                                        style: { border: \"1px dashed black\" },\r\n-                                    }}\r\n-                                />\r\n-                                <Grid container spacing={1} mt={1}>\r\n-                                    <Grid item>\r\n-                                        <Button variant=\"contained\" color=\"secondary\" onClick={handleClear}>\r\n-                                            Clear Signature\r\n-                                        </Button>\r\n-                                    </Grid>\r\n-                                    <Grid item>\r\n-                                        <Button variant=\"contained\" color=\"primary\" onClick={handleSave}>\r\n-                                            Save Signature\r\n-                                        </Button>\r\n-                                    </Grid>\r\n-\r\n-                                </Grid>\r\n-\r\n-\r\n-                            </Grid>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n-\r\n-                        <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                            {fields.map((item, index) => (\r\n-                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-\r\n-                                    {/* Patient Date Selection */}\r\n-                                    <Grid item xs={3}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Date :*\r\n-                                            </InputLabel>\r\n-\r\n-                                            <Controller\r\n-                                                name={`records.${index}.date`}\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: \"12px\",\r\n-                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.records?.[index]?.date && (\r\n-                                                <Typography color=\"error\">\r\n-                                                    {errors.records[index].date.message}\r\n-                                                </Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n-\r\n-                                    {/* Amount Field */}\r\n-                                    <Grid item xs={3} mt={2}>\r\n-                                        <InputField\r\n-                                            label=\"Amount\"\r\n-                                            placeholder=\"Order Amount\"\r\n-                                            size=\"small\"\r\n-                                            {...register(`records.${index}.amount`)}\r\n-                                        />\r\n-                                    </Grid>\r\n-\r\n-\r\n-\r\n-                                    {/* Description Field */}\r\n-                                    <Grid item xs={4}>\r\n-                                        <InputField\r\n-                                            label=\"Description\"\r\n-                                            multiline\r\n-                                            rows={3}\r\n-                                            placeholder=\"Description\"\r\n-                                            {...register(`records.${index}.description`)}\r\n-                                        />\r\n-                                    </Grid>\r\n-                                    {/* Remove Button (only for additional fields) */}\r\n-                                    <Grid item xs={1}>\r\n-                                        {index > 0 && (\r\n-                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                                                <DeleteIcon />\r\n-                                            </IconButton>\r\n-                                        )}\r\n-                                    </Grid>\r\n-                                </Grid>\r\n-                            ))}\r\n-                        </LocalizationProvider>\r\n-\r\n-\r\n-\r\n-                        <Grid container p={2}>\r\n-                            <Button\r\n-                                variant=\"contained\"\r\n-                                color=\"primary\"\r\n-                                onClick={() => append({ date: \"\", amount: \"\", description: \"\" })}\r\n-                                sx={{ mt: 2, textTransform: 'capitalize' }}\r\n-                            >\r\n-                                Add More\r\n-                            </Button>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Grid item xs={12} sm={5}>\r\n-                            <InputLabel sx={{\r\n-                                textTransform: \"capitalize\", mt: 2,\r\n-                                textAlign: \"left\",\r\n-                                fontWeight: 600,\r\n-                                fontSize: \"14px\",\r\n-                                color: \"#333\",\r\n-                                marginBottom: \"4px\",\r\n-                            }}>\r\n-                                Upload Batch Images :*\r\n-                            </InputLabel>\r\n-\r\n-                            <Controller\r\n-                                name=\"media\"\r\n-                                control={control}\r\n-                                rules={{\r\n-                                    required: \"At least one image file is required\",\r\n-                                    validate: (value) => {\r\n-                                        if (!value || value.length === 0) {\r\n-                                            return \"At least one image file is required\";\r\n-                                        }\r\n-                                        for (let i = 0; i < value.length; i++) {\r\n-                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n-                                                return \"Each file must be smaller than 10MB\";\r\n-                                            }\r\n-                                            if (!value[i].type.startsWith(\"image/\")) {\r\n-                                                return \"Only image files are allowed\";\r\n-                                            }\r\n-                                        }\r\n-                                        return true;\r\n-                                    },\r\n-                                }}\r\n-                                render={({ field: { onChange } }) => (\r\n-                                    <>\r\n-                                        <Box\r\n-                                            sx={{\r\n-                                                borderRadius: \"8px\",\r\n-                                                padding: \"20px\",\r\n-                                                textAlign: \"center\",\r\n-                                                cursor: \"pointer\",\r\n-                                                backgroundColor: \"#f9f9f9\",\r\n-                                                height: '135px',\r\n-                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n-                                            }}\r\n-                                            onClick={() => document.getElementById(\"upload-media\").click()}\r\n-                                        >\r\n-                                            {!imageLoader ? (\r\n-                                                <>\r\n-                                                    <input\r\n-                                                        type=\"file\"\r\n-                                                        accept=\"image/*\"\r\n-                                                        multiple\r\n-                                                        style={{ display: \"none\" }}\r\n-                                                        id=\"upload-media\"\r\n-                                                        onChange={(e) => {\r\n-                                                            const files = Array.from(e.target.files);\r\n-                                                            onChange(files); // Update react-hook-form\r\n-                                                            handleFileChange2(e); // Handle upload logic\r\n-                                                        }}\r\n-                                                    />\r\n-                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n-                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n-                                                        Drag & drop or click to upload images\r\n-                                                    </Typography>\r\n-                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n-                                                        Allowed: Images (Max 10MB per file)\r\n-                                                    </Typography>\r\n-                                                </>\r\n-                                            ) : (\r\n-                                                <CircularProgress size={90} />\r\n-                                            )}\r\n-                                        </Box>\r\n-\r\n-                                        {errors.media && (\r\n-                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n-                                                {errors.media.message}\r\n-                                            </Typography>\r\n-                                        )}\r\n-                                    </>\r\n-                                )}\r\n-                            />\r\n-                        </Grid>\r\n-\r\n-                        <Grid container p={2}>\r\n-                            {uploadedImages?.length > 0 && (\r\n-                                <Grid item xs={12}>\r\n-                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n-                                        Uploaded Batch Images :\r\n-                                    </InputLabel>\r\n-                                </Grid>\r\n-                            )}\r\n-                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n-                                {uploadedImages?.length > 0 &&\r\n-                                    uploadedImages.map((file, index) => (\r\n-                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n-                                            <img\r\n-                                                src={file}\r\n-                                                alt=\"Uploaded Preview\"\r\n-                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n-                                            />\r\n-                                            <Typography\r\n-                                                variant=\"caption\"\r\n-                                                sx={{\r\n-                                                    display: \"block\",\r\n-                                                    mt: 1,\r\n-                                                    maxWidth: \"150px\",\r\n-                                                    whiteSpace: \"nowrap\",\r\n-                                                    overflow: \"hidden\",\r\n-                                                    textOverflow: \"ellipsis\",\r\n-                                                }}\r\n-                                            >\r\n-                                                {file.split(\"/\").pop()}\r\n-                                            </Typography>\r\n-                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n-                                                <IconButton\r\n-                                                    onClick={() => handleRemoveImage(index)}\r\n-                                                    sx={{\r\n-                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n-                                                        color: \"#fff\",\r\n-                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n-                                                        width: 20,\r\n-                                                        height: 20,\r\n-                                                        borderRadius: \"50%\",\r\n-                                                        p: 0.5,\r\n-                                                    }}\r\n-                                                >\r\n-                                                    <CloseIcon fontSize=\"small\" />\r\n-                                                </IconButton>\r\n-                                            </Box>\r\n-                                        </Box>\r\n-                                    ))}\r\n-                            </Box>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Grid item xs={12} sm={5}>\r\n-                            <InputLabel sx={{\r\n-                                textTransform: \"capitalize\", mt: 2,\r\n-                                textAlign: \"left\",\r\n-                                fontWeight: 600,\r\n-                                fontSize: \"14px\",\r\n-                                color: \"#333\",\r\n-                                marginBottom: \"4px\",\r\n-                            }}>\r\n-                                Upload Before Images :*\r\n-                            </InputLabel>\r\n-\r\n-                            <Controller\r\n-                                name=\"media2\"\r\n-                                control={control}\r\n-                                rules={{\r\n-                                    required: \"At least one image file is required\",\r\n-                                    validate: (value) => {\r\n-                                        if (!value || value.length === 0) {\r\n-                                            return \"At least one image file is required\";\r\n-                                        }\r\n-                                        for (let i = 0; i < value.length; i++) {\r\n-                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n-                                                return \"Each file must be smaller than 10MB\";\r\n-                                            }\r\n-                                            if (!value[i].type.startsWith(\"image/\")) {\r\n-                                                return \"Only image files are allowed\";\r\n-                                            }\r\n-                                        }\r\n-                                        return true;\r\n-                                    },\r\n-                                }}\r\n-                                render={({ field: { onChange } }) => (\r\n-                                    <>\r\n-                                        <Box\r\n-                                            sx={{\r\n-                                                borderRadius: \"8px\",\r\n-                                                padding: \"20px\",\r\n-                                                textAlign: \"center\",\r\n-                                                cursor: \"pointer\",\r\n-                                                backgroundColor: \"#f9f9f9\",\r\n-                                                height: '135px',\r\n-                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n-                                            }}\r\n-                                            onClick={() => document.getElementById(\"upload-media2\").click()}\r\n-                                        >\r\n-                                            {!imageLoaderBefore ? (\r\n-                                                <>\r\n-                                                    <input\r\n-                                                        type=\"file\"\r\n-                                                        accept=\"image/*\"\r\n-                                                        multiple\r\n-                                                        style={{ display: \"none\" }}\r\n-                                                        id=\"upload-media2\"\r\n-                                                        onChange={(e) => {\r\n-                                                            const files = Array.from(e.target.files);\r\n-                                                            onChange(files); // Update react-hook-form\r\n-                                                            handleFileChange3(e); // Handle upload logic\r\n-                                                        }}\r\n-                                                    />\r\n-                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n-                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n-                                                        Drag & drop or click to upload images\r\n-                                                    </Typography>\r\n-                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n-                                                        Allowed: Images (Max 10MB per file)\r\n-                                                    </Typography>\r\n-                                                </>\r\n-                                            ) : (\r\n-                                                <CircularProgress size={90} />\r\n-                                            )}\r\n-                                        </Box>\r\n-\r\n-                                        {errors.media2 && (\r\n-                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n-                                                {errors.media2.message}\r\n-                                            </Typography>\r\n-                                        )}\r\n-                                    </>\r\n-                                )}\r\n-                            />\r\n-                        </Grid>\r\n-\r\n-                        <Grid container p={2}>\r\n-                            {beforeImages?.length > 0 && (\r\n-                                <Grid item xs={12}>\r\n-                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n-                                        Uploaded Before Images :\r\n-                                    </InputLabel>\r\n-                                </Grid>\r\n-                            )}\r\n-                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n-                                {beforeImages?.length > 0 &&\r\n-                                    beforeImages.map((file, index) => (\r\n-                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n-                                            <img\r\n-                                                src={file}\r\n-                                                alt=\"Uploaded Preview\"\r\n-                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n-                                            />\r\n-                                            <Typography\r\n-                                                variant=\"caption\"\r\n-                                                sx={{\r\n-                                                    display: \"block\",\r\n-                                                    mt: 1,\r\n-                                                    maxWidth: \"150px\",\r\n-                                                    whiteSpace: \"nowrap\",\r\n-                                                    overflow: \"hidden\",\r\n-                                                    textOverflow: \"ellipsis\",\r\n-                                                }}\r\n-                                            >\r\n-                                                {file.split(\"/\").pop()}\r\n-                                            </Typography>\r\n-                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n-                                                <IconButton\r\n-                                                    onClick={() => handleRemoveImage2(index)}\r\n-                                                    sx={{\r\n-                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n-                                                        color: \"#fff\",\r\n-                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n-                                                        width: 20,\r\n-                                                        height: 20,\r\n-                                                        borderRadius: \"50%\",\r\n-                                                        p: 0.5,\r\n-                                                    }}\r\n-                                                >\r\n-                                                    <CloseIcon fontSize=\"small\" />\r\n-                                                </IconButton>\r\n-                                            </Box>\r\n-                                        </Box>\r\n-                                    ))}\r\n-                            </Box>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Grid item xs={12} sm={5}>\r\n-                            <InputLabel sx={{\r\n-                                textTransform: \"capitalize\", mt: 2,\r\n-                                textAlign: \"left\",\r\n-                                fontWeight: 600,\r\n-                                fontSize: \"14px\",\r\n-                                color: \"#333\",\r\n-                                marginBottom: \"4px\",\r\n-                            }}>\r\n-                                Upload After Images :*\r\n-                            </InputLabel>\r\n-\r\n-                            <Controller\r\n-                                name=\"media3\"\r\n-                                control={control}\r\n-                                rules={{\r\n-                                    required: \"At least one image file is required\",\r\n-                                    validate: (value) => {\r\n-                                        if (!value || value.length === 0) {\r\n-                                            return \"At least one image file is required\";\r\n-                                        }\r\n-                                        for (let i = 0; i < value.length; i++) {\r\n-                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n-                                                return \"Each file must be smaller than 10MB\";\r\n-                                            }\r\n-                                            if (!value[i].type.startsWith(\"image/\")) {\r\n-                                                return \"Only image files are allowed\";\r\n-                                            }\r\n-                                        }\r\n-                                        return true;\r\n-                                    },\r\n-                                }}\r\n-                                render={({ field: { onChange } }) => (\r\n-                                    <>\r\n-                                        <Box\r\n-                                            sx={{\r\n-                                                borderRadius: \"8px\",\r\n-                                                padding: \"20px\",\r\n-                                                textAlign: \"center\",\r\n-                                                cursor: \"pointer\",\r\n-                                                backgroundColor: \"#f9f9f9\",\r\n-                                                height: '135px',\r\n-                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n-                                            }}\r\n-                                            onClick={() => document.getElementById(\"upload-media3\").click()}\r\n-                                        >\r\n-                                            {!imageLoaderAfter ? (\r\n-                                                <>\r\n-                                                    <input\r\n-                                                        type=\"file\"\r\n-                                                        accept=\"image/*\"\r\n-                                                        multiple\r\n-                                                        style={{ display: \"none\" }}\r\n-                                                        id=\"upload-media3\"\r\n-                                                        onChange={(e) => {\r\n-                                                            const files = Array.from(e.target.files);\r\n-                                                            onChange(files); // Update react-hook-form\r\n-                                                            handleFileChange4(e); // Handle upload logic\r\n-                                                        }}\r\n-                                                    />\r\n-                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n-                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n-                                                        Drag & drop or click to upload images\r\n-                                                    </Typography>\r\n-                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n-                                                        Allowed: Images (Max 10MB per file)\r\n-                                                    </Typography>\r\n-                                                </>\r\n-                                            ) : (\r\n-                                                <CircularProgress size={90} />\r\n-                                            )}\r\n-                                        </Box>\r\n-\r\n-                                        {errors.media3 && (\r\n-                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n-                                                {errors.media3.message}\r\n-                                            </Typography>\r\n-                                        )}\r\n-                                    </>\r\n-                                )}\r\n-                            />\r\n-                        </Grid>\r\n-\r\n-                        <Grid container p={2}>\r\n-                            {afterImages?.length > 0 && (\r\n-                                <Grid item xs={12}>\r\n-                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n-                                        Uploaded After Images :\r\n-                                    </InputLabel>\r\n-                                </Grid>\r\n-                            )}\r\n-                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n-                                {afterImages?.length > 0 &&\r\n-                                    afterImages.map((file, index) => (\r\n-                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n-                                            <img\r\n-                                                src={file}\r\n-                                                alt=\"Uploaded Preview\"\r\n-                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n-                                            />\r\n-                                            <Typography\r\n-                                                variant=\"caption\"\r\n-                                                sx={{\r\n-                                                    display: \"block\",\r\n-                                                    mt: 1,\r\n-                                                    maxWidth: \"150px\",\r\n-                                                    whiteSpace: \"nowrap\",\r\n-                                                    overflow: \"hidden\",\r\n-                                                    textOverflow: \"ellipsis\",\r\n-                                                }}\r\n-                                            >\r\n-                                                {file.split(\"/\").pop()}\r\n-                                            </Typography>\r\n-                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n-                                                <IconButton\r\n-                                                    onClick={() => handleRemoveImage3(index)}\r\n-                                                    sx={{\r\n-                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n-                                                        color: \"#fff\",\r\n-                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n-                                                        width: 20,\r\n-                                                        height: 20,\r\n-                                                        borderRadius: \"50%\",\r\n-                                                        p: 0.5,\r\n-                                                    }}\r\n-                                                >\r\n-                                                    <CloseIcon fontSize=\"small\" />\r\n-                                                </IconButton>\r\n-                                            </Box>\r\n-                                        </Box>\r\n-                                    ))}\r\n-                            </Box>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Typography variant=\"h6\" p={2} sx={{ mt: 4, fontWeight: 'bold' }}>Further Records</Typography>\r\n-\r\n-                        <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                            {furtherFields.map((item, index) => (\r\n-                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-                                    {/* Date Selection */}\r\n-                                    <Grid item xs={5}>\r\n-                                        <Box>\r\n-                                            <InputLabel sx={{ fontWeight: 700, fontSize: \"14px\", marginBottom: 1.5 }}>\r\n-                                                Further Date :*\r\n-                                            </InputLabel>\r\n-                                            <Controller\r\n-                                                name={`furtherFields.${index}.date`}\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: \"12px\",\r\n-                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.furtherFields?.[index]?.date && (\r\n-                                                <Typography color=\"error\">\r\n-                                                    {errors.furtherFields[index].date.message}\r\n-                                                </Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                        <Typography mt={2}>\r\n-                                            I confirm there has not been any changes to my medical history or my health since completing this form , it is still true and up to date.\r\n-                                        </Typography>\r\n-                                    </Grid>\r\n-\r\n-                                    {/* Signature Field */}\r\n-                                    <Grid item xs={5}>\r\n-                                        <Box>\r\n-                                            <InputLabel sx={{ fontWeight: 700, fontSize: \"14px\", marginBottom: 1 }}>\r\n-                                                Signature :*\r\n-                                            </InputLabel>\r\n-                                            <SignatureCanvas\r\n-                                                ref={(el) => (signCanvasRefs.current[index] = el)}\r\n-                                                penColor=\"black\"\r\n-                                                canvasProps={{ width: 300, height: 150, style: { border: \"1px dashed black\" } }}\r\n-                                            />\r\n-\r\n-                                        </Box>\r\n-                                        <Grid container spacing={1} mt={1}>\r\n-                                            <Grid item>\r\n-                                                <Button variant=\"contained\" color=\"secondary\" onClick={() => clearSignature(index)}>\r\n-                                                    Clear Signature\r\n-                                                </Button>\r\n-                                            </Grid>\r\n-                                            <Grid item>\r\n-                                                <Button variant=\"contained\" color=\"primary\" onClick={() => updateSignature(index)}>\r\n-                                                    Save Signature\r\n-                                                </Button>\r\n-                                            </Grid>\r\n-\r\n-                                        </Grid>\r\n-                                    </Grid>\r\n-\r\n-                                    {/* Remove Button */}\r\n-                                    <Grid item xs={1} display=\"flex\" justifyContent=\"flex-end\">\r\n-                                        {furtherFields.length > 1 && (\r\n-                                            <IconButton color=\"error\" onClick={() => removeFurther(index)}>\r\n-                                                <DeleteIcon />\r\n-                                            </IconButton>\r\n-                                        )}\r\n-                                    </Grid>\r\n-                                </Grid>\r\n-                            ))}\r\n-                        </LocalizationProvider>\r\n-\r\n-                        <Grid p={2}>\r\n-                            <Button variant=\"contained\" color=\"secondary\" onClick={() => appendFurther({ date: null, sign: \"\" })} sx={{ mt: 2 }}>\r\n-                                Add More Further Records\r\n-                            </Button>\r\n-                        </Grid>\r\n-                        <Grid container p={1}>\r\n-                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n-                        </Grid>\r\n-                        <Grid item xs={6} mt={2}><InputField\r\n-                            label={\"Notes :\"}\r\n-                            multiline\r\n-                            rows={3}\r\n-                            size={'small'}\r\n-                            placeholder={\"Notes\"}\r\n-                            error={errors?.extranotes?.message}\r\n-                            register={register(\"extranotes\", {\r\n-                                required:\r\n-                                    false\r\n-\r\n-                            })}\r\n-                        /></Grid>\r\n-                    </Grid>\r\n-                    <Box sx={{ display: 'flex', justifyContent: 'flex-end', width: '100%', mt: 2 }}>\r\n-                        <PrimaryButton loader={loader} disabled={loader} type={'submit'} title={\"Update\"} />\r\n-                    </Box>\r\n-                </Box>\r\n-            </Paper>\r\n-        </div >\r\n-    )\r\n-}\r\n-\r\n-export default UpdateConsentForm\r\n"
                },
                {
                    "date": 1743283152466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -662,9 +662,9 @@\n             })\r\n             setFormData(form)\r\n             setValue(\"media\", { shouldValidate: true });\r\n             setValue(\"media2\", { shouldValidate: true });\r\n-            setValue(\"media2\", { shouldValidate: true });\r\n+            setValue(\"media3\", { shouldValidate: true });\r\n             setSignature(form?.treatment_plan?.patient_sign) \r\n             setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n"
                },
                {
                    "date": 1743283252202,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,9 +247,9 @@\n             console.log(error);\r\n \r\n         }\r\n     };\r\n-    const UpdateConsentForm = async () => {\r\n+    const UpdateConsentForm = async (formData) => {\r\n         setLoader(true);\r\n         try {\r\n             let obj = {\r\n                 _id:id,\r\n"
                },
                {
                    "date": 1743283258781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -248,8 +248,10 @@\n \r\n         }\r\n     };\r\n     const UpdateConsentForm = async (formData) => {\r\n+        console.log(formData);\r\n+        \r\n         setLoader(true);\r\n         try {\r\n             let obj = {\r\n                 _id:id,\r\n"
                },
                {
                    "date": 1743283271563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -317,9 +317,9 @@\n             // Navigate if response is successful\r\n             if (response?.responseCode === 200) {\r\n                 console.log(response);\r\n                 setImageURL(null)\r\n-                navigate('/consent-forms')\r\n+                // navigate('/consent-forms')\r\n \r\n \r\n             }\r\n \r\n"
                },
                {
                    "date": 1743283413416,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -330,8 +330,9 @@\n \r\n             setLoader(false);\r\n         }\r\n     };\r\n+console.log(watch());\r\n \r\n     const SendOtp = async (val) => {\r\n         if (val != 'resend') {\r\n             setIsLoading(true)\r\n"
                },
                {
                    "date": 1743283506847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -300,20 +300,20 @@\n \r\n \r\n             };\r\n \r\n-            const promise = ApiServices.UpdateForm(obj);\r\n+            // const promise = ApiServices.UpdateForm(obj);\r\n \r\n-            // Handle the API response properly\r\n-            const response = await promise;\r\n-            console.log(response);\r\n+            // // Handle the API response properly\r\n+            // const response = await promise;\r\n+            // console.log(response);\r\n \r\n-            showPromiseToast(\r\n-                promise,\r\n-                \"Saving...\",\r\n-                \"Added Successfully\",\r\n-                \"Something Went Wrong\"\r\n-            );\r\n+            // showPromiseToast(\r\n+            //     promise,\r\n+            //     \"Saving...\",\r\n+            //     \"Added Successfully\",\r\n+            //     \"Something Went Wrong\"\r\n+            // );\r\n \r\n             // Navigate if response is successful\r\n             if (response?.responseCode === 200) {\r\n                 console.log(response);\r\n"
                },
                {
                    "date": 1743283516290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -299,8 +299,9 @@\n                 offers: permissions?.offers,\r\n \r\n \r\n             };\r\n+console.log(obj);\r\n \r\n             // const promise = ApiServices.UpdateForm(obj);\r\n \r\n             // // Handle the API response properly\r\n@@ -314,15 +315,15 @@\n             //     \"Something Went Wrong\"\r\n             // );\r\n \r\n             // Navigate if response is successful\r\n-            if (response?.responseCode === 200) {\r\n-                console.log(response);\r\n-                setImageURL(null)\r\n-                // navigate('/consent-forms')\r\n+            // if (response?.responseCode === 200) {\r\n+            //     console.log(response);\r\n+            //     setImageURL(null)\r\n+            //     // navigate('/consent-forms')\r\n \r\n \r\n-            }\r\n+            // }\r\n \r\n         } catch (error) {\r\n             console.log(error);\r\n             showErrorToast(error)\r\n"
                },
                {
                    "date": 1743283682223,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n             }\r\n         }\r\n     };\r\n     const [title, setTitle] = useState(null)\r\n-const [formData, setFormData] = useState(null)\r\n+    const [formData, setFormData] = useState(null)\r\n     const [step, setStep] = useState(1); // 1: OTP, 2: Reset Password\r\n     const [otp, setOtp] = useState(\"\");\r\n     const [otpError, setOtpError] = useState(false);\r\n     const [timer, setTimer] = useState(30);\r\n@@ -249,14 +249,14 @@\n         }\r\n     };\r\n     const UpdateConsentForm = async (formData) => {\r\n         console.log(formData);\r\n-        \r\n+\r\n         setLoader(true);\r\n         try {\r\n             let obj = {\r\n-                _id:id,\r\n-                patient_id: patientType == 'existing' ?  selectedPatient?.id : null,\r\n+                _id: id,\r\n+                patient_id: patientType == 'existing' ? selectedPatient?.id : null,\r\n                 form_id: null,\r\n                 aftercare_document: patientType == 'existing' ? selectedDocument?._id : null,\r\n                 treatment_date: getValues('treatmentDate'),\r\n                 consultation_date: getValues('consultationDate'),\r\n@@ -299,9 +299,9 @@\n                 offers: permissions?.offers,\r\n \r\n \r\n             };\r\n-console.log(obj);\r\n+            console.log(obj);\r\n \r\n             // const promise = ApiServices.UpdateForm(obj);\r\n \r\n             // // Handle the API response properly\r\n@@ -331,9 +331,9 @@\n \r\n             setLoader(false);\r\n         }\r\n     };\r\n-console.log(watch());\r\n+    console.log(watch());\r\n \r\n     const SendOtp = async (val) => {\r\n         if (val != 'resend') {\r\n             setIsLoading(true)\r\n@@ -657,24 +657,24 @@\n             };\r\n \r\n             const data = await ApiServices.getFormDetail(params);\r\n             let form = data?.data?.form\r\n-            setValue('treatmentDate',dayjs(form?.treatment_date))\r\n-            setValue('consultationDate',dayjs(form?.consultation_date))\r\n+            setValue('treatmentDate', dayjs(form?.treatment_date))\r\n+            setValue('consultationDate', dayjs(form?.consultation_date))\r\n             setPermissions({\r\n-                marketing: form?.permission_marketing ?  'yes' : 'no',\r\n-                offers: form?.offers?  'yes' : 'no',\r\n+                marketing: form?.permission_marketing ? 'yes' : 'no',\r\n+                offers: form?.offers ? 'yes' : 'no',\r\n             })\r\n             setFormData(form)\r\n             setValue(\"media\", { shouldValidate: true });\r\n             setValue(\"media2\", { shouldValidate: true });\r\n             setValue(\"media3\", { shouldValidate: true });\r\n-            setSignature(form?.treatment_plan?.patient_sign) \r\n-            setValue('patientDate',dayjs(form?.treatment_plan?.date))\r\n-            setValue('patientConcerns',form?.treatment_plan?.patient_concerns)\r\n-            setValue('patientGoal',form?.treatment_plan?.patient_goals)\r\n-            setValue('advisedPlan',form?.treatment_plan?.advised_plan)\r\n-            setValue('expectedResult',form?.treatment_plan?.expected_result)\r\n+            setSignature(form?.treatment_plan?.patient_sign)\r\n+            setValue('patientDate', dayjs(form?.treatment_plan?.date))\r\n+            setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n+            setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n+            setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n+            setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n             setValue(\"records\", form?.treatment_record);\r\n             setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n@@ -685,17 +685,17 @@\n             console.error(\"Error fetching location:\", error);\r\n         }\r\n     };\r\n     console.log(permissions);\r\n-    \r\n+\r\n     useEffect(() => {\r\n         getData()\r\n     }, [])\r\n     useEffect(() => {\r\n-        let value=patients?.find(item => item?._id == formData?.patient_id)\r\n+        let value = patients?.find(item => item?._id == formData?.patient_id)\r\n         setSelectedPatient(patients?.find(item => item?._id == formData?.patient_id))\r\n         setSelectedDocument(documents?.find(item => item?._id == formData?.aftercare_document))\r\n-        \r\n+\r\n         setValue('fname', value?.first_name || \"\");\r\n         setValue('lname', value?.last_name || \"\");\r\n         setValue('email', value?.email || \"\");\r\n         setValue('post', value?.post_code || \"\");\r\n@@ -725,11 +725,11 @@\n             console.log(\"Parsed Date:\", parsedDate);\r\n             setValue(\"selectedDate\", parsedDate);\r\n         }\r\n \r\n-    }, [patients,documents])\r\n-    \r\n+    }, [patients, documents])\r\n \r\n+\r\n     return (\r\n         <div>\r\n \r\n             <Paper sx={{ width: \"100%\", overflow: \"hidden\", boxShadow: 'none', backgroundColor: '#eff6ff', borderRadius: '12px' }}>\r\n@@ -1427,93 +1427,99 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                            {fields.map((item, index) => (\r\n-                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                        {fields.map((item, index) => (\r\n+    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+        {/* Patient Date Selection */}\r\n+        <Grid item xs={3}>\r\n+            <Box>\r\n+                <InputLabel\r\n+                    sx={{\r\n+                        textTransform: \"capitalize\",\r\n+                        textAlign: \"left\",\r\n+                        fontWeight: 700,\r\n+                        fontSize: \"14px\",\r\n+                        color: \"#333\",\r\n+                        marginBottom: 1.5,\r\n+                    }}\r\n+                >\r\n+                    Date :*\r\n+                </InputLabel>\r\n \r\n-                                    {/* Patient Date Selection */}\r\n-                                    <Grid item xs={3}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Date :*\r\n-                                            </InputLabel>\r\n+                <Controller\r\n+                    name={`records.${index}.date`}\r\n+                    control={control}\r\n+                    rules={{ required: \"Please select a date\" }}\r\n+                    render={({ field }) => (\r\n+                        <DatePicker\r\n+                            {...field}\r\n+                            value={field.value || null}\r\n+                            onChange={(newValue) => {\r\n+                                field.onChange(newValue);\r\n+                                setValue(`records.${index}.date`, newValue);\r\n+                            }}\r\n+                            slotProps={{\r\n+                                textField: {\r\n+                                    size: \"small\",\r\n+                                    fullWidth: true,\r\n+                                    sx: {\r\n+                                        \"& .MuiOutlinedInput-root\": {\r\n+                                            borderRadius: \"12px\",\r\n+                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                        },\r\n+                                    },\r\n+                                },\r\n+                            }}\r\n+                        />\r\n+                    )}\r\n+                />\r\n+                {errors.records?.[index]?.date && (\r\n+                    <Typography color=\"error\">\r\n+                        {errors.records[index].date.message}\r\n+                    </Typography>\r\n+                )}\r\n+            </Box>\r\n+        </Grid>\r\n \r\n-                                            <Controller\r\n-                                                name={`records.${index}.date`}\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: \"12px\",\r\n-                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.records?.[index]?.date && (\r\n-                                                <Typography color=\"error\">\r\n-                                                    {errors.records[index].date.message}\r\n-                                                </Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n+        {/* Amount Field */}\r\n+        <Grid item xs={3} mt={2}>\r\n+            <InputField\r\n+                label=\"Amount\"\r\n+                placeholder=\"Order Amount\"\r\n+                size=\"small\"\r\n+                {...register(`records.${index}.amount`, {\r\n+                    onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n+                })}\r\n+            />\r\n+        </Grid>\r\n \r\n-                                    {/* Amount Field */}\r\n-                                    <Grid item xs={3} mt={2}>\r\n-                                        <InputField\r\n-                                            label=\"Amount\"\r\n-                                            placeholder=\"Order Amount\"\r\n-                                            size=\"small\"\r\n-                                            {...register(`records.${index}.amount`)}\r\n-                                        />\r\n-                                    </Grid>\r\n+        {/* Description Field */}\r\n+        <Grid item xs={4}>\r\n+            <InputField\r\n+                label=\"Description\"\r\n+                multiline\r\n+                rows={3}\r\n+                placeholder=\"Description\"\r\n+                {...register(`records.${index}.description`, {\r\n+                    onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n+                })}\r\n+            />\r\n+        </Grid>\r\n \r\n+        {/* Remove Button (only for additional fields) */}\r\n+        <Grid item xs={1}>\r\n+            {index > 0 && (\r\n+                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                    <DeleteIcon />\r\n+                </IconButton>\r\n+            )}\r\n+        </Grid>\r\n+    </Grid>\r\n+))}\r\n \r\n-\r\n-                                    {/* Description Field */}\r\n-                                    <Grid item xs={4}>\r\n-                                        <InputField\r\n-                                            label=\"Description\"\r\n-                                            multiline\r\n-                                            rows={3}\r\n-                                            placeholder=\"Description\"\r\n-                                            {...register(`records.${index}.description`)}\r\n-                                        />\r\n-                                    </Grid>\r\n-                                    {/* Remove Button (only for additional fields) */}\r\n-                                    <Grid item xs={1}>\r\n-                                        {index > 0 && (\r\n-                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                                                <DeleteIcon />\r\n-                                            </IconButton>\r\n-                                        )}\r\n-                                    </Grid>\r\n-                                </Grid>\r\n-                            ))}\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743283953085,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,98 +1427,98 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                        {fields.map((item, index) => (\r\n-    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-        {/* Patient Date Selection */}\r\n-        <Grid item xs={3}>\r\n-            <Box>\r\n-                <InputLabel\r\n-                    sx={{\r\n-                        textTransform: \"capitalize\",\r\n-                        textAlign: \"left\",\r\n-                        fontWeight: 700,\r\n-                        fontSize: \"14px\",\r\n-                        color: \"#333\",\r\n-                        marginBottom: 1.5,\r\n-                    }}\r\n-                >\r\n-                    Date :*\r\n-                </InputLabel>\r\n+                            {fields.map((item, index) => (\r\n+                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                                    {/* Patient Date Selection */}\r\n+                                    <Grid item xs={3}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Date :*\r\n+                                            </InputLabel>\r\n \r\n-                <Controller\r\n-                    name={`records.${index}.date`}\r\n-                    control={control}\r\n-                    rules={{ required: \"Please select a date\" }}\r\n-                    render={({ field }) => (\r\n-                        <DatePicker\r\n-                            {...field}\r\n-                            value={field.value || null}\r\n-                            onChange={(newValue) => {\r\n-                                field.onChange(newValue);\r\n-                                setValue(`records.${index}.date`, newValue);\r\n-                            }}\r\n-                            slotProps={{\r\n-                                textField: {\r\n-                                    size: \"small\",\r\n-                                    fullWidth: true,\r\n-                                    sx: {\r\n-                                        \"& .MuiOutlinedInput-root\": {\r\n-                                            borderRadius: \"12px\",\r\n-                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                        },\r\n-                                    },\r\n-                                },\r\n-                            }}\r\n-                        />\r\n-                    )}\r\n-                />\r\n-                {errors.records?.[index]?.date && (\r\n-                    <Typography color=\"error\">\r\n-                        {errors.records[index].date.message}\r\n-                    </Typography>\r\n-                )}\r\n-            </Box>\r\n-        </Grid>\r\n+                                            <Controller\r\n+                                                name={`records.${index}.date`}\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => {\r\n+                                                            field.onChange(newValue);\r\n+                                                            setValue(`records.${index}.date`, newValue);\r\n+                                                        }}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: \"12px\",\r\n+                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.records?.[index]?.date && (\r\n+                                                <Typography color=\"error\">\r\n+                                                    {errors.records[index].date.message}\r\n+                                                </Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n \r\n-        {/* Amount Field */}\r\n-        <Grid item xs={3} mt={2}>\r\n-            <InputField\r\n-                label=\"Amount\"\r\n-                placeholder=\"Order Amount\"\r\n-                size=\"small\"\r\n-                {...register(`records.${index}.amount`, {\r\n-                    onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n-                })}\r\n-            />\r\n-        </Grid>\r\n+                                    {/* Amount Field */}\r\n+                                    <Grid item xs={3} mt={2}>\r\n+                                        <InputField\r\n+                                            label=\"Amount\"\r\n+                                            placeholder=\"Order Amount\"\r\n+                                            size=\"small\"\r\n+                                            {...register(`records.${index}.amount`, {\r\n+                                                onChange: (e) => setValue(fields[index].amount, e.target.value),\r\n+                                            })}\r\n+                                        />\r\n+                                    </Grid>\r\n \r\n-        {/* Description Field */}\r\n-        <Grid item xs={4}>\r\n-            <InputField\r\n-                label=\"Description\"\r\n-                multiline\r\n-                rows={3}\r\n-                placeholder=\"Description\"\r\n-                {...register(`records.${index}.description`, {\r\n-                    onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n-                })}\r\n-            />\r\n-        </Grid>\r\n+                                    {/* Description Field */}\r\n+                                    <Grid item xs={4}>\r\n+                                        <InputField\r\n+                                            label=\"Description\"\r\n+                                            multiline\r\n+                                            rows={3}\r\n+                                            placeholder=\"Description\"\r\n+                                            {...register(`records.${index}.description`, {\r\n+                                                onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n+                                            })}\r\n+                                        />\r\n+                                    </Grid>\r\n \r\n-        {/* Remove Button (only for additional fields) */}\r\n-        <Grid item xs={1}>\r\n-            {index > 0 && (\r\n-                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                    <DeleteIcon />\r\n-                </IconButton>\r\n-            )}\r\n-        </Grid>\r\n-    </Grid>\r\n-))}\r\n+                                    {/* Remove Button (only for additional fields) */}\r\n+                                    <Grid item xs={1}>\r\n+                                        {index > 0 && (\r\n+                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                                                <DeleteIcon />\r\n+                                            </IconButton>\r\n+                                        )}\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            ))}\r\n \r\n                         </LocalizationProvider>\r\n \r\n \r\n"
                },
                {
                    "date": 1743284013455,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1489,9 +1489,9 @@\n                                             label=\"Amount\"\r\n                                             placeholder=\"Order Amount\"\r\n                                             size=\"small\"\r\n                                             {...register(`records.${index}.amount`, {\r\n-                                                onChange: (e) => setValue(fields[index].amount, e.target.value),\r\n+                                                onChange: (e) => {console.log();setValue(fields[index].amount, e.target.value)},\r\n                                             })}\r\n                                         />\r\n                                     </Grid>\r\n \r\n"
                },
                {
                    "date": 1743284065337,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,99 +1427,95 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                            {fields.map((item, index) => (\r\n-                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-                                    {/* Patient Date Selection */}\r\n-                                    <Grid item xs={3}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Date :*\r\n-                                            </InputLabel>\r\n+                        {fields.map((item, index) => (\r\n+    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+        {/* Patient Date Selection */}\r\n+        <Grid item xs={3}>\r\n+            <Box>\r\n+                <InputLabel\r\n+                    sx={{\r\n+                        textTransform: \"capitalize\",\r\n+                        textAlign: \"left\",\r\n+                        fontWeight: 700,\r\n+                        fontSize: \"14px\",\r\n+                        color: \"#333\",\r\n+                        marginBottom: 1.5,\r\n+                    }}\r\n+                >\r\n+                    Date :*\r\n+                </InputLabel>\r\n \r\n-                                            <Controller\r\n-                                                name={`records.${index}.date`}\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => {\r\n-                                                            field.onChange(newValue);\r\n-                                                            setValue(`records.${index}.date`, newValue);\r\n-                                                        }}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: \"12px\",\r\n-                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.records?.[index]?.date && (\r\n-                                                <Typography color=\"error\">\r\n-                                                    {errors.records[index].date.message}\r\n-                                                </Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n+                <Controller\r\n+                    name={`records.${index}.date`}\r\n+                    control={control}\r\n+                    rules={{ required: \"Please select a date\" }}\r\n+                    render={({ field }) => (\r\n+                        <DatePicker\r\n+                            {...field}\r\n+                            value={field.value || null}\r\n+                            onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n+                            slotProps={{\r\n+                                textField: {\r\n+                                    size: \"small\",\r\n+                                    fullWidth: true,\r\n+                                    sx: {\r\n+                                        \"& .MuiOutlinedInput-root\": {\r\n+                                            borderRadius: \"12px\",\r\n+                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                        },\r\n+                                    },\r\n+                                },\r\n+                            }}\r\n+                        />\r\n+                    )}\r\n+                />\r\n+                {errors.records?.[index]?.date && (\r\n+                    <Typography color=\"error\">\r\n+                        {errors.records[index].date.message}\r\n+                    </Typography>\r\n+                )}\r\n+            </Box>\r\n+        </Grid>\r\n \r\n-                                    {/* Amount Field */}\r\n-                                    <Grid item xs={3} mt={2}>\r\n-                                        <InputField\r\n-                                            label=\"Amount\"\r\n-                                            placeholder=\"Order Amount\"\r\n-                                            size=\"small\"\r\n-                                            {...register(`records.${index}.amount`, {\r\n-                                                onChange: (e) => {console.log();setValue(fields[index].amount, e.target.value)},\r\n-                                            })}\r\n-                                        />\r\n-                                    </Grid>\r\n+        {/* Amount Field */}\r\n+        <Grid item xs={3} mt={2}>\r\n+            <InputField\r\n+                label=\"Amount\"\r\n+                placeholder=\"Order Amount\"\r\n+                size=\"small\"\r\n+                {...register(`records.${index}.amount`)}\r\n+                onChange={(e) => setValue(`records.${index}.amount`, e.target.value)}\r\n+            />\r\n+        </Grid>\r\n \r\n-                                    {/* Description Field */}\r\n-                                    <Grid item xs={4}>\r\n-                                        <InputField\r\n-                                            label=\"Description\"\r\n-                                            multiline\r\n-                                            rows={3}\r\n-                                            placeholder=\"Description\"\r\n-                                            {...register(`records.${index}.description`, {\r\n-                                                onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n-                                            })}\r\n-                                        />\r\n-                                    </Grid>\r\n+        {/* Description Field */}\r\n+        <Grid item xs={4}>\r\n+            <InputField\r\n+                label=\"Description\"\r\n+                multiline\r\n+                rows={3}\r\n+                placeholder=\"Description\"\r\n+                {...register(`records.${index}.description`)}\r\n+                onChange={(e) => setValue(`records.${index}.description`, e.target.value)}\r\n+            />\r\n+        </Grid>\r\n \r\n-                                    {/* Remove Button (only for additional fields) */}\r\n-                                    <Grid item xs={1}>\r\n-                                        {index > 0 && (\r\n-                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                                                <DeleteIcon />\r\n-                                            </IconButton>\r\n-                                        )}\r\n-                                    </Grid>\r\n-                                </Grid>\r\n-                            ))}\r\n+        {/* Remove Button (only for additional fields) */}\r\n+        <Grid item xs={1}>\r\n+            {index > 0 && (\r\n+                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                    <DeleteIcon />\r\n+                </IconButton>\r\n+            )}\r\n+        </Grid>\r\n+    </Grid>\r\n+))}\r\n \r\n+\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284087574,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,95 +1427,99 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                        {fields.map((item, index) => (\r\n-    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-        {/* Patient Date Selection */}\r\n-        <Grid item xs={3}>\r\n-            <Box>\r\n-                <InputLabel\r\n-                    sx={{\r\n-                        textTransform: \"capitalize\",\r\n-                        textAlign: \"left\",\r\n-                        fontWeight: 700,\r\n-                        fontSize: \"14px\",\r\n-                        color: \"#333\",\r\n-                        marginBottom: 1.5,\r\n-                    }}\r\n-                >\r\n-                    Date :*\r\n-                </InputLabel>\r\n+                            {fields.map((item, index) => (\r\n+                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                                    {/* Patient Date Selection */}\r\n+                                    <Grid item xs={3}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Date :*\r\n+                                            </InputLabel>\r\n \r\n-                <Controller\r\n-                    name={`records.${index}.date`}\r\n-                    control={control}\r\n-                    rules={{ required: \"Please select a date\" }}\r\n-                    render={({ field }) => (\r\n-                        <DatePicker\r\n-                            {...field}\r\n-                            value={field.value || null}\r\n-                            onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n-                            slotProps={{\r\n-                                textField: {\r\n-                                    size: \"small\",\r\n-                                    fullWidth: true,\r\n-                                    sx: {\r\n-                                        \"& .MuiOutlinedInput-root\": {\r\n-                                            borderRadius: \"12px\",\r\n-                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                        },\r\n-                                    },\r\n-                                },\r\n-                            }}\r\n-                        />\r\n-                    )}\r\n-                />\r\n-                {errors.records?.[index]?.date && (\r\n-                    <Typography color=\"error\">\r\n-                        {errors.records[index].date.message}\r\n-                    </Typography>\r\n-                )}\r\n-            </Box>\r\n-        </Grid>\r\n+                                            <Controller\r\n+                                                name={`records.${index}.date`}\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => {\r\n+                                                            field.onChange(newValue);\r\n+                                                            setValue(`records.${index}.date`, newValue);\r\n+                                                        }}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: \"12px\",\r\n+                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.records?.[index]?.date && (\r\n+                                                <Typography color=\"error\">\r\n+                                                    {errors.records[index].date.message}\r\n+                                                </Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n \r\n-        {/* Amount Field */}\r\n-        <Grid item xs={3} mt={2}>\r\n-            <InputField\r\n-                label=\"Amount\"\r\n-                placeholder=\"Order Amount\"\r\n-                size=\"small\"\r\n-                {...register(`records.${index}.amount`)}\r\n-                onChange={(e) => setValue(`records.${index}.amount`, e.target.value)}\r\n-            />\r\n-        </Grid>\r\n+                                    {/* Amount Field */}\r\n+                                    <Grid item xs={3} mt={2}>\r\n+                                        <InputField\r\n+                                            label=\"Amount\"\r\n+                                            placeholder=\"Order Amount\"\r\n+                                            size=\"small\"\r\n+                                            {...register(`records.${index}.amount`, {\r\n+                                                onChange: (e) => {console.log(fields);setValue(fields[index].amount, e.target.value)},\r\n+                                            })}\r\n+                                        />\r\n+                                    </Grid>\r\n \r\n-        {/* Description Field */}\r\n-        <Grid item xs={4}>\r\n-            <InputField\r\n-                label=\"Description\"\r\n-                multiline\r\n-                rows={3}\r\n-                placeholder=\"Description\"\r\n-                {...register(`records.${index}.description`)}\r\n-                onChange={(e) => setValue(`records.${index}.description`, e.target.value)}\r\n-            />\r\n-        </Grid>\r\n+                                    {/* Description Field */}\r\n+                                    <Grid item xs={4}>\r\n+                                        <InputField\r\n+                                            label=\"Description\"\r\n+                                            multiline\r\n+                                            rows={3}\r\n+                                            placeholder=\"Description\"\r\n+                                            {...register(`records.${index}.description`, {\r\n+                                                onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n+                                            })}\r\n+                                        />\r\n+                                    </Grid>\r\n \r\n-        {/* Remove Button (only for additional fields) */}\r\n-        <Grid item xs={1}>\r\n-            {index > 0 && (\r\n-                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                    <DeleteIcon />\r\n-                </IconButton>\r\n-            )}\r\n-        </Grid>\r\n-    </Grid>\r\n-))}\r\n+                                    {/* Remove Button (only for additional fields) */}\r\n+                                    <Grid item xs={1}>\r\n+                                        {index > 0 && (\r\n+                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                                                <DeleteIcon />\r\n+                                            </IconButton>\r\n+                                        )}\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            ))}\r\n \r\n-\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284167799,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,99 +1427,97 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                            {fields.map((item, index) => (\r\n-                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-                                    {/* Patient Date Selection */}\r\n-                                    <Grid item xs={3}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Date :*\r\n-                                            </InputLabel>\r\n+                        {fields.map((item, index) => (\r\n+    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+        {/* Patient Date Selection */}\r\n+        <Grid item xs={3}>\r\n+            <Box>\r\n+                <InputLabel\r\n+                    sx={{\r\n+                        textTransform: \"capitalize\",\r\n+                        textAlign: \"left\",\r\n+                        fontWeight: 700,\r\n+                        fontSize: \"14px\",\r\n+                        color: \"#333\",\r\n+                        marginBottom: 1.5,\r\n+                    }}\r\n+                >\r\n+                    Date :*\r\n+                </InputLabel>\r\n \r\n-                                            <Controller\r\n-                                                name={`records.${index}.date`}\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        {...field}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => {\r\n-                                                            field.onChange(newValue);\r\n-                                                            setValue(`records.${index}.date`, newValue);\r\n-                                                        }}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: \"12px\",\r\n-                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.records?.[index]?.date && (\r\n-                                                <Typography color=\"error\">\r\n-                                                    {errors.records[index].date.message}\r\n-                                                </Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n+                <Controller\r\n+                    name={`records.${index}.date`}\r\n+                    control={control}\r\n+                    rules={{ required: \"Please select a date\" }}\r\n+                    render={({ field }) => (\r\n+                        <DatePicker\r\n+                            {...field}\r\n+                            value={field.value || null}\r\n+                            onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n+                            slotProps={{\r\n+                                textField: {\r\n+                                    size: \"small\",\r\n+                                    fullWidth: true,\r\n+                                    sx: {\r\n+                                        \"& .MuiOutlinedInput-root\": {\r\n+                                            borderRadius: \"12px\",\r\n+                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                        },\r\n+                                    },\r\n+                                },\r\n+                            }}\r\n+                        />\r\n+                    )}\r\n+                />\r\n+                {errors.records?.[index]?.date && (\r\n+                    <Typography color=\"error\">\r\n+                        {errors.records[index].date.message}\r\n+                    </Typography>\r\n+                )}\r\n+            </Box>\r\n+        </Grid>\r\n \r\n-                                    {/* Amount Field */}\r\n-                                    <Grid item xs={3} mt={2}>\r\n-                                        <InputField\r\n-                                            label=\"Amount\"\r\n-                                            placeholder=\"Order Amount\"\r\n-                                            size=\"small\"\r\n-                                            {...register(`records.${index}.amount`, {\r\n-                                                onChange: (e) => {console.log(fields);setValue(fields[index].amount, e.target.value)},\r\n-                                            })}\r\n-                                        />\r\n-                                    </Grid>\r\n+        {/* Amount Field */}\r\n+        <Grid item xs={3} mt={2}>\r\n+            <InputField\r\n+                label=\"Amount\"\r\n+                placeholder=\"Order Amount\"\r\n+                size=\"small\"\r\n+                {...register(`records.${index}.amount`, {\r\n+                    onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n+                })}\r\n+            />\r\n+        </Grid>\r\n \r\n-                                    {/* Description Field */}\r\n-                                    <Grid item xs={4}>\r\n-                                        <InputField\r\n-                                            label=\"Description\"\r\n-                                            multiline\r\n-                                            rows={3}\r\n-                                            placeholder=\"Description\"\r\n-                                            {...register(`records.${index}.description`, {\r\n-                                                onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n-                                            })}\r\n-                                        />\r\n-                                    </Grid>\r\n+        {/* Description Field */}\r\n+        <Grid item xs={4}>\r\n+            <InputField\r\n+                label=\"Description\"\r\n+                multiline\r\n+                rows={3}\r\n+                placeholder=\"Description\"\r\n+                {...register(`records.${index}.description`, {\r\n+                    onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n+                })}\r\n+            />\r\n+        </Grid>\r\n \r\n-                                    {/* Remove Button (only for additional fields) */}\r\n-                                    <Grid item xs={1}>\r\n-                                        {index > 0 && (\r\n-                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                                                <DeleteIcon />\r\n-                                            </IconButton>\r\n-                                        )}\r\n-                                    </Grid>\r\n-                                </Grid>\r\n-                            ))}\r\n+        {/* Remove Button (only for additional fields) */}\r\n+        <Grid item xs={1}>\r\n+            {index > 0 && (\r\n+                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                    <DeleteIcon />\r\n+                </IconButton>\r\n+            )}\r\n+        </Grid>\r\n+    </Grid>\r\n+))}\r\n \r\n+\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284220641,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1453,9 +1453,12 @@\n                     render={({ field }) => (\r\n                         <DatePicker\r\n                             {...field}\r\n                             value={field.value || null}\r\n-                            onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n+                            onChange={(newValue) => {\r\n+                                field.onChange(newValue);\r\n+                                setValue(`records.${index}.date`, newValue);\r\n+                            }}\r\n                             slotProps={{\r\n                                 textField: {\r\n                                     size: \"small\",\r\n                                     fullWidth: true,\r\n@@ -1481,28 +1484,44 @@\n         </Grid>\r\n \r\n         {/* Amount Field */}\r\n         <Grid item xs={3} mt={2}>\r\n-            <InputField\r\n-                label=\"Amount\"\r\n-                placeholder=\"Order Amount\"\r\n-                size=\"small\"\r\n-                {...register(`records.${index}.amount`, {\r\n-                    onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n-                })}\r\n+            <Controller\r\n+                name={`records.${index}.amount`}\r\n+                control={control}\r\n+                render={({ field }) => (\r\n+                    <InputField\r\n+                        label=\"Amount\"\r\n+                        placeholder=\"Order Amount\"\r\n+                        size=\"small\"\r\n+                        {...field}\r\n+                        onChange={(e) => {\r\n+                            field.onChange(e);\r\n+                            setValue(`records.${index}.amount`, e.target.value);\r\n+                        }}\r\n+                    />\r\n+                )}\r\n             />\r\n         </Grid>\r\n \r\n         {/* Description Field */}\r\n         <Grid item xs={4}>\r\n-            <InputField\r\n-                label=\"Description\"\r\n-                multiline\r\n-                rows={3}\r\n-                placeholder=\"Description\"\r\n-                {...register(`records.${index}.description`, {\r\n-                    onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n-                })}\r\n+            <Controller\r\n+                name={`records.${index}.description`}\r\n+                control={control}\r\n+                render={({ field }) => (\r\n+                    <InputField\r\n+                        label=\"Description\"\r\n+                        multiline\r\n+                        rows={3}\r\n+                        placeholder=\"Description\"\r\n+                        {...field}\r\n+                        onChange={(e) => {\r\n+                            field.onChange(e);\r\n+                            setValue(`records.${index}.description`, e.target.value);\r\n+                        }}\r\n+                    />\r\n+                )}\r\n             />\r\n         </Grid>\r\n \r\n         {/* Remove Button (only for additional fields) */}\r\n@@ -1516,8 +1535,9 @@\n     </Grid>\r\n ))}\r\n \r\n \r\n+\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284318684,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1429,9 +1429,10 @@\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                         {fields.map((item, index) => (\r\n     <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-        {/* Patient Date Selection */}\r\n+        \r\n+        {/* Date Picker */}\r\n         <Grid item xs={3}>\r\n             <Box>\r\n                 <InputLabel\r\n                     sx={{\r\n@@ -1455,9 +1456,9 @@\n                             {...field}\r\n                             value={field.value || null}\r\n                             onChange={(newValue) => {\r\n                                 field.onChange(newValue);\r\n-                                setValue(`records.${index}.date`, newValue);\r\n+                                setValue(`records.${index}.date`, newValue, { shouldValidate: true, shouldDirty: true });\r\n                             }}\r\n                             slotProps={{\r\n                                 textField: {\r\n                                     size: \"small\",\r\n@@ -1492,12 +1493,12 @@\n                     <InputField\r\n                         label=\"Amount\"\r\n                         placeholder=\"Order Amount\"\r\n                         size=\"small\"\r\n-                        {...field}\r\n+                        value={field.value || \"\"}\r\n                         onChange={(e) => {\r\n-                            field.onChange(e);\r\n-                            setValue(`records.${index}.amount`, e.target.value);\r\n+                            field.onChange(e.target.value);\r\n+                            setValue(`records.${index}.amount`, e.target.value, { shouldValidate: true, shouldDirty: true });\r\n                         }}\r\n                     />\r\n                 )}\r\n             />\r\n@@ -1513,12 +1514,12 @@\n                         label=\"Description\"\r\n                         multiline\r\n                         rows={3}\r\n                         placeholder=\"Description\"\r\n-                        {...field}\r\n+                        value={field.value || \"\"}\r\n                         onChange={(e) => {\r\n-                            field.onChange(e);\r\n-                            setValue(`records.${index}.description`, e.target.value);\r\n+                            field.onChange(e.target.value);\r\n+                            setValue(`records.${index}.description`, e.target.value, { shouldValidate: true, shouldDirty: true });\r\n                         }}\r\n                     />\r\n                 )}\r\n             />\r\n@@ -1536,8 +1537,9 @@\n ))}\r\n \r\n \r\n \r\n+\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284385661,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1429,9 +1429,9 @@\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                         {fields.map((item, index) => (\r\n     <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-        \r\n+\r\n         {/* Date Picker */}\r\n         <Grid item xs={3}>\r\n             <Box>\r\n                 <InputLabel\r\n@@ -1493,9 +1493,9 @@\n                     <InputField\r\n                         label=\"Amount\"\r\n                         placeholder=\"Order Amount\"\r\n                         size=\"small\"\r\n-                        value={field.value || \"\"}\r\n+                        {...field} // This ensures typing works\r\n                         onChange={(e) => {\r\n                             field.onChange(e.target.value);\r\n                             setValue(`records.${index}.amount`, e.target.value, { shouldValidate: true, shouldDirty: true });\r\n                         }}\r\n@@ -1514,9 +1514,9 @@\n                         label=\"Description\"\r\n                         multiline\r\n                         rows={3}\r\n                         placeholder=\"Description\"\r\n-                        value={field.value || \"\"}\r\n+                        {...field} // Ensures typing works\r\n                         onChange={(e) => {\r\n                             field.onChange(e.target.value);\r\n                             setValue(`records.${index}.description`, e.target.value, { shouldValidate: true, shouldDirty: true });\r\n                         }}\r\n@@ -1524,9 +1524,9 @@\n                 )}\r\n             />\r\n         </Grid>\r\n \r\n-        {/* Remove Button (only for additional fields) */}\r\n+        {/* Remove Button */}\r\n         <Grid item xs={1}>\r\n             {index > 0 && (\r\n                 <IconButton color=\"error\" onClick={() => remove(index)}>\r\n                     <DeleteIcon />\r\n@@ -1538,8 +1538,9 @@\n \r\n \r\n \r\n \r\n+\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284471190,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -331,9 +331,9 @@\n \r\n             setLoader(false);\r\n         }\r\n     };\r\n-    console.log(watch());\r\n+    {console.log(\"Updated Records:\", watch(\"records\"))}\r\n \r\n     const SendOtp = async (val) => {\r\n         if (val != 'resend') {\r\n             setIsLoading(true)\r\n"
                },
                {
                    "date": 1743284663080,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1456,9 +1456,8 @@\n                             {...field}\r\n                             value={field.value || null}\r\n                             onChange={(newValue) => {\r\n                                 field.onChange(newValue);\r\n-                                setValue(`records.${index}.date`, newValue, { shouldValidate: true, shouldDirty: true });\r\n                             }}\r\n                             slotProps={{\r\n                                 textField: {\r\n                                     size: \"small\",\r\n@@ -1493,13 +1492,9 @@\n                     <InputField\r\n                         label=\"Amount\"\r\n                         placeholder=\"Order Amount\"\r\n                         size=\"small\"\r\n-                        {...field} // This ensures typing works\r\n-                        onChange={(e) => {\r\n-                            field.onChange(e.target.value);\r\n-                            setValue(`records.${index}.amount`, e.target.value, { shouldValidate: true, shouldDirty: true });\r\n-                        }}\r\n+                        {...field}\r\n                     />\r\n                 )}\r\n             />\r\n         </Grid>\r\n@@ -1514,13 +1509,9 @@\n                         label=\"Description\"\r\n                         multiline\r\n                         rows={3}\r\n                         placeholder=\"Description\"\r\n-                        {...field} // Ensures typing works\r\n-                        onChange={(e) => {\r\n-                            field.onChange(e.target.value);\r\n-                            setValue(`records.${index}.description`, e.target.value, { shouldValidate: true, shouldDirty: true });\r\n-                        }}\r\n+                        {...field}\r\n                     />\r\n                 )}\r\n             />\r\n         </Grid>\r\n@@ -1538,9 +1529,8 @@\n \r\n \r\n \r\n \r\n-\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743284752071,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1450,14 +1450,14 @@\n                 <Controller\r\n                     name={`records.${index}.date`}\r\n                     control={control}\r\n                     rules={{ required: \"Please select a date\" }}\r\n-                    render={({ field }) => (\r\n+                    render={({ field: { onChange, value, ...restField } }) => (\r\n                         <DatePicker\r\n-                            {...field}\r\n-                            value={field.value || null}\r\n+                            {...restField}\r\n+                            value={value || null}\r\n                             onChange={(newValue) => {\r\n-                                field.onChange(newValue);\r\n+                                onChange(newValue);\r\n                             }}\r\n                             slotProps={{\r\n                                 textField: {\r\n                                     size: \"small\",\r\n@@ -1487,14 +1487,18 @@\n         <Grid item xs={3} mt={2}>\r\n             <Controller\r\n                 name={`records.${index}.amount`}\r\n                 control={control}\r\n-                render={({ field }) => (\r\n+                render={({ field: { onChange, value, ...restField } }) => (\r\n                     <InputField\r\n                         label=\"Amount\"\r\n                         placeholder=\"Order Amount\"\r\n                         size=\"small\"\r\n-                        {...field}\r\n+                        {...restField}\r\n+                        value={value || ''}\r\n+                        onChange={(e) => {\r\n+                            onChange(e.target.value);\r\n+                        }}\r\n                     />\r\n                 )}\r\n             />\r\n         </Grid>\r\n@@ -1503,15 +1507,19 @@\n         <Grid item xs={4}>\r\n             <Controller\r\n                 name={`records.${index}.description`}\r\n                 control={control}\r\n-                render={({ field }) => (\r\n+                render={({ field: { onChange, value, ...restField } }) => (\r\n                     <InputField\r\n                         label=\"Description\"\r\n                         multiline\r\n                         rows={3}\r\n                         placeholder=\"Description\"\r\n-                        {...field}\r\n+                        {...restField}\r\n+                        value={value || ''}\r\n+                        onChange={(e) => {\r\n+                            onChange(e.target.value);\r\n+                        }}\r\n                     />\r\n                 )}\r\n             />\r\n         </Grid>\r\n"
                },
                {
                    "date": 1743284840185,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1450,15 +1450,15 @@\n                 <Controller\r\n                     name={`records.${index}.date`}\r\n                     control={control}\r\n                     rules={{ required: \"Please select a date\" }}\r\n-                    render={({ field: { onChange, value, ...restField } }) => (\r\n+                    render={({ field }) => (\r\n                         <DatePicker\r\n-                            {...restField}\r\n-                            value={value || null}\r\n-                            onChange={(newValue) => {\r\n-                                onChange(newValue);\r\n-                            }}\r\n+                            inputRef={field.ref}\r\n+                            value={field.value || null}\r\n+                            onChange={(newValue) => field.onChange(newValue)}\r\n+                            onBlur={field.onBlur}\r\n+                            name={field.name}\r\n                             slotProps={{\r\n                                 textField: {\r\n                                     size: \"small\",\r\n                                     fullWidth: true,\r\n@@ -1484,45 +1484,89 @@\n         </Grid>\r\n \r\n         {/* Amount Field */}\r\n         <Grid item xs={3} mt={2}>\r\n-            <Controller\r\n-                name={`records.${index}.amount`}\r\n-                control={control}\r\n-                render={({ field: { onChange, value, ...restField } }) => (\r\n-                    <InputField\r\n-                        label=\"Amount\"\r\n-                        placeholder=\"Order Amount\"\r\n-                        size=\"small\"\r\n-                        {...restField}\r\n-                        value={value || ''}\r\n-                        onChange={(e) => {\r\n-                            onChange(e.target.value);\r\n-                        }}\r\n-                    />\r\n-                )}\r\n-            />\r\n+            <Box>\r\n+                <InputLabel\r\n+                    sx={{\r\n+                        textTransform: \"capitalize\",\r\n+                        textAlign: \"left\",\r\n+                        fontWeight: 700,\r\n+                        fontSize: \"14px\",\r\n+                        color: \"#333\",\r\n+                        marginBottom: 1.5,\r\n+                    }}\r\n+                >\r\n+                    Amount :\r\n+                </InputLabel>\r\n+                <Controller\r\n+                    name={`records.${index}.amount`}\r\n+                    control={control}\r\n+                    render={({ field }) => (\r\n+                        <TextField\r\n+                            placeholder=\"Order Amount\"\r\n+                            size=\"small\"\r\n+                            fullWidth\r\n+                            inputRef={field.ref}\r\n+                            value={field.value || ''}\r\n+                            onChange={field.onChange}\r\n+                            onBlur={field.onBlur}\r\n+                            name={field.name}\r\n+                            sx={{\r\n+                                \"& .MuiOutlinedInput-root\": {\r\n+                                    borderRadius: \"12px\",\r\n+                                    \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                    \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                    \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                },\r\n+                            }}\r\n+                        />\r\n+                    )}\r\n+                />\r\n+            </Box>\r\n         </Grid>\r\n \r\n         {/* Description Field */}\r\n         <Grid item xs={4}>\r\n-            <Controller\r\n-                name={`records.${index}.description`}\r\n-                control={control}\r\n-                render={({ field: { onChange, value, ...restField } }) => (\r\n-                    <InputField\r\n-                        label=\"Description\"\r\n-                        multiline\r\n-                        rows={3}\r\n-                        placeholder=\"Description\"\r\n-                        {...restField}\r\n-                        value={value || ''}\r\n-                        onChange={(e) => {\r\n-                            onChange(e.target.value);\r\n-                        }}\r\n-                    />\r\n-                )}\r\n-            />\r\n+            <Box>\r\n+                <InputLabel\r\n+                    sx={{\r\n+                        textTransform: \"capitalize\",\r\n+                        textAlign: \"left\",\r\n+                        fontWeight: 700,\r\n+                        fontSize: \"14px\",\r\n+                        color: \"#333\",\r\n+                        marginBottom: 1.5,\r\n+                    }}\r\n+                >\r\n+                    Description :\r\n+                </InputLabel>\r\n+                <Controller\r\n+                    name={`records.${index}.description`}\r\n+                    control={control}\r\n+                    render={({ field }) => (\r\n+                        <TextField\r\n+                            multiline\r\n+                            rows={3}\r\n+                            placeholder=\"Description\"\r\n+                            fullWidth\r\n+                            inputRef={field.ref}\r\n+                            value={field.value || ''}\r\n+                            onChange={field.onChange}\r\n+                            onBlur={field.onBlur}\r\n+                            name={field.name}\r\n+                            sx={{\r\n+                                \"& .MuiOutlinedInput-root\": {\r\n+                                    borderRadius: \"12px\",\r\n+                                    \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                    \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                    \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                },\r\n+                            }}\r\n+                        />\r\n+                    )}\r\n+                />\r\n+            </Box>\r\n         </Grid>\r\n \r\n         {/* Remove Button */}\r\n         <Grid item xs={1}>\r\n"
                },
                {
                    "date": 1743284886379,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -331,9 +331,9 @@\n \r\n             setLoader(false);\r\n         }\r\n     };\r\n-    {console.log(\"Updated Records:\", watch(\"records\"))}\r\n+    { console.log(\"Updated Records:\", watch(\"records\")) }\r\n \r\n     const SendOtp = async (val) => {\r\n         if (val != 'resend') {\r\n             setIsLoading(true)\r\n@@ -1427,158 +1427,158 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                        {fields.map((item, index) => (\r\n-    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                            {fields.map((item, index) => (\r\n+                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n \r\n-        {/* Date Picker */}\r\n-        <Grid item xs={3}>\r\n-            <Box>\r\n-                <InputLabel\r\n-                    sx={{\r\n-                        textTransform: \"capitalize\",\r\n-                        textAlign: \"left\",\r\n-                        fontWeight: 700,\r\n-                        fontSize: \"14px\",\r\n-                        color: \"#333\",\r\n-                        marginBottom: 1.5,\r\n-                    }}\r\n-                >\r\n-                    Date :*\r\n-                </InputLabel>\r\n+                                    {/* Date Picker */}\r\n+                                    <Grid item xs={3}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Date :*\r\n+                                            </InputLabel>\r\n \r\n-                <Controller\r\n-                    name={`records.${index}.date`}\r\n-                    control={control}\r\n-                    rules={{ required: \"Please select a date\" }}\r\n-                    render={({ field }) => (\r\n-                        <DatePicker\r\n-                            inputRef={field.ref}\r\n-                            value={field.value || null}\r\n-                            onChange={(newValue) => field.onChange(newValue)}\r\n-                            onBlur={field.onBlur}\r\n-                            name={field.name}\r\n-                            slotProps={{\r\n-                                textField: {\r\n-                                    size: \"small\",\r\n-                                    fullWidth: true,\r\n-                                    sx: {\r\n-                                        \"& .MuiOutlinedInput-root\": {\r\n-                                            borderRadius: \"12px\",\r\n-                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                        },\r\n-                                    },\r\n-                                },\r\n-                            }}\r\n-                        />\r\n-                    )}\r\n-                />\r\n-                {errors.records?.[index]?.date && (\r\n-                    <Typography color=\"error\">\r\n-                        {errors.records[index].date.message}\r\n-                    </Typography>\r\n-                )}\r\n-            </Box>\r\n-        </Grid>\r\n+                                            <Controller\r\n+                                                name={`records.${index}.date`}\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        inputRef={field.ref}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n+                                                        onBlur={field.onBlur}\r\n+                                                        name={field.name}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: \"12px\",\r\n+                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.records?.[index]?.date && (\r\n+                                                <Typography color=\"error\">\r\n+                                                    {errors.records[index].date.message}\r\n+                                                </Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n \r\n-        {/* Amount Field */}\r\n-        <Grid item xs={3} mt={2}>\r\n-            <Box>\r\n-                <InputLabel\r\n-                    sx={{\r\n-                        textTransform: \"capitalize\",\r\n-                        textAlign: \"left\",\r\n-                        fontWeight: 700,\r\n-                        fontSize: \"14px\",\r\n-                        color: \"#333\",\r\n-                        marginBottom: 1.5,\r\n-                    }}\r\n-                >\r\n-                    Amount :\r\n-                </InputLabel>\r\n-                <Controller\r\n-                    name={`records.${index}.amount`}\r\n-                    control={control}\r\n-                    render={({ field }) => (\r\n-                        <TextField\r\n-                            placeholder=\"Order Amount\"\r\n-                            size=\"small\"\r\n-                            fullWidth\r\n-                            inputRef={field.ref}\r\n-                            value={field.value || ''}\r\n-                            onChange={field.onChange}\r\n-                            onBlur={field.onBlur}\r\n-                            name={field.name}\r\n-                            sx={{\r\n-                                \"& .MuiOutlinedInput-root\": {\r\n-                                    borderRadius: \"12px\",\r\n-                                    \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                    \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                    \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                },\r\n-                            }}\r\n-                        />\r\n-                    )}\r\n-                />\r\n-            </Box>\r\n-        </Grid>\r\n+                                    {/* Amount Field */}\r\n+                                    <Grid item xs={3} mt={2}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Amount :\r\n+                                            </InputLabel>\r\n+                                            <Controller\r\n+                                                name={`records.${index}.amount`}\r\n+                                                control={control}\r\n+                                                render={({ field }) => (\r\n+                                                    <TextField\r\n+                                                        placeholder=\"Order Amount\"\r\n+                                                        size=\"small\"\r\n+                                                        fullWidth\r\n+                                                        inputRef={field.ref}\r\n+                                                        value={field.value || ''}\r\n+                                                        onChange={field.onChange}\r\n+                                                        onBlur={field.onBlur}\r\n+                                                        name={field.name}\r\n+                                                        sx={{\r\n+                                                            \"& .MuiOutlinedInput-root\": {\r\n+                                                                borderRadius: \"12px\",\r\n+                                                                \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                        </Box>\r\n+                                    </Grid>\r\n \r\n-        {/* Description Field */}\r\n-        <Grid item xs={4}>\r\n-            <Box>\r\n-                <InputLabel\r\n-                    sx={{\r\n-                        textTransform: \"capitalize\",\r\n-                        textAlign: \"left\",\r\n-                        fontWeight: 700,\r\n-                        fontSize: \"14px\",\r\n-                        color: \"#333\",\r\n-                        marginBottom: 1.5,\r\n-                    }}\r\n-                >\r\n-                    Description :\r\n-                </InputLabel>\r\n-                <Controller\r\n-                    name={`records.${index}.description`}\r\n-                    control={control}\r\n-                    render={({ field }) => (\r\n-                        <TextField\r\n-                            multiline\r\n-                            rows={3}\r\n-                            placeholder=\"Description\"\r\n-                            fullWidth\r\n-                            inputRef={field.ref}\r\n-                            value={field.value || ''}\r\n-                            onChange={field.onChange}\r\n-                            onBlur={field.onBlur}\r\n-                            name={field.name}\r\n-                            sx={{\r\n-                                \"& .MuiOutlinedInput-root\": {\r\n-                                    borderRadius: \"12px\",\r\n-                                    \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                    \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                    \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                },\r\n-                            }}\r\n-                        />\r\n-                    )}\r\n-                />\r\n-            </Box>\r\n-        </Grid>\r\n+                                    {/* Description Field */}\r\n+                                    <Grid item xs={4}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Description :\r\n+                                            </InputLabel>\r\n+                                            <Controller\r\n+                                                name={`records.${index}.description`}\r\n+                                                control={control}\r\n+                                                render={({ field }) => (\r\n+                                                    <TextField\r\n+                                                        multiline\r\n+                                                        rows={3}\r\n+                                                        placeholder=\"Description\"\r\n+                                                        fullWidth\r\n+                                                        inputRef={field.ref}\r\n+                                                        value={field.value || ''}\r\n+                                                        onChange={field.onChange}\r\n+                                                        onBlur={field.onBlur}\r\n+                                                        name={field.name}\r\n+                                                        sx={{\r\n+                                                            \"& .MuiOutlinedInput-root\": {\r\n+                                                                borderRadius: \"12px\",\r\n+                                                                \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                        </Box>\r\n+                                    </Grid>\r\n \r\n-        {/* Remove Button */}\r\n-        <Grid item xs={1}>\r\n-            {index > 0 && (\r\n-                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                    <DeleteIcon />\r\n-                </IconButton>\r\n-            )}\r\n-        </Grid>\r\n-    </Grid>\r\n-))}\r\n+                                    {/* Remove Button */}\r\n+                                    <Grid item xs={1}>\r\n+                                        {index > 0 && (\r\n+                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                                                <DeleteIcon />\r\n+                                            </IconButton>\r\n+                                        )}\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            ))}\r\n \r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743285134719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,162 +1427,236 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                            {fields.map((item, index) => (\r\n-                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                        import React from 'react';\r\n+import { useForm, useFieldArray, Controller } from 'react-hook-form';\r\n+import { \r\n+  Grid, Box, InputLabel, IconButton, Typography, TextField, Button \r\n+} from '@mui/material';\r\n+import { DatePicker } from '@mui/x-date-pickers';\r\n+import DeleteIcon from '@mui/icons-material/Delete';\r\n+import AddIcon from '@mui/icons-material/Add';\r\n \r\n-                                    {/* Date Picker */}\r\n-                                    <Grid item xs={3}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Date :*\r\n-                                            </InputLabel>\r\n+// Your main component\r\n+function RecordsForm() {\r\n+  // Initialize form with proper defaultValues\r\n+  const { \r\n+    control, \r\n+    handleSubmit, \r\n+    formState: { errors }, \r\n+    watch \r\n+  } = useForm({\r\n+    defaultValues: {\r\n+      records: [{ date: null, amount: '', description: '' }]\r\n+    }\r\n+  });\r\n \r\n-                                            <Controller\r\n-                                                name={`records.${index}.date`}\r\n-                                                control={control}\r\n-                                                rules={{ required: \"Please select a date\" }}\r\n-                                                render={({ field }) => (\r\n-                                                    <DatePicker\r\n-                                                        inputRef={field.ref}\r\n-                                                        value={field.value || null}\r\n-                                                        onChange={(newValue) => field.onChange(newValue)}\r\n-                                                        onBlur={field.onBlur}\r\n-                                                        name={field.name}\r\n-                                                        slotProps={{\r\n-                                                            textField: {\r\n-                                                                size: \"small\",\r\n-                                                                fullWidth: true,\r\n-                                                                sx: {\r\n-                                                                    \"& .MuiOutlinedInput-root\": {\r\n-                                                                        borderRadius: \"12px\",\r\n-                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                                    },\r\n-                                                                },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                            {errors.records?.[index]?.date && (\r\n-                                                <Typography color=\"error\">\r\n-                                                    {errors.records[index].date.message}\r\n-                                                </Typography>\r\n-                                            )}\r\n-                                        </Box>\r\n-                                    </Grid>\r\n+  // Set up useFieldArray with proper configuration\r\n+  const { fields, append, remove } = useFieldArray({\r\n+    control,\r\n+    name: \"records\",\r\n+    // This ensures React properly tracks field updates\r\n+    keyName: \"fieldId\" // Use a custom key name to avoid conflicts with item.id\r\n+  });\r\n \r\n-                                    {/* Amount Field */}\r\n-                                    <Grid item xs={3} mt={2}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Amount :\r\n-                                            </InputLabel>\r\n-                                            <Controller\r\n-                                                name={`records.${index}.amount`}\r\n-                                                control={control}\r\n-                                                render={({ field }) => (\r\n-                                                    <TextField\r\n-                                                        placeholder=\"Order Amount\"\r\n-                                                        size=\"small\"\r\n-                                                        fullWidth\r\n-                                                        inputRef={field.ref}\r\n-                                                        value={field.value || ''}\r\n-                                                        onChange={field.onChange}\r\n-                                                        onBlur={field.onBlur}\r\n-                                                        name={field.name}\r\n-                                                        sx={{\r\n-                                                            \"& .MuiOutlinedInput-root\": {\r\n-                                                                borderRadius: \"12px\",\r\n-                                                                \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                        </Box>\r\n-                                    </Grid>\r\n+  // Function to add a new record\r\n+  const addNewRecord = () => {\r\n+    append({ date: null, amount: '', description: '' });\r\n+  };\r\n \r\n-                                    {/* Description Field */}\r\n-                                    <Grid item xs={4}>\r\n-                                        <Box>\r\n-                                            <InputLabel\r\n-                                                sx={{\r\n-                                                    textTransform: \"capitalize\",\r\n-                                                    textAlign: \"left\",\r\n-                                                    fontWeight: 700,\r\n-                                                    fontSize: \"14px\",\r\n-                                                    color: \"#333\",\r\n-                                                    marginBottom: 1.5,\r\n-                                                }}\r\n-                                            >\r\n-                                                Description :\r\n-                                            </InputLabel>\r\n-                                            <Controller\r\n-                                                name={`records.${index}.description`}\r\n-                                                control={control}\r\n-                                                render={({ field }) => (\r\n-                                                    <TextField\r\n-                                                        multiline\r\n-                                                        rows={3}\r\n-                                                        placeholder=\"Description\"\r\n-                                                        fullWidth\r\n-                                                        inputRef={field.ref}\r\n-                                                        value={field.value || ''}\r\n-                                                        onChange={field.onChange}\r\n-                                                        onBlur={field.onBlur}\r\n-                                                        name={field.name}\r\n-                                                        sx={{\r\n-                                                            \"& .MuiOutlinedInput-root\": {\r\n-                                                                borderRadius: \"12px\",\r\n-                                                                \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                                                \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                                                \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                                            },\r\n-                                                        }}\r\n-                                                    />\r\n-                                                )}\r\n-                                            />\r\n-                                        </Box>\r\n-                                    </Grid>\r\n+  // For debugging - log form values on change\r\n+  console.log(\"Current form values:\", watch(\"records\"));\r\n \r\n-                                    {/* Remove Button */}\r\n-                                    <Grid item xs={1}>\r\n-                                        {index > 0 && (\r\n-                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                                                <DeleteIcon />\r\n-                                            </IconButton>\r\n-                                        )}\r\n-                                    </Grid>\r\n-                                </Grid>\r\n-                            ))}\r\n+  // Form submission handler\r\n+  const onSubmit = (data) => {\r\n+    console.log(\"Form submitted with data:\", data);\r\n+  };\r\n \r\n+  return (\r\n+    <form onSubmit={handleSubmit(onSubmit)}>\r\n+      {fields.map((item, index) => (\r\n+        <Grid container spacing={2} p={2} alignItems=\"center\" key={item.fieldId} mt={2}>\r\n+          {/* Date Picker */}\r\n+          <Grid item xs={3}>\r\n+            <Box>\r\n+              <InputLabel\r\n+                sx={{\r\n+                  textTransform: \"capitalize\",\r\n+                  textAlign: \"left\",\r\n+                  fontWeight: 700,\r\n+                  fontSize: \"14px\",\r\n+                  color: \"#333\",\r\n+                  marginBottom: 1.5,\r\n+                }}\r\n+              >\r\n+                Date :*\r\n+              </InputLabel>\r\n \r\n+              <Controller\r\n+                name={`records.${index}.date`}\r\n+                control={control}\r\n+                rules={{ required: \"Please select a date\" }}\r\n+                render={({ field }) => (\r\n+                  <DatePicker\r\n+                    inputRef={field.ref}\r\n+                    value={field.value || null}\r\n+                    onChange={(newValue) => field.onChange(newValue)}\r\n+                    onBlur={field.onBlur}\r\n+                    name={field.name}\r\n+                    slotProps={{\r\n+                      textField: {\r\n+                        size: \"small\",\r\n+                        fullWidth: true,\r\n+                        sx: {\r\n+                          \"& .MuiOutlinedInput-root\": {\r\n+                            borderRadius: \"12px\",\r\n+                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                          },\r\n+                        },\r\n+                      },\r\n+                    }}\r\n+                  />\r\n+                )}\r\n+              />\r\n+              {errors.records?.[index]?.date && (\r\n+                <Typography color=\"error\">\r\n+                  {errors.records[index].date.message}\r\n+                </Typography>\r\n+              )}\r\n+            </Box>\r\n+          </Grid>\r\n \r\n+          {/* Amount Field */}\r\n+          <Grid item xs={3} mt={2}>\r\n+            <Box>\r\n+              <InputLabel\r\n+                sx={{\r\n+                  textTransform: \"capitalize\",\r\n+                  textAlign: \"left\",\r\n+                  fontWeight: 700,\r\n+                  fontSize: \"14px\",\r\n+                  color: \"#333\",\r\n+                  marginBottom: 1.5,\r\n+                }}\r\n+              >\r\n+                Amount :\r\n+              </InputLabel>\r\n+              <Controller\r\n+                name={`records.${index}.amount`}\r\n+                control={control}\r\n+                render={({ field }) => (\r\n+                  <TextField\r\n+                    placeholder=\"Order Amount\"\r\n+                    size=\"small\"\r\n+                    fullWidth\r\n+                    inputRef={field.ref}\r\n+                    value={field.value || ''}\r\n+                    onChange={field.onChange}\r\n+                    onBlur={field.onBlur}\r\n+                    name={field.name}\r\n+                    sx={{\r\n+                      \"& .MuiOutlinedInput-root\": {\r\n+                        borderRadius: \"12px\",\r\n+                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                      },\r\n+                    }}\r\n+                  />\r\n+                )}\r\n+              />\r\n+            </Box>\r\n+          </Grid>\r\n \r\n+          {/* Description Field */}\r\n+          <Grid item xs={4}>\r\n+            <Box>\r\n+              <InputLabel\r\n+                sx={{\r\n+                  textTransform: \"capitalize\",\r\n+                  textAlign: \"left\",\r\n+                  fontWeight: 700,\r\n+                  fontSize: \"14px\",\r\n+                  color: \"#333\",\r\n+                  marginBottom: 1.5,\r\n+                }}\r\n+              >\r\n+                Description :\r\n+              </InputLabel>\r\n+              <Controller\r\n+                name={`records.${index}.description`}\r\n+                control={control}\r\n+                render={({ field }) => (\r\n+                  <TextField\r\n+                    multiline\r\n+                    rows={3}\r\n+                    placeholder=\"Description\"\r\n+                    fullWidth\r\n+                    inputRef={field.ref}\r\n+                    value={field.value || ''}\r\n+                    onChange={field.onChange}\r\n+                    onBlur={field.onBlur}\r\n+                    name={field.name}\r\n+                    sx={{\r\n+                      \"& .MuiOutlinedInput-root\": {\r\n+                        borderRadius: \"12px\",\r\n+                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                      },\r\n+                    }}\r\n+                  />\r\n+                )}\r\n+              />\r\n+            </Box>\r\n+          </Grid>\r\n+\r\n+          {/* Remove Button */}\r\n+          <Grid item xs={1}>\r\n+            {index > 0 && (\r\n+              <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                <DeleteIcon />\r\n+              </IconButton>\r\n+            )}\r\n+          </Grid>\r\n+        </Grid>\r\n+      ))}\r\n+\r\n+      {/* Add Button */}\r\n+      <Grid container justifyContent=\"center\" mt={2}>\r\n+        <Button \r\n+          variant=\"contained\" \r\n+          startIcon={<AddIcon />} \r\n+          onClick={addNewRecord}\r\n+          sx={{ borderRadius: '12px' }}\r\n+        >\r\n+          Add Record\r\n+        </Button>\r\n+      </Grid>\r\n+\r\n+      {/* Submit Button */}\r\n+      <Grid container justifyContent=\"flex-end\" mt={4}>\r\n+        <Button \r\n+          type=\"submit\" \r\n+          variant=\"contained\" \r\n+          color=\"primary\"\r\n+          sx={{ borderRadius: '12px' }}\r\n+        >\r\n+          Submit\r\n+        </Button>\r\n+      </Grid>\r\n+    </form>\r\n+  );\r\n+}\r\n+\r\n+export default RecordsForm;\r\n+\r\n+\r\n+\r\n+\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743285169254,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,55 +1427,9 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                        import React from 'react';\r\n-import { useForm, useFieldArray, Controller } from 'react-hook-form';\r\n-import { \r\n-  Grid, Box, InputLabel, IconButton, Typography, TextField, Button \r\n-} from '@mui/material';\r\n-import { DatePicker } from '@mui/x-date-pickers';\r\n-import DeleteIcon from '@mui/icons-material/Delete';\r\n-import AddIcon from '@mui/icons-material/Add';\r\n-\r\n-// Your main component\r\n-function RecordsForm() {\r\n-  // Initialize form with proper defaultValues\r\n-  const { \r\n-    control, \r\n-    handleSubmit, \r\n-    formState: { errors }, \r\n-    watch \r\n-  } = useForm({\r\n-    defaultValues: {\r\n-      records: [{ date: null, amount: '', description: '' }]\r\n-    }\r\n-  });\r\n-\r\n-  // Set up useFieldArray with proper configuration\r\n-  const { fields, append, remove } = useFieldArray({\r\n-    control,\r\n-    name: \"records\",\r\n-    // This ensures React properly tracks field updates\r\n-    keyName: \"fieldId\" // Use a custom key name to avoid conflicts with item.id\r\n-  });\r\n-\r\n-  // Function to add a new record\r\n-  const addNewRecord = () => {\r\n-    append({ date: null, amount: '', description: '' });\r\n-  };\r\n-\r\n-  // For debugging - log form values on change\r\n-  console.log(\"Current form values:\", watch(\"records\"));\r\n-\r\n-  // Form submission handler\r\n-  const onSubmit = (data) => {\r\n-    console.log(\"Form submitted with data:\", data);\r\n-  };\r\n-\r\n-  return (\r\n-    <form onSubmit={handleSubmit(onSubmit)}>\r\n-      {fields.map((item, index) => (\r\n+                        {fields.map((item, index) => (\r\n         <Grid container spacing={2} p={2} alignItems=\"center\" key={item.fieldId} mt={2}>\r\n           {/* Date Picker */}\r\n           <Grid item xs={3}>\r\n             <Box>\r\n@@ -1623,40 +1577,11 @@\n           </Grid>\r\n         </Grid>\r\n       ))}\r\n \r\n-      {/* Add Button */}\r\n-      <Grid container justifyContent=\"center\" mt={2}>\r\n-        <Button \r\n-          variant=\"contained\" \r\n-          startIcon={<AddIcon />} \r\n-          onClick={addNewRecord}\r\n-          sx={{ borderRadius: '12px' }}\r\n-        >\r\n-          Add Record\r\n-        </Button>\r\n-      </Grid>\r\n \r\n-      {/* Submit Button */}\r\n-      <Grid container justifyContent=\"flex-end\" mt={4}>\r\n-        <Button \r\n-          type=\"submit\" \r\n-          variant=\"contained\" \r\n-          color=\"primary\"\r\n-          sx={{ borderRadius: '12px' }}\r\n-        >\r\n-          Submit\r\n-        </Button>\r\n-      </Grid>\r\n-    </form>\r\n-  );\r\n-}\r\n \r\n-export default RecordsForm;\r\n \r\n-\r\n-\r\n-\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743285257205,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -331,9 +331,9 @@\n \r\n             setLoader(false);\r\n         }\r\n     };\r\n-    { console.log(\"Updated Records:\", watch(\"records\")) }\r\n+    console.log(watch());\r\n \r\n     const SendOtp = async (val) => {\r\n         if (val != 'resend') {\r\n             setIsLoading(true)\r\n@@ -1427,161 +1427,117 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-                        {fields.map((item, index) => (\r\n-        <Grid container spacing={2} p={2} alignItems=\"center\" key={item.fieldId} mt={2}>\r\n-          {/* Date Picker */}\r\n-          <Grid item xs={3}>\r\n+       {fields.map((item, index) => (\r\n+    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+        {/* Patient Date Selection */}\r\n+        <Grid item xs={3}>\r\n             <Box>\r\n-              <InputLabel\r\n-                sx={{\r\n-                  textTransform: \"capitalize\",\r\n-                  textAlign: \"left\",\r\n-                  fontWeight: 700,\r\n-                  fontSize: \"14px\",\r\n-                  color: \"#333\",\r\n-                  marginBottom: 1.5,\r\n-                }}\r\n-              >\r\n-                Date :*\r\n-              </InputLabel>\r\n+                <InputLabel\r\n+                    sx={{\r\n+                        textTransform: \"capitalize\",\r\n+                        textAlign: \"left\",\r\n+                        fontWeight: 700,\r\n+                        fontSize: \"14px\",\r\n+                        color: \"#333\",\r\n+                        marginBottom: 1.5,\r\n+                    }}\r\n+                >\r\n+                    Date :*\r\n+                </InputLabel>\r\n \r\n-              <Controller\r\n-                name={`records.${index}.date`}\r\n-                control={control}\r\n-                rules={{ required: \"Please select a date\" }}\r\n-                render={({ field }) => (\r\n-                  <DatePicker\r\n-                    inputRef={field.ref}\r\n-                    value={field.value || null}\r\n-                    onChange={(newValue) => field.onChange(newValue)}\r\n-                    onBlur={field.onBlur}\r\n-                    name={field.name}\r\n-                    slotProps={{\r\n-                      textField: {\r\n-                        size: \"small\",\r\n-                        fullWidth: true,\r\n-                        sx: {\r\n-                          \"& .MuiOutlinedInput-root\": {\r\n-                            borderRadius: \"12px\",\r\n-                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                          },\r\n-                        },\r\n-                      },\r\n-                    }}\r\n-                  />\r\n+                <Controller\r\n+                    name={`records.${index}.date`}\r\n+                    control={control}\r\n+                    rules={{ required: \"Please select a date\" }}\r\n+                    render={({ field }) => (\r\n+                        <DatePicker\r\n+                            {...field}\r\n+                            value={field.value || null}\r\n+                            onChange={(newValue) => {\r\n+                                field.onChange(newValue);\r\n+                                setValue(`records.${index}.date`, newValue);\r\n+                            }}\r\n+                            slotProps={{\r\n+                                textField: {\r\n+                                    size: \"small\",\r\n+                                    fullWidth: true,\r\n+                                    sx: {\r\n+                                        \"& .MuiOutlinedInput-root\": {\r\n+                                            borderRadius: \"12px\",\r\n+                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                        },\r\n+                                    },\r\n+                                },\r\n+                            }}\r\n+                        />\r\n+                    )}\r\n+                />\r\n+                {errors.records?.[index]?.date && (\r\n+                    <Typography color=\"error\">\r\n+                        {errors.records[index].date.message}\r\n+                    </Typography>\r\n                 )}\r\n-              />\r\n-              {errors.records?.[index]?.date && (\r\n-                <Typography color=\"error\">\r\n-                  {errors.records[index].date.message}\r\n-                </Typography>\r\n-              )}\r\n             </Box>\r\n-          </Grid>\r\n+        </Grid>\r\n \r\n-          {/* Amount Field */}\r\n-          <Grid item xs={3} mt={2}>\r\n-            <Box>\r\n-              <InputLabel\r\n-                sx={{\r\n-                  textTransform: \"capitalize\",\r\n-                  textAlign: \"left\",\r\n-                  fontWeight: 700,\r\n-                  fontSize: \"14px\",\r\n-                  color: \"#333\",\r\n-                  marginBottom: 1.5,\r\n-                }}\r\n-              >\r\n-                Amount :\r\n-              </InputLabel>\r\n-              <Controller\r\n+        {/* Amount Field */}\r\n+        <Grid item xs={3} mt={2}>\r\n+            <Controller\r\n                 name={`records.${index}.amount`}\r\n                 control={control}\r\n                 render={({ field }) => (\r\n-                  <TextField\r\n-                    placeholder=\"Order Amount\"\r\n-                    size=\"small\"\r\n-                    fullWidth\r\n-                    inputRef={field.ref}\r\n-                    value={field.value || ''}\r\n-                    onChange={field.onChange}\r\n-                    onBlur={field.onBlur}\r\n-                    name={field.name}\r\n-                    sx={{\r\n-                      \"& .MuiOutlinedInput-root\": {\r\n-                        borderRadius: \"12px\",\r\n-                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                      },\r\n-                    }}\r\n-                  />\r\n+                    <InputField\r\n+                        label=\"Amount\"\r\n+                        placeholder=\"Order Amount\"\r\n+                        size=\"small\"\r\n+                        {...field}\r\n+                        onChange={(e) => {\r\n+                            field.onChange(e);\r\n+                            setValue(`records.${index}.amount`, e.target.value);\r\n+                        }}\r\n+                    />\r\n                 )}\r\n-              />\r\n-            </Box>\r\n-          </Grid>\r\n+            />\r\n+        </Grid>\r\n \r\n-          {/* Description Field */}\r\n-          <Grid item xs={4}>\r\n-            <Box>\r\n-              <InputLabel\r\n-                sx={{\r\n-                  textTransform: \"capitalize\",\r\n-                  textAlign: \"left\",\r\n-                  fontWeight: 700,\r\n-                  fontSize: \"14px\",\r\n-                  color: \"#333\",\r\n-                  marginBottom: 1.5,\r\n-                }}\r\n-              >\r\n-                Description :\r\n-              </InputLabel>\r\n-              <Controller\r\n+        {/* Description Field */}\r\n+        <Grid item xs={4}>\r\n+            <Controller\r\n                 name={`records.${index}.description`}\r\n                 control={control}\r\n                 render={({ field }) => (\r\n-                  <TextField\r\n-                    multiline\r\n-                    rows={3}\r\n-                    placeholder=\"Description\"\r\n-                    fullWidth\r\n-                    inputRef={field.ref}\r\n-                    value={field.value || ''}\r\n-                    onChange={field.onChange}\r\n-                    onBlur={field.onBlur}\r\n-                    name={field.name}\r\n-                    sx={{\r\n-                      \"& .MuiOutlinedInput-root\": {\r\n-                        borderRadius: \"12px\",\r\n-                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                      },\r\n-                    }}\r\n-                  />\r\n+                    <InputField\r\n+                        label=\"Description\"\r\n+                        multiline\r\n+                        rows={3}\r\n+                        placeholder=\"Description\"\r\n+                        {...field}\r\n+                        onChange={(e) => {\r\n+                            field.onChange(e);\r\n+                            setValue(`records.${index}.description`, e.target.value);\r\n+                        }}\r\n+                    />\r\n                 )}\r\n-              />\r\n-            </Box>\r\n-          </Grid>\r\n+            />\r\n+        </Grid>\r\n \r\n-          {/* Remove Button */}\r\n-          <Grid item xs={1}>\r\n+        {/* Remove Button (only for additional fields) */}\r\n+        <Grid item xs={1}>\r\n             {index > 0 && (\r\n-              <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                <DeleteIcon />\r\n-              </IconButton>\r\n+                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                    <DeleteIcon />\r\n+                </IconButton>\r\n             )}\r\n-          </Grid>\r\n         </Grid>\r\n-      ))}\r\n+    </Grid>\r\n+))}\r\n \r\n \r\n \r\n-\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743285265962,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1427,9 +1427,9 @@\n                         </Grid>\r\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n-       {fields.map((item, index) => (\r\n+                            {fields.map((item, index) => (\r\n     <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n         {/* Patient Date Selection */}\r\n         <Grid item xs={3}>\r\n             <Box>\r\n@@ -1453,12 +1453,9 @@\n                     render={({ field }) => (\r\n                         <DatePicker\r\n                             {...field}\r\n                             value={field.value || null}\r\n-                            onChange={(newValue) => {\r\n-                                field.onChange(newValue);\r\n-                                setValue(`records.${index}.date`, newValue);\r\n-                            }}\r\n+                            onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n                             slotProps={{\r\n                                 textField: {\r\n                                     size: \"small\",\r\n                                     fullWidth: true,\r\n@@ -1484,44 +1481,28 @@\n         </Grid>\r\n \r\n         {/* Amount Field */}\r\n         <Grid item xs={3} mt={2}>\r\n-            <Controller\r\n-                name={`records.${index}.amount`}\r\n-                control={control}\r\n-                render={({ field }) => (\r\n-                    <InputField\r\n-                        label=\"Amount\"\r\n-                        placeholder=\"Order Amount\"\r\n-                        size=\"small\"\r\n-                        {...field}\r\n-                        onChange={(e) => {\r\n-                            field.onChange(e);\r\n-                            setValue(`records.${index}.amount`, e.target.value);\r\n-                        }}\r\n-                    />\r\n-                )}\r\n+            <InputField\r\n+                label=\"Amount\"\r\n+                placeholder=\"Order Amount\"\r\n+                size=\"small\"\r\n+                {...register(`records.${index}.amount`, {\r\n+                    onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n+                })}\r\n             />\r\n         </Grid>\r\n \r\n         {/* Description Field */}\r\n         <Grid item xs={4}>\r\n-            <Controller\r\n-                name={`records.${index}.description`}\r\n-                control={control}\r\n-                render={({ field }) => (\r\n-                    <InputField\r\n-                        label=\"Description\"\r\n-                        multiline\r\n-                        rows={3}\r\n-                        placeholder=\"Description\"\r\n-                        {...field}\r\n-                        onChange={(e) => {\r\n-                            field.onChange(e);\r\n-                            setValue(`records.${index}.description`, e.target.value);\r\n-                        }}\r\n-                    />\r\n-                )}\r\n+            <InputField\r\n+                label=\"Description\"\r\n+                multiline\r\n+                rows={3}\r\n+                placeholder=\"Description\"\r\n+                {...register(`records.${index}.description`, {\r\n+                    onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n+                })}\r\n             />\r\n         </Grid>\r\n \r\n         {/* Remove Button (only for additional fields) */}\r\n@@ -1535,9 +1516,8 @@\n     </Grid>\r\n ))}\r\n \r\n \r\n-\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743285282424,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1428,94 +1428,94 @@\n                         <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                             {fields.map((item, index) => (\r\n-    <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n-        {/* Patient Date Selection */}\r\n-        <Grid item xs={3}>\r\n-            <Box>\r\n-                <InputLabel\r\n-                    sx={{\r\n-                        textTransform: \"capitalize\",\r\n-                        textAlign: \"left\",\r\n-                        fontWeight: 700,\r\n-                        fontSize: \"14px\",\r\n-                        color: \"#333\",\r\n-                        marginBottom: 1.5,\r\n-                    }}\r\n-                >\r\n-                    Date :*\r\n-                </InputLabel>\r\n+                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+                                    {/* Patient Date Selection */}\r\n+                                    <Grid item xs={3}>\r\n+                                        <Box>\r\n+                                            <InputLabel\r\n+                                                sx={{\r\n+                                                    textTransform: \"capitalize\",\r\n+                                                    textAlign: \"left\",\r\n+                                                    fontWeight: 700,\r\n+                                                    fontSize: \"14px\",\r\n+                                                    color: \"#333\",\r\n+                                                    marginBottom: 1.5,\r\n+                                                }}\r\n+                                            >\r\n+                                                Date :*\r\n+                                            </InputLabel>\r\n \r\n-                <Controller\r\n-                    name={`records.${index}.date`}\r\n-                    control={control}\r\n-                    rules={{ required: \"Please select a date\" }}\r\n-                    render={({ field }) => (\r\n-                        <DatePicker\r\n-                            {...field}\r\n-                            value={field.value || null}\r\n-                            onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n-                            slotProps={{\r\n-                                textField: {\r\n-                                    size: \"small\",\r\n-                                    fullWidth: true,\r\n-                                    sx: {\r\n-                                        \"& .MuiOutlinedInput-root\": {\r\n-                                            borderRadius: \"12px\",\r\n-                                            \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n-                                            \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n-                                            \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n-                                        },\r\n-                                    },\r\n-                                },\r\n-                            }}\r\n-                        />\r\n-                    )}\r\n-                />\r\n-                {errors.records?.[index]?.date && (\r\n-                    <Typography color=\"error\">\r\n-                        {errors.records[index].date.message}\r\n-                    </Typography>\r\n-                )}\r\n-            </Box>\r\n-        </Grid>\r\n+                                            <Controller\r\n+                                                name={`records.${index}.date`}\r\n+                                                control={control}\r\n+                                                rules={{ required: \"Please select a date\" }}\r\n+                                                render={({ field }) => (\r\n+                                                    <DatePicker\r\n+                                                        {...field}\r\n+                                                        value={field.value || null}\r\n+                                                        onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n+                                                        slotProps={{\r\n+                                                            textField: {\r\n+                                                                size: \"small\",\r\n+                                                                fullWidth: true,\r\n+                                                                sx: {\r\n+                                                                    \"& .MuiOutlinedInput-root\": {\r\n+                                                                        borderRadius: \"12px\",\r\n+                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n+                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n+                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n+                                                                    },\r\n+                                                                },\r\n+                                                            },\r\n+                                                        }}\r\n+                                                    />\r\n+                                                )}\r\n+                                            />\r\n+                                            {errors.records?.[index]?.date && (\r\n+                                                <Typography color=\"error\">\r\n+                                                    {errors.records[index].date.message}\r\n+                                                </Typography>\r\n+                                            )}\r\n+                                        </Box>\r\n+                                    </Grid>\r\n \r\n-        {/* Amount Field */}\r\n-        <Grid item xs={3} mt={2}>\r\n-            <InputField\r\n-                label=\"Amount\"\r\n-                placeholder=\"Order Amount\"\r\n-                size=\"small\"\r\n-                {...register(`records.${index}.amount`, {\r\n-                    onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n-                })}\r\n-            />\r\n-        </Grid>\r\n+                                    {/* Amount Field */}\r\n+                                    <Grid item xs={3} mt={2}>\r\n+                                        <InputField\r\n+                                            label=\"Amount\"\r\n+                                            placeholder=\"Order Amount\"\r\n+                                            size=\"small\"\r\n+                                            {...register(`records.${index}.amount`, {\r\n+                                                onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n+                                            })}\r\n+                                        />\r\n+                                    </Grid>\r\n \r\n-        {/* Description Field */}\r\n-        <Grid item xs={4}>\r\n-            <InputField\r\n-                label=\"Description\"\r\n-                multiline\r\n-                rows={3}\r\n-                placeholder=\"Description\"\r\n-                {...register(`records.${index}.description`, {\r\n-                    onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n-                })}\r\n-            />\r\n-        </Grid>\r\n+                                    {/* Description Field */}\r\n+                                    <Grid item xs={4}>\r\n+                                        <InputField\r\n+                                            label=\"Description\"\r\n+                                            multiline\r\n+                                            rows={3}\r\n+                                            placeholder=\"Description\"\r\n+                                            {...register(`records.${index}.description`, {\r\n+                                                onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n+                                            })}\r\n+                                        />\r\n+                                    </Grid>\r\n \r\n-        {/* Remove Button (only for additional fields) */}\r\n-        <Grid item xs={1}>\r\n-            {index > 0 && (\r\n-                <IconButton color=\"error\" onClick={() => remove(index)}>\r\n-                    <DeleteIcon />\r\n-                </IconButton>\r\n-            )}\r\n-        </Grid>\r\n-    </Grid>\r\n-))}\r\n+                                    {/* Remove Button (only for additional fields) */}\r\n+                                    <Grid item xs={1}>\r\n+                                        {index > 0 && (\r\n+                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n+                                                <DeleteIcon />\r\n+                                            </IconButton>\r\n+                                        )}\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            ))}\r\n \r\n \r\n                         </LocalizationProvider>\r\n \r\n"
                },
                {
                    "date": 1743286454791,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1429,8 +1429,9 @@\n \r\n                         <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                             {fields.map((item, index) => (\r\n                                 <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n+\r\n                                     {/* Patient Date Selection */}\r\n                                     <Grid item xs={3}>\r\n                                         <Box>\r\n                                             <InputLabel\r\n@@ -1453,9 +1454,9 @@\n                                                 render={({ field }) => (\r\n                                                     <DatePicker\r\n                                                         {...field}\r\n                                                         value={field.value || null}\r\n-                                                        onChange={(newValue) => setValue(`records.${index}.date`, newValue)}\r\n+                                                        onChange={(newValue) => field.onChange(newValue)}\r\n                                                         slotProps={{\r\n                                                             textField: {\r\n                                                                 size: \"small\",\r\n                                                                 fullWidth: true,\r\n@@ -1485,27 +1486,24 @@\n                                         <InputField\r\n                                             label=\"Amount\"\r\n                                             placeholder=\"Order Amount\"\r\n                                             size=\"small\"\r\n-                                            {...register(`records.${index}.amount`, {\r\n-                                                onChange: (e) => setValue(`records.${index}.amount`, e.target.value),\r\n-                                            })}\r\n+                                            {...register(`records.${index}.amount`)}\r\n                                         />\r\n                                     </Grid>\r\n \r\n+\r\n+\r\n                                     {/* Description Field */}\r\n                                     <Grid item xs={4}>\r\n                                         <InputField\r\n                                             label=\"Description\"\r\n                                             multiline\r\n                                             rows={3}\r\n                                             placeholder=\"Description\"\r\n-                                            {...register(`records.${index}.description`, {\r\n-                                                onChange: (e) => setValue(`records.${index}.description`, e.target.value),\r\n-                                            })}\r\n+                                            {...register(`records.${index}.description`)}\r\n                                         />\r\n                                     </Grid>\r\n-\r\n                                     {/* Remove Button (only for additional fields) */}\r\n                                     <Grid item xs={1}>\r\n                                         {index > 0 && (\r\n                                             <IconButton color=\"error\" onClick={() => remove(index)}>\r\n@@ -1514,10 +1512,8 @@\n                                         )}\r\n                                     </Grid>\r\n                                 </Grid>\r\n                             ))}\r\n-\r\n-\r\n                         </LocalizationProvider>\r\n \r\n \r\n \r\n"
                },
                {
                    "date": 1743286465889,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1486,9 +1486,9 @@\n                                         <InputField\r\n                                             label=\"Amount\"\r\n                                             placeholder=\"Order Amount\"\r\n                                             size=\"small\"\r\n-                                            {...register(`records.${index}.amount`)}\r\n+                                            register={register(`records.${index}.amount`)}\r\n                                         />\r\n                                     </Grid>\r\n \r\n \r\n"
                },
                {
                    "date": 1743286473408,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1499,9 +1499,9 @@\n                                             label=\"Description\"\r\n                                             multiline\r\n                                             rows={3}\r\n                                             placeholder=\"Description\"\r\n-                                            {...register(`records.${index}.description`)}\r\n+                                            register= {register(`records.${index}.description`)}\r\n                                         />\r\n                                     </Grid>\r\n                                     {/* Remove Button (only for additional fields) */}\r\n                                     <Grid item xs={1}>\r\n"
                },
                {
                    "date": 1743286506733,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -668,9 +668,9 @@\n             setValue(\"media\", { shouldValidate: true });\r\n             setValue(\"media2\", { shouldValidate: true });\r\n             setValue(\"media3\", { shouldValidate: true });\r\n             setSignature(form?.treatment_plan?.patient_sign)\r\n-            setValue('patientDate', dayjs(form?.treatment_plan?.date))\r\n+            // setValue('patientDate', dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n"
                },
                {
                    "date": 1743286517959,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,10 +673,10 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n-            setValue(\"records\", form?.treatment_record);\r\n-            setValue(\"furtherFields\", form?.further_treatment);\r\n+            // setValue(\"records\", form?.treatment_record);\r\n+            // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n             setAfterImages(form?.after_images)\r\n"
                },
                {
                    "date": 1743286598999,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,8 +673,15 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n+            let data=  \r\n+                data?.data?.patients?.map((doc) => ({\r\n+                    ...doc,\r\n+                    id: doc?._id, // Example transformation\r\n+                    name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n+                }))\r\n+            \r\n             // setValue(\"records\", form?.treatment_record);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n"
                },
                {
                    "date": 1743286606038,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,15 +673,14 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n-            let data=  \r\n-                data?.data?.patients?.map((doc) => ({\r\n+            let data =data?.data?.patients?.map((doc) => ({\r\n                     ...doc,\r\n                     id: doc?._id, // Example transformation\r\n                     name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n                 }))\r\n-            \r\n+\r\n             // setValue(\"records\", form?.treatment_record);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n@@ -1506,9 +1505,9 @@\n                                             label=\"Description\"\r\n                                             multiline\r\n                                             rows={3}\r\n                                             placeholder=\"Description\"\r\n-                                            register= {register(`records.${index}.description`)}\r\n+                                            register={register(`records.${index}.description`)}\r\n                                         />\r\n                                     </Grid>\r\n                                     {/* Remove Button (only for additional fields) */}\r\n                                     <Grid item xs={1}>\r\n"
                },
                {
                    "date": 1743286618433,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,13 +673,13 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n-            let data =data?.data?.patients?.map((doc) => ({\r\n+            let recordData =data?.data?.patients?.map((doc) => ({\r\n                     ...doc,\r\n                     id: doc?._id, // Example transformation\r\n                     name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n-                }))\r\n+                })\r\n \r\n             // setValue(\"records\", form?.treatment_record);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n"
                },
                {
                    "date": 1743286627773,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -677,9 +677,9 @@\n             let recordData =data?.data?.patients?.map((doc) => ({\r\n                     ...doc,\r\n                     id: doc?._id, // Example transformation\r\n                     name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n-                })\r\n+                }))\r\n \r\n             // setValue(\"records\", form?.treatment_record);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n"
                },
                {
                    "date": 1743286634662,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,9 +673,9 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n-            let recordData =data?.data?.patients?.map((doc) => ({\r\n+            let recordData =data?.data?.treatment_record?.map((doc) => ({\r\n                     ...doc,\r\n                     id: doc?._id, // Example transformation\r\n                     name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n                 }))\r\n"
                },
                {
                    "date": 1743286639898,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,9 +673,9 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n-            let recordData =data?.data?.treatment_record?.map((doc) => ({\r\n+            let recordData =form?.treatment_record?.map((doc) => ({\r\n                     ...doc,\r\n                     id: doc?._id, // Example transformation\r\n                     name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n                 }))\r\n"
                },
                {
                    "date": 1743286649893,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -675,9 +675,9 @@\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n             let recordData =form?.treatment_record?.map((doc) => ({\r\n                     ...doc,\r\n-                    id: doc?._id, // Example transformation\r\n+                    \r\n                     name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n                 }))\r\n \r\n             // setValue(\"records\", form?.treatment_record);\r\n"
                },
                {
                    "date": 1743286678622,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -676,9 +676,9 @@\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n             let recordData =form?.treatment_record?.map((doc) => ({\r\n                     ...doc,\r\n                     \r\n-                    name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n+                    date: dayjs(doc?.date)\r\n                 }))\r\n \r\n             // setValue(\"records\", form?.treatment_record);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n"
                },
                {
                    "date": 1743286686060,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -679,9 +679,9 @@\n                     \r\n                     date: dayjs(doc?.date)\r\n                 }))\r\n \r\n-            // setValue(\"records\", form?.treatment_record);\r\n+            setValue(\"records\", recordData);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n"
                },
                {
                    "date": 1743286716946,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -673,14 +673,18 @@\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n-            let recordData =form?.treatment_record?.map((doc) => ({\r\n-                    ...doc,\r\n-                    \r\n-                    date: dayjs(doc?.date)\r\n-                }))\r\n+            let recordData = form?.treatment_record?.map((doc) => ({\r\n+                ...doc,\r\n \r\n+                date: dayjs(doc?.date)\r\n+            }))\r\n+            let furtherData = form?.treatment_record?.map((doc) => ({\r\n+                ...doc,\r\n+\r\n+                date: dayjs(doc?.date)\r\n+            }))\r\n             setValue(\"records\", recordData);\r\n             // setValue(\"furtherFields\", form?.further_treatment);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n"
                },
                {
                    "date": 1743286722365,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -678,9 +678,9 @@\n                 ...doc,\r\n \r\n                 date: dayjs(doc?.date)\r\n             }))\r\n-            let furtherData = form?.treatment_record?.map((doc) => ({\r\n+            let furtherData = form?.further_treatment?.map((doc) => ({\r\n                 ...doc,\r\n \r\n                 date: dayjs(doc?.date)\r\n             }))\r\n"
                },
                {
                    "date": 1743286730575,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -684,9 +684,10 @@\n \r\n                 date: dayjs(doc?.date)\r\n             }))\r\n             setValue(\"records\", recordData);\r\n-            // setValue(\"furtherFields\", form?.further_treatment);\r\n+            setValue(\"furtherFields\", form?.            let furtherData = form?.further_treatment?.map((doc) => ({\r\n+            );\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n             setAfterImages(form?.after_images)\r\n"
                },
                {
                    "date": 1743286738307,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -684,10 +684,9 @@\n \r\n                 date: dayjs(doc?.date)\r\n             }))\r\n             setValue(\"records\", recordData);\r\n-            setValue(\"furtherFields\", form?.            let furtherData = form?.further_treatment?.map((doc) => ({\r\n-            );\r\n+            setValue(\"furtherFields\", furtherData);\r\n             setValue(\"extranotes\", form?.extra_notes);\r\n             setUploadedImages(form?.batch_images)\r\n             setBeforeImages(form?.before_images)\r\n             setAfterImages(form?.after_images)\r\n"
                },
                {
                    "date": 1743286926115,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -291,10 +291,10 @@\n                 },\r\n                 batch_images: uploadedImages,\r\n                 before_images: beforeImages,\r\n                 after_images: afterImages,\r\n-                further_treatment: furtherFields,\r\n-                treatment_record: fields,\r\n+                further_treatment: formData?.furtherFields,\r\n+                treatment_record: formData?.fields,\r\n                 extra_notes: getValues('extranotes'),\r\n                 permission_marketing: permissions?.marketing,\r\n                 offers: permissions?.offers,\r\n \r\n@@ -668,9 +668,9 @@\n             setValue(\"media\", { shouldValidate: true });\r\n             setValue(\"media2\", { shouldValidate: true });\r\n             setValue(\"media3\", { shouldValidate: true });\r\n             setSignature(form?.treatment_plan?.patient_sign)\r\n-            // setValue('patientDate', dayjs(form?.treatment_plan?.date))\r\n+            setValue('patientDate', dayjs(form?.treatment_plan?.date))\r\n             setValue('patientConcerns', form?.treatment_plan?.patient_concerns)\r\n             setValue('patientGoal', form?.treatment_plan?.patient_goals)\r\n             setValue('advisedPlan', form?.treatment_plan?.advised_plan)\r\n             setValue('expectedResult', form?.treatment_plan?.expected_result)\r\n"
                },
                {
                    "date": 1743286957406,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -292,9 +292,9 @@\n                 batch_images: uploadedImages,\r\n                 before_images: beforeImages,\r\n                 after_images: afterImages,\r\n                 further_treatment: formData?.furtherFields,\r\n-                treatment_record: formData?.fields,\r\n+                treatment_record: formData?.records,\r\n                 extra_notes: getValues('extranotes'),\r\n                 permission_marketing: permissions?.marketing,\r\n                 offers: permissions?.offers,\r\n \r\n"
                },
                {
                    "date": 1743287026067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -301,29 +301,29 @@\n \r\n             };\r\n             console.log(obj);\r\n \r\n-            // const promise = ApiServices.UpdateForm(obj);\r\n+            const promise = ApiServices.UpdateForm(obj);\r\n \r\n-            // // Handle the API response properly\r\n-            // const response = await promise;\r\n-            // console.log(response);\r\n+            // Handle the API response properly\r\n+            const response = await promise;\r\n+            console.log(response);\r\n \r\n-            // showPromiseToast(\r\n-            //     promise,\r\n-            //     \"Saving...\",\r\n-            //     \"Added Successfully\",\r\n-            //     \"Something Went Wrong\"\r\n-            // );\r\n+            showPromiseToast(\r\n+                promise,\r\n+                \"Saving...\",\r\n+                \"Added Successfully\",\r\n+                \"Something Went Wrong\"\r\n+            );\r\n \r\n-            // Navigate if response is successful\r\n-            // if (response?.responseCode === 200) {\r\n-            //     console.log(response);\r\n-            //     setImageURL(null)\r\n-            //     // navigate('/consent-forms')\r\n+            Navigate if response is successful\r\n+            if (response?.responseCode === 200) {\r\n+                console.log(response);\r\n+                setImageURL(null)\r\n+                // navigate('/consent-forms')\r\n \r\n \r\n-            // }\r\n+            }\r\n \r\n         } catch (error) {\r\n             console.log(error);\r\n             showErrorToast(error)\r\n"
                },
                {
                    "date": 1743287034393,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -314,13 +314,13 @@\n                 \"Added Successfully\",\r\n                 \"Something Went Wrong\"\r\n             );\r\n \r\n-            Navigate if response is successful\r\n+           \r\n             if (response?.responseCode === 200) {\r\n                 console.log(response);\r\n                 setImageURL(null)\r\n-                // navigate('/consent-forms')\r\n+                navigate('/consent-forms')\r\n \r\n \r\n             }\r\n \r\n"
                },
                {
                    "date": 1743364014465,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -314,9 +314,9 @@\n                 \"Added Successfully\",\r\n                 \"Something Went Wrong\"\r\n             );\r\n \r\n-           \r\n+\r\n             if (response?.responseCode === 200) {\r\n                 console.log(response);\r\n                 setImageURL(null)\r\n                 navigate('/consent-forms')\r\n@@ -1255,9 +1255,53 @@\n                         /></Grid>\r\n                         <Grid container p={1}>\r\n                             <Divider sx={{ mt: 4, width: '100%' }} />\r\n                         </Grid>\r\n+                        <Typography variant=\"h5\" fontWeight=\"bold\" mb={2} p={2}>\r\n+                            Facial Mapping\r\n+                        </Typography>\r\n                         <Grid container spacing={2} p={2}>\r\n+                            <Grid item xs={6}>\r\n+                                <Typography>Facial Marking:</Typography>\r\n+                                <div style={{ position: \"relative\", width: 300, height: 150 }}>\r\n+                                    <SignatureCanvas\r\n+                                        ref={sigMarkingRef}\r\n+                                        penColor=\"red\"\r\n+                                        canvasProps={{\r\n+                                            width: 300,\r\n+                                            height: 150,\r\n+                                            className: \"sigCanvas\",\r\n+                                            style: { border: \"1px dashed black\", background: `url(${Images.girl}) center/cover no-repeat` },\r\n+                                        }}\r\n+                                    />\r\n+                                </div>\r\n+                                <Grid container spacing={1} mt={1}>\r\n+                                    <Grid item>\r\n+                                        <Button variant=\"contained\" color=\"secondary\" onClick={handleClearMarking} sx={{ textTransform: 'capitalize' }}>\r\n+                                            Clear Marking\r\n+                                        </Button>\r\n+                                    </Grid>\r\n+                                    <Grid item>\r\n+                                        <Button variant=\"contained\" color=\"primary\" onClick={handleSaveMarking} sx={{ textTransform: 'capitalize' }}>\r\n+                                            Save Marking\r\n+                                        </Button>\r\n+                                    </Grid>\r\n+                                </Grid>\r\n+                            </Grid>\r\n+                            {markingLoader ? <Grid item display={'flex'} justifyContent={'flex-start'} alignItems={'center'} xs={6}>\r\n+                                <CircularProgress size={50} />\r\n+                            </Grid> : (\r\n+                                <Grid item xs={6}>\r\n+                                    <Typography>Saved Image:</Typography>\r\n+                                    <img src={savedImage ? savedImage : Images.girl} alt=\"Marked Face\" style={{ width: 300, height: 150, border: \"1px solid black\" }} />\r\n+                                </Grid>\r\n+                            )}\r\n+\r\n+                        </Grid>\r\n+                        <Grid container p={1}>\r\n+                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n+                        </Grid>\r\n+                        <Grid container spacing={2} p={2}>\r\n                             {/* Marketing Permission */}\r\n                             <Grid item xs={6} mt={2}>\r\n                                 <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we have permission to use your images for marketing?</FormLabel>\r\n                                 <FormControl component=\"fieldset\">\r\n"
                },
                {
                    "date": 1743364028829,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,9 +24,9 @@\n import { id } from \"date-fns/locale\";\r\n \r\n \r\n const UpdateConsentForm = () => {\r\n-    \r\n+        const [markingLoader, setMarkingLoader] = useState(false)\r\n     const { id } = useParams()\r\n     const navigate = useNavigate()\r\n     const [userData, setUserData] = useState(null)\r\n     const { register, control, handleSubmit, setValue, getValues, formState: { errors }, reset, watch } = useForm({\r\n"
                }
            ],
            "date": 1743280446260,
            "name": "Commit-0",
            "content": "import { useEffect, useRef, useState } from \"react\";\r\nimport ApiServices from \"../../../services/Apis\";\r\nimport { PrimaryButton } from \"../../../components/buttons\";\r\nimport { Avatar, Box, Button, CircularProgress, Dialog, DialogContent, DialogTitle, Divider, FormControl, FormControlLabel, FormLabel, Grid, IconButton, InputAdornment, InputLabel, Paper, Radio, RadioGroup, TextField, Typography } from \"@mui/material\";\r\nimport InputField from \"../../../components/input\";\r\nimport { Controller, useFieldArray, useForm } from \"react-hook-form\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { showErrorToast, showPromiseToast, showSuccessToast } from \"../../../components/Toaster\";\r\nimport UploadIcon from \"@mui/icons-material/Upload\";\r\nimport OTPInput from \"react-otp-input\";\r\nimport VisibilityIcon from \"@mui/icons-material/Visibility\";\r\nimport VisibilityOffIcon from \"@mui/icons-material/VisibilityOff\";\r\nimport { Visibility, VisibilityOff } from \"@mui/icons-material\";\r\nimport { DatePicker, LocalizationProvider } from \"@mui/x-date-pickers\";\r\nimport { AdapterDayjs } from \"@mui/x-date-pickers/AdapterDayjs\";\r\nimport SelectField from \"../../../components/select\";\r\nimport SignatureCanvas from \"react-signature-canvas\";\r\nimport moment from \"moment\";\r\nimport DeleteIcon from \"@mui/icons-material/Delete\";\r\nimport UploadFileIcon from '@mui/icons-material/UploadFile';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport dayjs from \"dayjs\";\r\n\r\n\r\nconst UpdateConsentForm = () => {\r\n    const navigate = useNavigate()\r\n    const [userData, setUserData] = useState(null)\r\n    const { register, control, handleSubmit, setValue, getValues, formState: { errors }, reset, watch } = useForm({\r\n        defaultValues: {\r\n            records: [{ date: \"\", amount: \"\", description: \"\" }], // Initial field (cannot be removed)\r\n            furtherFields: [{ date: null, sign: \"\" }], // Additional dynamic section\r\n        },\r\n    });\r\n    const { fields: furtherFields, append: appendFurther, remove: removeFurther } = useFieldArray({\r\n        control,\r\n        name: \"furtherFields\",\r\n    });\r\n\r\n    const { fields, append, remove } = useFieldArray({\r\n        control,\r\n        name: \"records\",\r\n    });\r\n\r\n\r\n    const signCanvasRefs = useRef([]);\r\n\r\n    // Clear Signature Function\r\n    const clearSignature = (index) => {\r\n        if (signCanvasRefs.current[index]) {\r\n            signCanvasRefs.current[index].clear();\r\n            setValue(`furtherFields.${index}.sign`, \"\");\r\n        }\r\n    };\r\n    // Function to update signature in the form state\r\n    const updateSignature = async (index) => {\r\n        if (signCanvasRefs.current[index]) {\r\n            const signData = await signCanvasRefs.current[index].toDataURL();\r\n            setValue(`furtherFields.${index}.sign`, signData);\r\n            try {\r\n                const file = signData;\r\n                if (file) {\r\n                    setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n                }\r\n\r\n                let obj = {\r\n                    document: signData,\r\n                    filename: moment().unix() + \"_Sign.png\"\r\n                }\r\n\r\n                const response = await axios.post(\r\n                    'https://cosmetic.theappkit.com/api/system/uploadDoc',\r\n                    obj\r\n                );\r\n\r\n                console.log(response?.data?.data?.path);\r\n\r\n\r\n                setValue(`furtherFields.${index}.sign`, 'https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n\r\n\r\n            } catch (error) {\r\n                console.log(error);\r\n\r\n            }\r\n        }\r\n    };\r\n    const [title, setTitle] = useState(null)\r\n\r\n    const [step, setStep] = useState(1); // 1: OTP, 2: Reset Password\r\n    const [otp, setOtp] = useState(\"\");\r\n    const [otpError, setOtpError] = useState(false);\r\n    const [timer, setTimer] = useState(30);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [open, setOpen] = useState(false)\r\n    const [password, setPassword] = useState(\"\");\r\n    const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n\r\n    const [showPassword2, setShowPassword2] = useState(false);\r\n    const [otpToken, setOtpToken] = useState(null)\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n    const [patientType, setPatientType] = useState(\"existing\");\r\n    const [patients, setPatients] = useState([])\r\n    const [selectedPatient, setSelectedPatient] = useState(null)\r\n    const [documents, setDocuments] = useState([])\r\n    const [selectedDocument, setSelectedDocument] = useState(null)\r\n    const sigCanvas = useRef(null);\r\n    const [signature, setSignature] = useState(null);\r\n    const [uploadedImages, setUploadedImages] = useState([])\r\n    const [imageLoader, setImageLoader] = useState(false)\r\n    const [beforeImages, setBeforeImages] = useState([])\r\n    const [imageLoaderBefore, setImageLoaderBefore] = useState(false)\r\n    const [afterImages, setAfterImages] = useState([])\r\n    const [imageLoaderAfter, setImageLoaderAfter] = useState(false)\r\n\r\n    // Handle Save Signature\r\n    const handleSave = async () => {\r\n        if (sigCanvas.current) {\r\n            const dataURL = await sigCanvas.current.toDataURL();\r\n            setSignature(dataURL);\r\n            try {\r\n                const file = dataURL;\r\n                if (file) {\r\n                    setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n                }\r\n\r\n                let obj = {\r\n                    document: dataURL,\r\n                    filename: moment().unix() + \"_Sign.png\"\r\n                }\r\n\r\n                const response = await axios.post(\r\n                    'https://cosmetic.theappkit.com/api/system/uploadDoc',\r\n                    obj\r\n                );\r\n\r\n                console.log(response?.data?.data?.path);\r\n\r\n                setSignature('https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n\r\n\r\n            } catch (error) {\r\n                console.log(error);\r\n\r\n            }\r\n        }\r\n    };\r\n\r\n    // Handle Clear Signature\r\n    const handleClear = () => {\r\n        if (sigCanvas.current) {\r\n            sigCanvas.current.clear();\r\n            setSignature(null);\r\n        }\r\n    };\r\n    const [permissions, setPermissions] = useState({\r\n        marketing: \"\",\r\n        offers: \"\",\r\n    });\r\n\r\n    const handleChange2 = (event) => {\r\n        setPermissions({\r\n            ...permissions,\r\n            [event.target.name]: event.target.value,\r\n        });\r\n    };\r\n    const handleChange = (event) => {\r\n        setPatientType(event.target.value);\r\n    };\r\n    const {\r\n        register: register4,\r\n        handleSubmit: handleSubmit4,\r\n        setValue: setValue4,\r\n        getValues: getValues4,\r\n        reset: reset4,\r\n        formState: { errors: errors4 },\r\n    } = useForm();\r\n\r\n    // Simulate OTP Submission\r\n    const handleOtpSubmit = () => {\r\n        if (otp.length !== 4) {\r\n            setOtpError(true);\r\n            return;\r\n        }\r\n        setIsLoading(true);\r\n        setTimeout(() => {\r\n            setIsLoading(false);\r\n            SubmitOTP()\r\n            setStep(2); // Move to reset password step\r\n        }, 2000);\r\n    };\r\n\r\n    // Simulate Reset Password Submission\r\n    const handleResetSubmit = () => {\r\n        if (password !== confirmPassword) {\r\n            alert(\"Passwords do not match!\");\r\n            return;\r\n        }\r\n        setIsLoading(true);\r\n        setTimeout(() => {\r\n            setIsLoading(false);\r\n            // Close dialog after password reset\r\n        }, 2000);\r\n    };\r\n    const fileInputRef = useRef(null);\r\n\r\n    const [loader, setLoader] = useState(false)\r\n\r\n    const [imageURL, setImageURL] = useState()\r\n    const [hovered, setHovered] = useState(false);\r\n\r\n\r\n\r\n\r\n    const handleImageClick = () => {\r\n        fileInputRef.current.click();\r\n    };\r\n\r\n    const handleFileChange = async (e) => {\r\n        try {\r\n            const file = e.target.files[0];\r\n            if (file) {\r\n                setValue(\"image\", file, { shouldValidate: true }); // Set value and trigger validation\r\n            }\r\n            const formData = new FormData();\r\n            formData.append(\"document\", e.target.files[0]);\r\n\r\n            const response = await axios.post(\r\n                'https://cosmetic.theappkit.com/api/system/upload',\r\n                formData,\r\n                {\r\n                    headers: {\r\n                        'Content-Type': 'multipart/form-data'\r\n                    }\r\n                }\r\n            );\r\n\r\n            console.log(response?.data?.data?.path);\r\n\r\n            setImageURL('https://cosmetic.theappkit.com' + response?.data?.data?.path);\r\n\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n\r\n        }\r\n    };\r\n    const UpdateConsentForm = async () => {\r\n        setLoader(true);\r\n        try {\r\n            let obj = {\r\n                patient_id: selectedPatient?.id,\r\n                form_id: null,\r\n                aftercare_document: selectedDocument?._id,\r\n                treatment_date: getValues('treatmentDate'),\r\n                consultation_date: getValues('consultationDate'),\r\n                first_name: getValues('fname'),\r\n                last_name: getValues('lname'),\r\n                dob: getValues('selectedDate'),\r\n                address: getValues('address'),\r\n                email: getValues('email'),\r\n                post_code: getValues('post'),\r\n                phone: getValues('phone'),\r\n                notes: getValues('notes'),\r\n                picture: imageURL,\r\n                kin_details: {\r\n                    name: getValues('name'),\r\n                    address: getValues('kinaddress'),\r\n                    email: getValues('kinemail'),\r\n                    phone: getValues('kinphone'),\r\n                },\r\n                general_practitioner: {\r\n                    name: getValues('genname'),\r\n                    address: getValues('genaddress'),\r\n                    email: getValues('genemail'),\r\n                    phone: getValues('genphone'),\r\n                },\r\n                treatment_plan: {\r\n                    patient_concerns: getValues('patientConcerns'),\r\n                    patient_goals: getValues('patientGoal'),\r\n                    advised_plan: getValues('advisedPlan'),\r\n                    expected_result: getValues('expectedResult'),\r\n                    date: getValues('patientDate'),\r\n                    patient_sign: signature\r\n                },\r\n                batch_images: uploadedImages,\r\n                before_images: beforeImages,\r\n                after_images: afterImages,\r\n                further_treatment: furtherFields,\r\n                treatment_record: fields,\r\n                extra_notes: getValues('extranotes'),\r\n                permission_marketing: permissions?.marketing,\r\n                offers: permissions?.offers,\r\n\r\n\r\n            };\r\n\r\n            const promise = ApiServices.CreateForm(obj);\r\n\r\n            // Handle the API response properly\r\n            const response = await promise;\r\n            console.log(response);\r\n\r\n            showPromiseToast(\r\n                promise,\r\n                \"Saving...\",\r\n                \"Added Successfully\",\r\n                \"Something Went Wrong\"\r\n            );\r\n\r\n            // Navigate if response is successful\r\n            if (response?.responseCode === 200) {\r\n                console.log(response);\r\n                setImageURL(null)\r\n                navigate('/consent-forms')\r\n\r\n\r\n            }\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n            showErrorToast(error)\r\n        } finally {\r\n\r\n            setLoader(false);\r\n        }\r\n    };\r\n\r\n    const SendOtp = async (val) => {\r\n        if (val != 'resend') {\r\n            setIsLoading(true)\r\n        }\r\n\r\n\r\n        setTimer(60);\r\n        try {\r\n            let obj = {\r\n                email: userData?.email\r\n            };\r\n\r\n            const data = await ApiServices.SendOtp(obj);\r\n            console.log(data);\r\n            if (data.responseCode == 206) {\r\n                setOtp('')\r\n                showSuccessToast('Otp Sent Successfully')\r\n\r\n            }\r\n\r\n        } catch (error) {\r\n\r\n            console.log(error)\r\n        }\r\n        finally {\r\n            setIsLoading(false)\r\n            setStep(1)\r\n            setOpen(true)\r\n\r\n        }\r\n    }\r\n\r\n    const UpdatePassword = async (sendData, result) => {\r\n        setIsLoading(true)\r\n        console.log(otpToken, \"otpToken2\");\r\n        try {\r\n            let obj = {\r\n                otp_token: otpToken,\r\n                email: userData?.email,\r\n                password: getValues4('password'),\r\n                confirm_password: getValues4('confirmPassword'),\r\n            };\r\n\r\n            const data = await ApiServices.SendOtp(obj);\r\n            console.log(data);\r\n            if (data.responseCode == 200) {\r\n                setOtp('')\r\n\r\n                reset4()\r\n                setConfirmPassword(false)\r\n\r\n\r\n\r\n            }\r\n        } catch (error) {\r\n            setOtpError(true)\r\n        }\r\n        finally {\r\n            setIsLoading(false)\r\n            setOpen(false)\r\n            showSuccessToast('Password Reset Successfully')\r\n        }\r\n    };\r\n\r\n    const SubmitOTP = async (val) => {\r\n\r\n        setIsLoading(true)\r\n\r\n\r\n\r\n        try {\r\n            let obj = {\r\n                email: userData?.email,\r\n                otp: otp,\r\n            };\r\n\r\n            const data = await ApiServices.SendOtp(obj);\r\n            console.log(data?.data, 'tesetttt');\r\n            if (data.responseCode == 206) {\r\n                console.log(data);\r\n                setOtpToken(data?.data?.otp_token)\r\n\r\n\r\n            }\r\n        } catch (error) {\r\n            setOtpError(true)\r\n        }\r\n        finally {\r\n            setIsLoading(false)\r\n\r\n        }\r\n    };\r\n\r\n    const handleFileChange2 = async (e) => {\r\n        setUploadedImages([]);\r\n        setImageLoader(true);\r\n\r\n        try {\r\n            const files = e.target.files;\r\n            if (!files || files.length === 0) return; // Exit if no files are selected\r\n\r\n            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n\r\n            const uploadedNewBatchImages = [];\r\n\r\n            for (let i = 0; i < files.length; i++) {\r\n                const formData = new FormData();\r\n                formData.append(\"document\", files[i]);\r\n\r\n                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n\r\n                const response = await axios.post(\r\n                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n                    formData,\r\n                    {\r\n                        headers: {\r\n                            \"Content-Type\": \"multipart/form-data\",\r\n                        },\r\n                    }\r\n                );\r\n\r\n                const imagePath = response?.data?.data?.path;\r\n                if (imagePath) {\r\n                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n                    uploadedNewBatchImages.push(fullImageUrl);\r\n                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n                }\r\n            }\r\n\r\n            setUploadedImages(uploadedNewBatchImages); // Update state with uploaded image URLs\r\n            console.log(\"All Uploaded Images:\", uploadedNewBatchImages);\r\n        } catch (error) {\r\n            console.error(\"Error uploading files:\", error);\r\n        } finally {\r\n            setImageLoader(false);\r\n        }\r\n    };\r\n\r\n    const handleRemoveImage = (index) => {\r\n        setUploadedImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const handleFileChange3 = async (e) => {\r\n        setBeforeImages([]);\r\n        setImageLoaderBefore(true);\r\n\r\n        try {\r\n            const files = e.target.files;\r\n            if (!files || files.length === 0) return; // Exit if no files are selected\r\n\r\n            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n\r\n            const uploadedNewBeforeImages = [];\r\n\r\n            for (let i = 0; i < files.length; i++) {\r\n                const formData = new FormData();\r\n                formData.append(\"document\", files[i]);\r\n\r\n                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n\r\n                const response = await axios.post(\r\n                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n                    formData,\r\n                    {\r\n                        headers: {\r\n                            \"Content-Type\": \"multipart/form-data\",\r\n                        },\r\n                    }\r\n                );\r\n\r\n                const imagePath = response?.data?.data?.path;\r\n                if (imagePath) {\r\n                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n                    uploadedNewBeforeImages.push(fullImageUrl);\r\n                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n                }\r\n            }\r\n\r\n            setBeforeImages(uploadedNewBeforeImages); // Update state with uploaded image URLs\r\n            console.log(\"All Uploaded Images:\", uploadedNewBeforeImages);\r\n        } catch (error) {\r\n            console.error(\"Error uploading files:\", error);\r\n        } finally {\r\n            setImageLoaderBefore(false);\r\n        }\r\n    };\r\n\r\n    const handleRemoveImage2 = (index) => {\r\n        setBeforeImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n    };\r\n    const handleFileChange4 = async (e) => {\r\n        setAfterImages([]);\r\n        setImageLoaderAfter(true);\r\n\r\n        try {\r\n            const files = e.target.files;\r\n            if (!files || files.length === 0) return; // Exit if no files are selected\r\n\r\n            setValue(\"images\", Array.from(files), { shouldValidate: true }); // Ensure files are stored as an array\r\n\r\n            const uploadedNewAfterImages = [];\r\n\r\n            for (let i = 0; i < files.length; i++) {\r\n                const formData = new FormData();\r\n                formData.append(\"document\", files[i]);\r\n\r\n                console.log(\"Uploading file:\", files[i].name); // Debugging log\r\n\r\n                const response = await axios.post(\r\n                    \"https://cosmetic.theappkit.com/api/system/upload\",\r\n                    formData,\r\n                    {\r\n                        headers: {\r\n                            \"Content-Type\": \"multipart/form-data\",\r\n                        },\r\n                    }\r\n                );\r\n\r\n                const imagePath = response?.data?.data?.path;\r\n                if (imagePath) {\r\n                    const fullImageUrl = \"https://cosmetic.theappkit.com\" + imagePath;\r\n                    uploadedNewAfterImages.push(fullImageUrl);\r\n                    console.log(\"Uploaded Image URL:\", fullImageUrl);\r\n                }\r\n            }\r\n\r\n            setAfterImages(uploadedNewAfterImages); // Update state with uploaded image URLs\r\n            console.log(\"All Uploaded Images:\", uploadedNewAfterImages);\r\n        } catch (error) {\r\n            console.error(\"Error uploading files:\", error);\r\n        } finally {\r\n            setImageLoaderAfter(false);\r\n        }\r\n    };\r\n\r\n    const handleRemoveImage3 = (index) => {\r\n        setAfterImages(prevImages => prevImages.filter((_, i) => i !== index));\r\n    };\r\n    useEffect(() => {\r\n        let interval;\r\n        if (timer > 0) {\r\n            interval = setInterval(() => {\r\n                setTimer((prev) => prev - 1);\r\n            }, 1000);\r\n        } else {\r\n            clearInterval(interval);\r\n        }\r\n        return () => clearInterval(interval);\r\n    }, [timer]);\r\n\r\n    const getDocuments = async () => {\r\n        try {\r\n            let params = {\r\n                page: 1,\r\n                limit: 999\r\n            };\r\n\r\n            const data = await ApiServices.getAfterCareDocuments(params);\r\n\r\n\r\n\r\n            setDocuments(\r\n                data?.data?.documents?.map((doc) => ({\r\n\r\n                    id: doc?._id, // Example transformation\r\n                    name: doc.title, // Another example\r\n                }))\r\n            );\r\n\r\n\r\n\r\n        } catch (error) {\r\n            console.error(\"Error fetching location:\", error);\r\n        }\r\n    };\r\n    const getPatients = async () => {\r\n        try {\r\n            let params = {\r\n                page: 1,\r\n                limit: 999\r\n            };\r\n\r\n            const data = await ApiServices.getPatients(params);\r\n\r\n\r\n\r\n            setPatients(\r\n                data?.data?.patients?.map((doc) => ({\r\n                    ...doc,\r\n                    id: doc?._id, // Example transformation\r\n                    name: doc.title + \" \" + doc?.first_name + ' ' + doc?.last_name, // Another example\r\n                }))\r\n            );\r\n\r\n        } catch (error) {\r\n            console.error(\"Error fetching location:\", error);\r\n        }\r\n    };\r\n    useEffect(() => {\r\n        getPatients()\r\n        getDocuments()\r\n    }, [])\r\n    useEffect(() => {\r\n        // Disable drawing on the single canvas\r\n        if (sigCanvas.current) {\r\n            sigCanvas.current.off();\r\n        }\r\n\r\n        // Disable drawing on all multiple canvases\r\n        signCanvasRefs.current.forEach((canvas) => {\r\n            if (canvas) {\r\n                canvas.off();\r\n            }\r\n        });\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n\r\n            <Paper sx={{ width: \"100%\", overflow: \"hidden\", boxShadow: 'none', backgroundColor: '#eff6ff', borderRadius: '12px' }}>\r\n\r\n\r\n\r\n                <Box component={'form'} p={3} sx={{ borderRadius: '12px' }} onSubmit={handleSubmit(UpdateConsentForm)} >\r\n                    <Typography variant=\"h5\" sx={{ fontWeight: 700 }}>\r\n                        Create New Patient\r\n                    </Typography>\r\n\r\n                    <Grid container mt={4} spacing={2}>\r\n\r\n\r\n                        <Grid item xs={3} mt={2}>\r\n                            <InputLabel sx={{\r\n                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                fontSize: \"14px\",\r\n                                color: \"#333\",\r\n                                marginBottom: \"4px\",\r\n                            }}>\r\n\r\n                                Select Form :\r\n                            </InputLabel>\r\n                            <SelectField\r\n                                size={'small'}\r\n                                newLabel={'Select Form'}\r\n                                fullWidth={true}\r\n                                options={[]}\r\n                                selected={title}\r\n                                onSelect={(value) => {\r\n                                    setTitle(value)\r\n\r\n\r\n                                }}\r\n                                error={errors?.title?.message}\r\n                                register={register(\"title\", {\r\n                                    required: false,\r\n                                })}\r\n                            />\r\n\r\n                        </Grid>\r\n                        <Grid item xs={3} mt={2}>\r\n                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                                <Grid container spacing={2}>\r\n                                    {/* Single Date Selection */}\r\n                                    <Grid item xs={12}>\r\n                                        <Box>\r\n                                            <InputLabel sx={{\r\n                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                                fontSize: \"14px\",\r\n                                                color: \"#333\",\r\n                                                marginBottom: 1.5,\r\n                                            }}>\r\n                                                Treatment Date :*\r\n                                            </InputLabel>\r\n                                            <Controller\r\n                                                name=\"treatmentDate\"\r\n                                                control={control}\r\n                                                rules={{ required: \"Please select a date\" }}\r\n                                                render={({ field }) => (\r\n                                                    <DatePicker\r\n                                                        {...field}\r\n                                                        value={field.value || null}\r\n                                                        onChange={(newValue) => field.onChange(newValue)}\r\n                                                        slotProps={{\r\n                                                            textField: {\r\n                                                                size: \"small\",\r\n                                                                fullWidth: true,\r\n                                                                sx: {\r\n                                                                    \"& .MuiOutlinedInput-root\": {\r\n                                                                        borderRadius: '12px',\r\n                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n                                                                    },\r\n                                                                },\r\n                                                            },\r\n                                                        }}\r\n                                                    />\r\n                                                )}\r\n                                            />\r\n                                            {errors.treatmentDate && (\r\n                                                <Typography color=\"error\">{errors.treatmentDate.message}</Typography>\r\n                                            )}\r\n                                        </Box>\r\n                                    </Grid>\r\n\r\n\r\n\r\n\r\n                                </Grid>\r\n\r\n\r\n                            </LocalizationProvider>\r\n                        </Grid>\r\n                        <Grid item xs={3} mt={2}>\r\n                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                                <Grid container spacing={2}>\r\n                                    {/* Single Date Selection */}\r\n                                    <Grid item xs={12}>\r\n                                        <Box>\r\n                                            <InputLabel sx={{\r\n                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                                fontSize: \"14px\",\r\n                                                color: \"#333\",\r\n                                                marginBottom: 1.5,\r\n                                            }}>\r\n                                                Consultation Date :*\r\n                                            </InputLabel>\r\n                                            <Controller\r\n                                                name=\"consultationDate\"\r\n                                                control={control}\r\n                                                rules={{ required: \"Please select a date\" }}\r\n                                                render={({ field }) => (\r\n                                                    <DatePicker\r\n                                                        {...field}\r\n                                                        value={field.value || null}\r\n                                                        onChange={(newValue) => field.onChange(newValue)}\r\n                                                        slotProps={{\r\n                                                            textField: {\r\n                                                                size: \"small\",\r\n                                                                fullWidth: true,\r\n                                                                sx: {\r\n                                                                    \"& .MuiOutlinedInput-root\": {\r\n                                                                        borderRadius: '12px',\r\n                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n                                                                    },\r\n                                                                },\r\n                                                            },\r\n                                                        }}\r\n                                                    />\r\n                                                )}\r\n                                            />\r\n                                            {errors.consultationDate && (\r\n                                                <Typography color=\"error\">{errors.consultationDate.message}</Typography>\r\n                                            )}\r\n                                        </Box>\r\n                                    </Grid>\r\n\r\n\r\n\r\n\r\n                                </Grid>\r\n\r\n\r\n                            </LocalizationProvider>\r\n                        </Grid>\r\n                        <Grid container p={2} spacing={2} >\r\n\r\n                            <Grid item xs={3} mt={2}>\r\n                                <InputLabel sx={{\r\n                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                    fontSize: \"14px\",\r\n                                    color: \"#333\",\r\n                                    marginBottom: \"4px\",\r\n                                }}>\r\n\r\n                                    Existing or New Patient :\r\n                                </InputLabel>\r\n                                <FormControl component=\"fieldset\">\r\n\r\n                                    <RadioGroup row value={patientType} onChange={handleChange}>\r\n                                        <FormControlLabel value=\"existing\" control={<Radio />} label=\"Existing\" />\r\n                                        <FormControlLabel value=\"new\" control={<Radio />} label=\"New\" />\r\n                                    </RadioGroup>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={3} mt={2}>\r\n                                {patientType == 'existing' && <> <InputLabel sx={{\r\n                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                    fontSize: \"14px\",\r\n                                    color: \"#333\",\r\n                                    marginBottom: \"4px\",\r\n                                }}>\r\n\r\n                                    Select Patient :\r\n                                </InputLabel>\r\n                                    <SelectField\r\n                                        size={'small'}\r\n                                        newLabel={'Select Patient'}\r\n                                        fullWidth={true}\r\n                                        options={patients}\r\n                                        selected={selectedPatient}\r\n                                        onSelect={(value) => {\r\n                                            setSelectedPatient(value);\r\n                                            console.log(\"Selected Patient:\", value);\r\n                                    \r\n                                            setValue('fname', value?.first_name || \"\");\r\n                                            setValue('lname', value?.last_name || \"\");\r\n                                            setValue('email', value?.email || \"\");\r\n                                            setValue('post', value?.post_code || \"\");\r\n                                            setValue('phone', value?.phone || \"\");\r\n                                            setValue('address', value?.address || \"\");\r\n                                            setValue('notes', value?.notes || \"\");\r\n                                            setValue('name', value?.kin_details?.name || \"\");\r\n                                            setValue('kinemail', value?.kin_details?.email || \"\");\r\n                                            setValue('kinphone', value?.kin_details?.phone || \"\");\r\n                                            setValue('kinaddress', value?.kin_details?.address || \"\");\r\n                                            setValue('genname', value?.general_practitioner?.name || \"\");\r\n                                            setValue('genemail', value?.general_practitioner?.email || \"\");\r\n                                            setValue('genphone', value?.general_practitioner?.phone || \"\");\r\n                                            setValue('genaddress', value?.general_practitioner?.address || \"\");\r\n                                            console.log(\"Raw DOB:\", value?.dob);\r\n                                    \r\n                                            if (value?.dob) {\r\n                                                // Convert to Dayjs format\r\n                                                const parsedDate = dayjs(value.dob);\r\n                                    \r\n                                                // Check if the conversion is valid\r\n                                                if (!parsedDate.isValid()) {\r\n                                                    console.error(\"Invalid DOB Format:\", value.dob);\r\n                                                    return;\r\n                                                }\r\n                                    \r\n                                                console.log(\"Parsed Date:\", parsedDate);\r\n                                                setValue(\"selectedDate\", parsedDate);\r\n                                            }\r\n                                        }}\r\n                                        error={errors?.patient?.message}\r\n                                        register={register(\"patient\", {\r\n                                            required: false,\r\n                                        })}\r\n                                    />\r\n                                </>}\r\n                            </Grid>\r\n                            <Grid item xs={3} mt={2}>\r\n                                {patientType == 'existing' && <><InputLabel sx={{\r\n                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                    fontSize: \"14px\",\r\n                                    color: \"#333\",\r\n                                    marginBottom: \"4px\",\r\n                                }}>\r\n\r\n                                    Select Aftercare Document :\r\n                                </InputLabel>\r\n                                    <SelectField\r\n                                        size={'small'}\r\n                                        newLabel={'Select Document'}\r\n                                        fullWidth={true}\r\n                                        options={documents}\r\n                                        selected={selectedDocument}\r\n                                        onSelect={(value) => {\r\n                                            setSelectedDocument(value)\r\n\r\n\r\n                                        }}\r\n                                        error={errors?.document?.message}\r\n                                        register={register(\"document\", {\r\n                                            required: false,\r\n                                        })}\r\n                                    /> </>}\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Patient First Name :*\"}\r\n                            size={'small'}\r\n                            placeholder={\"Patient First Name\"}\r\n                            error={errors?.fname?.message}\r\n                            register={register(\"fname\", {\r\n                                required:\r\n                                    \"Please enter your fname.\"\r\n\r\n                            })}\r\n                        /></Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Patient Last Name :*\"}\r\n                            size={'small'}\r\n                            placeholder={\" Patient Last Name\"}\r\n                            error={errors?.lname?.message}\r\n                            register={register(\"lname\", {\r\n                                required:\r\n                                    \"Please enter your lname.\"\r\n\r\n                            })}\r\n                        /></Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Patient Email :*\"}\r\n                            size={'small'}\r\n                            placeholder={\"Patient Email\"}\r\n                            error={errors?.email?.message}\r\n                            register={register(\"email\", {\r\n                                required:\r\n                                    \"Please enter your email.\"\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}>\r\n                            <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                                <Grid container spacing={2}>\r\n                                    {/* Single Date Selection */}\r\n                                    <Grid item xs={12}>\r\n                                        <Box>\r\n                                            <InputLabel sx={{\r\n                                                textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                                fontSize: \"14px\",\r\n                                                color: \"#333\",\r\n                                                marginBottom: 1.5,\r\n                                            }}>\r\n                                                DOB :*\r\n                                            </InputLabel>\r\n                                            <Controller\r\n                                                name=\"selectedDate\"\r\n                                                control={control}\r\n                                                rules={{ required: \"Please select a date\" }}\r\n                                                render={({ field }) => (\r\n                                                    <DatePicker\r\n                                                        {...field}\r\n                                                        value={field.value || null}\r\n                                                        onChange={(newValue) => field.onChange(newValue)}\r\n                                                        slotProps={{\r\n                                                            textField: {\r\n                                                                size: \"small\",\r\n                                                                fullWidth: true,\r\n                                                                sx: {\r\n                                                                    \"& .MuiOutlinedInput-root\": {\r\n                                                                        borderRadius: '12px',\r\n                                                                        \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n                                                                        \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n                                                                        \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n                                                                    },\r\n                                                                },\r\n                                                            },\r\n                                                        }}\r\n                                                    />\r\n                                                )}\r\n                                            />\r\n                                            {errors.selectedDate && (\r\n                                                <Typography color=\"error\">{errors.selectedDate.message}</Typography>\r\n                                            )}\r\n                                        </Box>\r\n                                    </Grid>\r\n\r\n\r\n\r\n\r\n                                </Grid>\r\n\r\n\r\n                            </LocalizationProvider>\r\n                        </Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Phone Number :*\"}\r\n                            size={'small'}\r\n                            placeholder={\"Phone Number\"}\r\n                            error={errors?.phone?.message}\r\n                            register={register(\"phone\", {\r\n                                required:\r\n                                    \"Please enter your phone.\"\r\n\r\n                            })}\r\n                        /></Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Post Code :*\"}\r\n                            size={'small'}\r\n                            placeholder={\"Post Code\"}\r\n                            error={errors?.post?.message}\r\n                            register={register(\"post\", {\r\n                                required:\r\n                                    \"Please enter your postcode.\"\r\n\r\n                            })}\r\n                        /></Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Address :*\"}\r\n                            size={'small'}\r\n                            placeholder={\"Address\"}\r\n                            error={errors?.address?.message}\r\n                            register={register(\"address\", {\r\n                                required:\r\n                                    \"Please enter your address.\"\r\n\r\n                            })}\r\n                        /></Grid>\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Notes :\"}\r\n                            multiline\r\n                            rows={3}\r\n                            size={'small'}\r\n                            placeholder={\"Notes\"}\r\n                            error={errors?.notes?.message}\r\n                            register={register(\"notes\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n\r\n                    </Grid>\r\n                    <Divider sx={{ mt: 4 }} />\r\n                    <Typography variant=\"h5\" sx={{ fontWeight: 700, mt: 4 }}>\r\n                        Next of Kin Details\r\n                    </Typography>\r\n                    <Grid container mt={4} spacing={2}>\r\n\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Name :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Name\"}\r\n                            error={errors?.name?.message}\r\n                            register={register(\"name\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Email :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Email\"}\r\n                            error={errors?.kinemail?.message}\r\n                            register={register(\"kinemail\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Phone Number :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Phone Number\"}\r\n                            error={errors?.kinphone?.message}\r\n                            register={register(\"kinphone\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Address :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Address\"}\r\n                            error={errors?.kinaddress?.message}\r\n                            register={register(\"kinaddress\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n\r\n\r\n                    </Grid>\r\n                    <Divider sx={{ mt: 4 }} />\r\n                    <Typography variant=\"h5\" sx={{ fontWeight: 700, mt: 4 }}>\r\n                        General Practitioners(GP / Doctors)\r\n                    </Typography>\r\n                    <Grid container mt={4} spacing={2}>\r\n\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Name :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Name\"}\r\n                            error={errors?.genname?.message}\r\n                            register={register(\"genname\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Email :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Email\"}\r\n                            error={errors?.genemail?.message}\r\n                            register={register(\"genemail\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Phone Number :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Phone Number\"}\r\n                            error={errors?.genphone?.message}\r\n                            register={register(\"genphone\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n\r\n                        <Grid item xs={3} mt={2}><InputField\r\n                            label={\"Address :\"}\r\n                            size={'small'}\r\n                            placeholder={\"Address\"}\r\n                            error={errors?.genaddress?.message}\r\n                            register={register(\"genaddress\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Grid container spacing={2} p={2}>\r\n                            {/* Marketing Permission */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we have permission to use your images for marketing?</FormLabel>\r\n                                <FormControl component=\"fieldset\">\r\n\r\n                                    <RadioGroup row name=\"marketing\" value={permissions.marketing} onChange={handleChange2}>\r\n                                        <FormControlLabel value=\"yes\" control={<Radio />} label=\"Yes\" />\r\n                                        <FormControlLabel value=\"no\" control={<Radio />} label=\"No\" />\r\n                                    </RadioGroup>\r\n                                </FormControl>\r\n                            </Grid>\r\n\r\n                            {/* Offers & Reminders Permission */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <FormLabel component=\"legend\" sx={{ color: 'black' }}>Can we send you offers & reminders by text email & WhatsApp?</FormLabel>\r\n                                <FormControl component=\"fieldset\">\r\n\r\n                                    <RadioGroup row name=\"offers\" value={permissions.offers} onChange={handleChange2}>\r\n                                        <FormControlLabel value=\"yes\" control={<Radio />} label=\"Yes\" />\r\n                                        <FormControlLabel value=\"no\" control={<Radio />} label=\"No\" />\r\n                                    </RadioGroup>\r\n                                </FormControl>\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Typography variant=\"h5\" fontWeight=\"bold\" mb={2} p={2}>\r\n                            Treatment plan section\r\n                        </Typography>\r\n\r\n                        <Grid container spacing={2} p={2}>\r\n                            {/* Patient Concerns */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <InputField\r\n                                    label=\"Patient concerns\"\r\n                                    size=\"small\"\r\n                                    placeholder=\"Patient concerns\"\r\n                                    error={errors?.patientConcerns?.message}\r\n                                    register={register(\"patientConcerns\", { required: false })}\r\n                                    multiline\r\n                                    rows={4}\r\n                                />\r\n                            </Grid>\r\n\r\n                            {/* Patient Goal */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <InputField\r\n                                    label=\"Patient goal\"\r\n                                    size=\"small\"\r\n                                    placeholder=\"Patient goal\"\r\n                                    error={errors?.patientGoal?.message}\r\n                                    register={register(\"patientGoal\", { required: false })}\r\n                                    multiline\r\n                                    rows={4}\r\n                                />\r\n                            </Grid>\r\n\r\n                            {/* Advised Plan/Product */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <InputField\r\n                                    label=\"Advised Plan/product\"\r\n                                    size=\"small\"\r\n                                    placeholder=\"Advised Plan/product\"\r\n                                    error={errors?.advisedPlan?.message}\r\n                                    register={register(\"advisedPlan\", { required: false })}\r\n                                    multiline\r\n                                    rows={4}\r\n                                />\r\n                            </Grid>\r\n\r\n                            {/* Expected Result */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <InputField\r\n                                    label=\"Expected Result\"\r\n                                    size=\"small\"\r\n                                    placeholder=\"Expected Result\"\r\n                                    error={errors?.expectedResult?.message}\r\n                                    register={register(\"expectedResult\", { required: false })}\r\n                                    multiline\r\n                                    rows={4}\r\n                                />\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Typography variant=\"p\" fontWeight={500} mb={2} p={2}>\r\n                            I confirm my medical history to be true and correct. I agree I have read and understood all the contents of this document. I have read and understood all the content of this document and agree with the treatment plan. I give my consent to treatment and understand the possible complications and side effects. I confirm I have received an aftercare sheet\r\n                        </Typography>\r\n                        <Grid container spacing={5} p={2} alignItems=\"center\">\r\n                            {/* Date Field */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                                    <Grid container spacing={2}>\r\n                                        {/* Single Date Selection */}\r\n                                        <Grid item xs={12}>\r\n                                            <Box>\r\n                                                <InputLabel sx={{\r\n                                                    textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block',\r\n\r\n                                                    fontSize: \"14px\",\r\n                                                    color: \"#333\",\r\n                                                    marginBottom: 1.5,\r\n                                                }}>\r\n                                                    Patient Date :*\r\n                                                </InputLabel>\r\n                                                <Controller\r\n                                                    name=\"patientDate\"\r\n                                                    control={control}\r\n                                                    rules={{ required: \"Please select a date\" }}\r\n                                                    render={({ field }) => (\r\n                                                        <DatePicker\r\n                                                            {...field}\r\n                                                            value={field.value || null}\r\n                                                            onChange={(newValue) => field.onChange(newValue)}\r\n                                                            slotProps={{\r\n                                                                textField: {\r\n                                                                    size: \"small\",\r\n                                                                    fullWidth: true,\r\n                                                                    sx: {\r\n                                                                        \"& .MuiOutlinedInput-root\": {\r\n                                                                            borderRadius: '12px',\r\n                                                                            \"& fieldset\": { border: \"1 solid #e0e0e0\" }, // Default border\r\n                                                                            \"&:hover fieldset\": { border: \"1 solid #0076bf\" }, // On hover\r\n                                                                            \"&.Mui-focused fieldset\": { border: \"1 solid #0076bf !important\" } // On focus\r\n                                                                        },\r\n                                                                    },\r\n                                                                },\r\n                                                            }}\r\n                                                        />\r\n                                                    )}\r\n                                                />\r\n                                                {errors.patientDate && (\r\n                                                    <Typography color=\"error\">{errors.patientDate.message}</Typography>\r\n                                                )}\r\n                                            </Box>\r\n                                        </Grid>\r\n\r\n\r\n\r\n\r\n                                    </Grid>\r\n\r\n\r\n                                </LocalizationProvider>\r\n                            </Grid>\r\n\r\n                            {/* Signature Canvas */}\r\n                            <Grid item xs={6} mt={2}>\r\n                                <Typography>Patient Signature:</Typography>\r\n                                <SignatureCanvas\r\n                                    ref={sigCanvas}\r\n                                    penColor=\"black\"\r\n                                    canvasProps={{\r\n                                        width: 300,\r\n                                        height: 150,\r\n                                        className: \"sigCanvas\",\r\n                                        style: { border: \"1px dashed black\" },\r\n                                    }}\r\n                                />\r\n                                <Grid container spacing={1} mt={1}>\r\n                                    <Grid item>\r\n                                        <Button variant=\"contained\" color=\"secondary\" onClick={handleClear}>\r\n                                            Clear Signature\r\n                                        </Button>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Button variant=\"contained\" color=\"primary\" onClick={handleSave}>\r\n                                            Save Signature\r\n                                        </Button>\r\n                                    </Grid>\r\n\r\n                                </Grid>\r\n\r\n\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Typography variant=\"h5\" p={2} fontWeight={'bold'}>Treatment Record Section</Typography>\r\n\r\n                        <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                            {fields.map((item, index) => (\r\n                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n\r\n                                    {/* Patient Date Selection */}\r\n                                    <Grid item xs={3}>\r\n                                        <Box>\r\n                                            <InputLabel\r\n                                                sx={{\r\n                                                    textTransform: \"capitalize\",\r\n                                                    textAlign: \"left\",\r\n                                                    fontWeight: 700,\r\n                                                    fontSize: \"14px\",\r\n                                                    color: \"#333\",\r\n                                                    marginBottom: 1.5,\r\n                                                }}\r\n                                            >\r\n                                                Date :*\r\n                                            </InputLabel>\r\n\r\n                                            <Controller\r\n                                                name={`records.${index}.date`}\r\n                                                control={control}\r\n                                                rules={{ required: \"Please select a date\" }}\r\n                                                render={({ field }) => (\r\n                                                    <DatePicker\r\n                                                        {...field}\r\n                                                        value={field.value || null}\r\n                                                        onChange={(newValue) => field.onChange(newValue)}\r\n                                                        slotProps={{\r\n                                                            textField: {\r\n                                                                size: \"small\",\r\n                                                                fullWidth: true,\r\n                                                                sx: {\r\n                                                                    \"& .MuiOutlinedInput-root\": {\r\n                                                                        borderRadius: \"12px\",\r\n                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n                                                                    },\r\n                                                                },\r\n                                                            },\r\n                                                        }}\r\n                                                    />\r\n                                                )}\r\n                                            />\r\n                                            {errors.records?.[index]?.date && (\r\n                                                <Typography color=\"error\">\r\n                                                    {errors.records[index].date.message}\r\n                                                </Typography>\r\n                                            )}\r\n                                        </Box>\r\n                                    </Grid>\r\n\r\n                                    {/* Amount Field */}\r\n                                    <Grid item xs={3} mt={2}>\r\n                                        <InputField\r\n                                            label=\"Amount\"\r\n                                            placeholder=\"Order Amount\"\r\n                                            size=\"small\"\r\n                                            {...register(`records.${index}.amount`)}\r\n                                        />\r\n                                    </Grid>\r\n\r\n\r\n\r\n                                    {/* Description Field */}\r\n                                    <Grid item xs={4}>\r\n                                        <InputField\r\n                                            label=\"Description\"\r\n                                            multiline\r\n                                            rows={3}\r\n                                            placeholder=\"Description\"\r\n                                            {...register(`records.${index}.description`)}\r\n                                        />\r\n                                    </Grid>\r\n                                    {/* Remove Button (only for additional fields) */}\r\n                                    <Grid item xs={1}>\r\n                                        {index > 0 && (\r\n                                            <IconButton color=\"error\" onClick={() => remove(index)}>\r\n                                                <DeleteIcon />\r\n                                            </IconButton>\r\n                                        )}\r\n                                    </Grid>\r\n                                </Grid>\r\n                            ))}\r\n                        </LocalizationProvider>\r\n\r\n\r\n\r\n                        <Grid container p={2}>\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={() => append({ date: \"\", amount: \"\", description: \"\" })}\r\n                                sx={{ mt: 2, textTransform: 'capitalize' }}\r\n                            >\r\n                                Add More\r\n                            </Button>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Grid item xs={12} sm={5}>\r\n                            <InputLabel sx={{\r\n                                textTransform: \"capitalize\", mt: 2,\r\n                                textAlign: \"left\",\r\n                                fontWeight: 600,\r\n                                fontSize: \"14px\",\r\n                                color: \"#333\",\r\n                                marginBottom: \"4px\",\r\n                            }}>\r\n                                Upload Batch Images :*\r\n                            </InputLabel>\r\n\r\n                            <Controller\r\n                                name=\"media\"\r\n                                control={control}\r\n                                rules={{\r\n                                    required: \"At least one image file is required\",\r\n                                    validate: (value) => {\r\n                                        if (!value || value.length === 0) {\r\n                                            return \"At least one image file is required\";\r\n                                        }\r\n                                        for (let i = 0; i < value.length; i++) {\r\n                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n                                                return \"Each file must be smaller than 10MB\";\r\n                                            }\r\n                                            if (!value[i].type.startsWith(\"image/\")) {\r\n                                                return \"Only image files are allowed\";\r\n                                            }\r\n                                        }\r\n                                        return true;\r\n                                    },\r\n                                }}\r\n                                render={({ field: { onChange } }) => (\r\n                                    <>\r\n                                        <Box\r\n                                            sx={{\r\n                                                borderRadius: \"8px\",\r\n                                                padding: \"20px\",\r\n                                                textAlign: \"center\",\r\n                                                cursor: \"pointer\",\r\n                                                backgroundColor: \"#f9f9f9\",\r\n                                                height: '135px',\r\n                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n                                            }}\r\n                                            onClick={() => document.getElementById(\"upload-media\").click()}\r\n                                        >\r\n                                            {!imageLoader ? (\r\n                                                <>\r\n                                                    <input\r\n                                                        type=\"file\"\r\n                                                        accept=\"image/*\"\r\n                                                        multiple\r\n                                                        style={{ display: \"none\" }}\r\n                                                        id=\"upload-media\"\r\n                                                        onChange={(e) => {\r\n                                                            const files = Array.from(e.target.files);\r\n                                                            onChange(files); // Update react-hook-form\r\n                                                            handleFileChange2(e); // Handle upload logic\r\n                                                        }}\r\n                                                    />\r\n                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n                                                        Drag & drop or click to upload images\r\n                                                    </Typography>\r\n                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n                                                        Allowed: Images (Max 10MB per file)\r\n                                                    </Typography>\r\n                                                </>\r\n                                            ) : (\r\n                                                <CircularProgress size={90} />\r\n                                            )}\r\n                                        </Box>\r\n\r\n                                        {errors.media && (\r\n                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n                                                {errors.media.message}\r\n                                            </Typography>\r\n                                        )}\r\n                                    </>\r\n                                )}\r\n                            />\r\n                        </Grid>\r\n\r\n                        <Grid container p={2}>\r\n                            {uploadedImages?.length > 0 && (\r\n                                <Grid item xs={12}>\r\n                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n                                        Uploaded Batch Images :\r\n                                    </InputLabel>\r\n                                </Grid>\r\n                            )}\r\n                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n                                {uploadedImages?.length > 0 &&\r\n                                    uploadedImages.map((file, index) => (\r\n                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n                                            <img\r\n                                                src={file}\r\n                                                alt=\"Uploaded Preview\"\r\n                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n                                            />\r\n                                            <Typography\r\n                                                variant=\"caption\"\r\n                                                sx={{\r\n                                                    display: \"block\",\r\n                                                    mt: 1,\r\n                                                    maxWidth: \"150px\",\r\n                                                    whiteSpace: \"nowrap\",\r\n                                                    overflow: \"hidden\",\r\n                                                    textOverflow: \"ellipsis\",\r\n                                                }}\r\n                                            >\r\n                                                {file.split(\"/\").pop()}\r\n                                            </Typography>\r\n                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n                                                <IconButton\r\n                                                    onClick={() => handleRemoveImage(index)}\r\n                                                    sx={{\r\n                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n                                                        color: \"#fff\",\r\n                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n                                                        width: 20,\r\n                                                        height: 20,\r\n                                                        borderRadius: \"50%\",\r\n                                                        p: 0.5,\r\n                                                    }}\r\n                                                >\r\n                                                    <CloseIcon fontSize=\"small\" />\r\n                                                </IconButton>\r\n                                            </Box>\r\n                                        </Box>\r\n                                    ))}\r\n                            </Box>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Grid item xs={12} sm={5}>\r\n                            <InputLabel sx={{\r\n                                textTransform: \"capitalize\", mt: 2,\r\n                                textAlign: \"left\",\r\n                                fontWeight: 600,\r\n                                fontSize: \"14px\",\r\n                                color: \"#333\",\r\n                                marginBottom: \"4px\",\r\n                            }}>\r\n                                Upload Before Images :*\r\n                            </InputLabel>\r\n\r\n                            <Controller\r\n                                name=\"media2\"\r\n                                control={control}\r\n                                rules={{\r\n                                    required: \"At least one image file is required\",\r\n                                    validate: (value) => {\r\n                                        if (!value || value.length === 0) {\r\n                                            return \"At least one image file is required\";\r\n                                        }\r\n                                        for (let i = 0; i < value.length; i++) {\r\n                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n                                                return \"Each file must be smaller than 10MB\";\r\n                                            }\r\n                                            if (!value[i].type.startsWith(\"image/\")) {\r\n                                                return \"Only image files are allowed\";\r\n                                            }\r\n                                        }\r\n                                        return true;\r\n                                    },\r\n                                }}\r\n                                render={({ field: { onChange } }) => (\r\n                                    <>\r\n                                        <Box\r\n                                            sx={{\r\n                                                borderRadius: \"8px\",\r\n                                                padding: \"20px\",\r\n                                                textAlign: \"center\",\r\n                                                cursor: \"pointer\",\r\n                                                backgroundColor: \"#f9f9f9\",\r\n                                                height: '135px',\r\n                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n                                            }}\r\n                                            onClick={() => document.getElementById(\"upload-media2\").click()}\r\n                                        >\r\n                                            {!imageLoaderBefore ? (\r\n                                                <>\r\n                                                    <input\r\n                                                        type=\"file\"\r\n                                                        accept=\"image/*\"\r\n                                                        multiple\r\n                                                        style={{ display: \"none\" }}\r\n                                                        id=\"upload-media2\"\r\n                                                        onChange={(e) => {\r\n                                                            const files = Array.from(e.target.files);\r\n                                                            onChange(files); // Update react-hook-form\r\n                                                            handleFileChange3(e); // Handle upload logic\r\n                                                        }}\r\n                                                    />\r\n                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n                                                        Drag & drop or click to upload images\r\n                                                    </Typography>\r\n                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n                                                        Allowed: Images (Max 10MB per file)\r\n                                                    </Typography>\r\n                                                </>\r\n                                            ) : (\r\n                                                <CircularProgress size={90} />\r\n                                            )}\r\n                                        </Box>\r\n\r\n                                        {errors.media2 && (\r\n                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n                                                {errors.media2.message}\r\n                                            </Typography>\r\n                                        )}\r\n                                    </>\r\n                                )}\r\n                            />\r\n                        </Grid>\r\n\r\n                        <Grid container p={2}>\r\n                            {beforeImages?.length > 0 && (\r\n                                <Grid item xs={12}>\r\n                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n                                        Uploaded Before Images :\r\n                                    </InputLabel>\r\n                                </Grid>\r\n                            )}\r\n                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n                                {beforeImages?.length > 0 &&\r\n                                    beforeImages.map((file, index) => (\r\n                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n                                            <img\r\n                                                src={file}\r\n                                                alt=\"Uploaded Preview\"\r\n                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n                                            />\r\n                                            <Typography\r\n                                                variant=\"caption\"\r\n                                                sx={{\r\n                                                    display: \"block\",\r\n                                                    mt: 1,\r\n                                                    maxWidth: \"150px\",\r\n                                                    whiteSpace: \"nowrap\",\r\n                                                    overflow: \"hidden\",\r\n                                                    textOverflow: \"ellipsis\",\r\n                                                }}\r\n                                            >\r\n                                                {file.split(\"/\").pop()}\r\n                                            </Typography>\r\n                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n                                                <IconButton\r\n                                                    onClick={() => handleRemoveImage2(index)}\r\n                                                    sx={{\r\n                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n                                                        color: \"#fff\",\r\n                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n                                                        width: 20,\r\n                                                        height: 20,\r\n                                                        borderRadius: \"50%\",\r\n                                                        p: 0.5,\r\n                                                    }}\r\n                                                >\r\n                                                    <CloseIcon fontSize=\"small\" />\r\n                                                </IconButton>\r\n                                            </Box>\r\n                                        </Box>\r\n                                    ))}\r\n                            </Box>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Grid item xs={12} sm={5}>\r\n                            <InputLabel sx={{\r\n                                textTransform: \"capitalize\", mt: 2,\r\n                                textAlign: \"left\",\r\n                                fontWeight: 600,\r\n                                fontSize: \"14px\",\r\n                                color: \"#333\",\r\n                                marginBottom: \"4px\",\r\n                            }}>\r\n                                Upload After Images :*\r\n                            </InputLabel>\r\n\r\n                            <Controller\r\n                                name=\"media3\"\r\n                                control={control}\r\n                                rules={{\r\n                                    required: \"At least one image file is required\",\r\n                                    validate: (value) => {\r\n                                        if (!value || value.length === 0) {\r\n                                            return \"At least one image file is required\";\r\n                                        }\r\n                                        for (let i = 0; i < value.length; i++) {\r\n                                            if (value[i].size > 10 * 1024 * 1024) { // 10MB limit\r\n                                                return \"Each file must be smaller than 10MB\";\r\n                                            }\r\n                                            if (!value[i].type.startsWith(\"image/\")) {\r\n                                                return \"Only image files are allowed\";\r\n                                            }\r\n                                        }\r\n                                        return true;\r\n                                    },\r\n                                }}\r\n                                render={({ field: { onChange } }) => (\r\n                                    <>\r\n                                        <Box\r\n                                            sx={{\r\n                                                borderRadius: \"8px\",\r\n                                                padding: \"20px\",\r\n                                                textAlign: \"center\",\r\n                                                cursor: \"pointer\",\r\n                                                backgroundColor: \"#f9f9f9\",\r\n                                                height: '135px',\r\n                                                \"&:hover\": { backgroundColor: \"#eef7ff\" },\r\n                                            }}\r\n                                            onClick={() => document.getElementById(\"upload-media3\").click()}\r\n                                        >\r\n                                            {!imageLoaderAfter ? (\r\n                                                <>\r\n                                                    <input\r\n                                                        type=\"file\"\r\n                                                        accept=\"image/*\"\r\n                                                        multiple\r\n                                                        style={{ display: \"none\" }}\r\n                                                        id=\"upload-media3\"\r\n                                                        onChange={(e) => {\r\n                                                            const files = Array.from(e.target.files);\r\n                                                            onChange(files); // Update react-hook-form\r\n                                                            handleFileChange4(e); // Handle upload logic\r\n                                                        }}\r\n                                                    />\r\n                                                    <UploadFileIcon sx={{ fontSize: 40, color: \"#0EA5EA\" }} />\r\n                                                    <Typography variant=\"body1\" sx={{ color: \"#333\", mt: 1 }}>\r\n                                                        Drag & drop or click to upload images\r\n                                                    </Typography>\r\n                                                    <Typography variant=\"caption\" sx={{ color: \"#666\" }}>\r\n                                                        Allowed: Images (Max 10MB per file)\r\n                                                    </Typography>\r\n                                                </>\r\n                                            ) : (\r\n                                                <CircularProgress size={90} />\r\n                                            )}\r\n                                        </Box>\r\n\r\n                                        {errors.media3 && (\r\n                                            <Typography color=\"error\" variant=\"body2\" sx={{ mt: 1 }}>\r\n                                                {errors.media3.message}\r\n                                            </Typography>\r\n                                        )}\r\n                                    </>\r\n                                )}\r\n                            />\r\n                        </Grid>\r\n\r\n                        <Grid container p={2}>\r\n                            {afterImages?.length > 0 && (\r\n                                <Grid item xs={12}>\r\n                                    <InputLabel sx={{ textTransform: \"capitalize\", textAlign: 'left', fontWeight: 700, display: 'block', mb: 3, mt: 3 }}>\r\n                                        Uploaded After Images :\r\n                                    </InputLabel>\r\n                                </Grid>\r\n                            )}\r\n                            <Box sx={{ display: \"flex\", gap: 2, flexWrap: \"wrap\" }}>\r\n                                {afterImages?.length > 0 &&\r\n                                    afterImages.map((file, index) => (\r\n                                        <Box key={index} sx={{ position: \"relative\", textAlign: \"center\" }}>\r\n                                            <img\r\n                                                src={file}\r\n                                                alt=\"Uploaded Preview\"\r\n                                                style={{ width: \"100px\", height: \"100px\", borderRadius: \"8px\", objectFit: \"cover\" }}\r\n                                            />\r\n                                            <Typography\r\n                                                variant=\"caption\"\r\n                                                sx={{\r\n                                                    display: \"block\",\r\n                                                    mt: 1,\r\n                                                    maxWidth: \"150px\",\r\n                                                    whiteSpace: \"nowrap\",\r\n                                                    overflow: \"hidden\",\r\n                                                    textOverflow: \"ellipsis\",\r\n                                                }}\r\n                                            >\r\n                                                {file.split(\"/\").pop()}\r\n                                            </Typography>\r\n                                            <Box sx={{ position: \"absolute\", top: 0, right: 0 }}>\r\n                                                <IconButton\r\n                                                    onClick={() => handleRemoveImage3(index)}\r\n                                                    sx={{\r\n                                                        backgroundColor: \"rgba(0,0,0,0.6)\",\r\n                                                        color: \"#fff\",\r\n                                                        \"&:hover\": { backgroundColor: \"red\" },\r\n                                                        width: 20,\r\n                                                        height: 20,\r\n                                                        borderRadius: \"50%\",\r\n                                                        p: 0.5,\r\n                                                    }}\r\n                                                >\r\n                                                    <CloseIcon fontSize=\"small\" />\r\n                                                </IconButton>\r\n                                            </Box>\r\n                                        </Box>\r\n                                    ))}\r\n                            </Box>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Typography variant=\"h6\" p={2} sx={{ mt: 4, fontWeight: 'bold' }}>Further Records</Typography>\r\n\r\n                        <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n                            {furtherFields.map((item, index) => (\r\n                                <Grid container spacing={2} p={2} alignItems=\"center\" key={item.id} mt={2}>\r\n                                    {/* Date Selection */}\r\n                                    <Grid item xs={5}>\r\n                                        <Box>\r\n                                            <InputLabel sx={{ fontWeight: 700, fontSize: \"14px\", marginBottom: 1.5 }}>\r\n                                                Further Date :*\r\n                                            </InputLabel>\r\n                                            <Controller\r\n                                                name={`furtherFields.${index}.date`}\r\n                                                control={control}\r\n                                                rules={{ required: \"Please select a date\" }}\r\n                                                render={({ field }) => (\r\n                                                    <DatePicker\r\n                                                        {...field}\r\n                                                        value={field.value || null}\r\n                                                        onChange={(newValue) => field.onChange(newValue)}\r\n                                                        slotProps={{\r\n                                                            textField: {\r\n                                                                size: \"small\",\r\n                                                                fullWidth: true,\r\n                                                                sx: {\r\n                                                                    \"& .MuiOutlinedInput-root\": {\r\n                                                                        borderRadius: \"12px\",\r\n                                                                        \"& fieldset\": { border: \"1px solid #e0e0e0\" },\r\n                                                                        \"&:hover fieldset\": { border: \"1px solid #0076bf\" },\r\n                                                                        \"&.Mui-focused fieldset\": { border: \"1px solid #0076bf !important\" },\r\n                                                                    },\r\n                                                                },\r\n                                                            },\r\n                                                        }}\r\n                                                    />\r\n                                                )}\r\n                                            />\r\n                                            {errors.furtherFields?.[index]?.date && (\r\n                                                <Typography color=\"error\">\r\n                                                    {errors.furtherFields[index].date.message}\r\n                                                </Typography>\r\n                                            )}\r\n                                        </Box>\r\n                                        <Typography mt={2}>\r\n                                            I confirm there has not been any changes to my medical history or my health since completing this form , it is still true and up to date.\r\n                                        </Typography>\r\n                                    </Grid>\r\n\r\n                                    {/* Signature Field */}\r\n                                    <Grid item xs={5}>\r\n                                        <Box>\r\n                                            <InputLabel sx={{ fontWeight: 700, fontSize: \"14px\", marginBottom: 1 }}>\r\n                                                Signature :*\r\n                                            </InputLabel>\r\n                                            <SignatureCanvas\r\n                                                ref={(el) => (signCanvasRefs.current[index] = el)}\r\n                                                penColor=\"black\"\r\n                                                canvasProps={{ width: 300, height: 150, style: { border: \"1px dashed black\" } }}\r\n                                            />\r\n\r\n                                        </Box>\r\n                                        <Grid container spacing={1} mt={1}>\r\n                                            <Grid item>\r\n                                                <Button variant=\"contained\" color=\"secondary\" onClick={() => clearSignature(index)}>\r\n                                                    Clear Signature\r\n                                                </Button>\r\n                                            </Grid>\r\n                                            <Grid item>\r\n                                                <Button variant=\"contained\" color=\"primary\" onClick={() => updateSignature(index)}>\r\n                                                    Save Signature\r\n                                                </Button>\r\n                                            </Grid>\r\n\r\n                                        </Grid>\r\n                                    </Grid>\r\n\r\n                                    {/* Remove Button */}\r\n                                    <Grid item xs={1} display=\"flex\" justifyContent=\"flex-end\">\r\n                                        {furtherFields.length > 1 && (\r\n                                            <IconButton color=\"error\" onClick={() => removeFurther(index)}>\r\n                                                <DeleteIcon />\r\n                                            </IconButton>\r\n                                        )}\r\n                                    </Grid>\r\n                                </Grid>\r\n                            ))}\r\n                        </LocalizationProvider>\r\n\r\n                        <Grid p={2}>\r\n                            <Button variant=\"contained\" color=\"secondary\" onClick={() => appendFurther({ date: null, sign: \"\" })} sx={{ mt: 2 }}>\r\n                                Add More Further Records\r\n                            </Button>\r\n                        </Grid>\r\n                        <Grid container p={1}>\r\n                            <Divider sx={{ mt: 4, width: '100%' }} />\r\n                        </Grid>\r\n                        <Grid item xs={6} mt={2}><InputField\r\n                            label={\"Notes :\"}\r\n                            multiline\r\n                            rows={3}\r\n                            size={'small'}\r\n                            placeholder={\"Notes\"}\r\n                            error={errors?.extranotes?.message}\r\n                            register={register(\"extranotes\", {\r\n                                required:\r\n                                    false\r\n\r\n                            })}\r\n                        /></Grid>\r\n                    </Grid>\r\n                    <Box sx={{ display: 'flex', justifyContent: 'flex-end', width: '100%', mt: 2 }}>\r\n                        <PrimaryButton loader={loader} disabled={loader} type={'submit'} title={\"Create\"} />\r\n                    </Box>\r\n                </Box>\r\n            </Paper>\r\n        </div >\r\n    )\r\n}\r\n\r\nexport default UpdateConsentForm\r\n"
        }
    ]
}